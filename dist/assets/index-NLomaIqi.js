import{t as us,c as xs,f as k,p as ge,r as _,j as e,V as vt,R as jt,a as Xe,A as wt,C as Et,X as St,T as Tt,D as Rt,P as hs,b as gs,u as ys,B as ps,d as me,e as te,U as fs,M as _s,g as bs,W as Ns,S as Ge,L as Ye,h as de,i as vs,k as Ct,l as js,m as At,n as ws,o as Dt,I as Lt,q as It,s as kt,v as Mt,w as Ot,x as Ut,y as Ft,z as Vt,E as Es,F as Ss,G as Ts,H as Pt,J as Rs,K as ue,N as $,O as q,Q as Ie,Y as Cs,Z as As,_ as Ds,$ as qt,a0 as Fe,a1 as Ve,a2 as Wt,a3 as Ls,a4 as Is,a5 as Ht,a6 as ks,a7 as Ms,a8 as Os,a9 as Us,aa as Fs,ab as zt,ac as Vs,ad as Ps,ae as mt,af as $t,ag as Ze,ah as oe,ai as Pe,aj as B,ak as ee,al as Re,am as ce,an as Ce,ao as pe,ap as fe,aq as _e,ar as be,as as ve,at as qs,au as je,av as Gt,aw as Ws,ax as Yt,ay as ke,az as he,aA as et,aB as tt,aC as le,aD as Hs,aE as He,aF as ut,aG as Ae,aH as De,aI as Ee,aJ as zs,aK as $s,aL as Gs,aM as xt,aN as Ys,aO as Ks,aP as Kt,aQ as Bs,aR as Bt,aS as Qt,aT as Qs,aU as Jt,aV as Js,aW as Xt,aX as Zt,aY as Xs,aZ as Zs,a_ as es,a$ as ea,b0 as ta,b1 as sa,b2 as aa,b3 as ra,b4 as na,b5 as ia,b6 as oa,b7 as la,b8 as da,b9 as ca}from"./vendor-BY8GEbjU.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const g of i)if(g.type==="childList")for(const l of g.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const g={};return i.integrity&&(g.integrity=i.integrity),i.referrerPolicy&&(g.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?g.credentials="include":i.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(i){if(i.ep)return;i.ep=!0;const g=s(i);fetch(i.href,g)}})();function w(...t){return us(xs(t))}function ye(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function K(t,n=1){return`${t.toFixed(n)}%`}function Se(t){const n=typeof t=="string"?new Date(Number(t.slice(0,4)),Number(t.slice(5,7))-1,Number(t.slice(8,10))):t;return k(n,"MMM dd, yyyy")}function ma(t){return k(ge(`2000-01-01T${t}`),"h:mm a")}function ts(t){switch(t.toLowerCase()){case"scheduled":return"bg-blue-100 text-blue-800";case"done":return"bg-green-100 text-green-800";case"no_show":return"bg-red-100 text-red-800";case"hired":return"bg-purple-100 text-purple-800";case"rejected":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}const ua=hs,ss=_.forwardRef(({className:t,...n},s)=>e.jsx(vt,{ref:s,className:w("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...n}));ss.displayName=vt.displayName;const xa=Xe("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),as=_.forwardRef(({className:t,variant:n,...s},o)=>e.jsx(jt,{ref:o,className:w(xa({variant:n}),t),...s}));as.displayName=jt.displayName;const ha=_.forwardRef(({className:t,...n},s)=>e.jsx(wt,{ref:s,className:w("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...n}));ha.displayName=wt.displayName;const rs=_.forwardRef(({className:t,...n},s)=>e.jsx(Et,{ref:s,className:w("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...n,children:e.jsx(St,{className:"h-4 w-4"})}));rs.displayName=Et.displayName;const ns=_.forwardRef(({className:t,...n},s)=>e.jsx(Tt,{ref:s,className:w("text-sm font-semibold",t),...n}));ns.displayName=Tt.displayName;const is=_.forwardRef(({className:t,...n},s)=>e.jsx(Rt,{ref:s,className:w("text-sm opacity-90",t),...n}));is.displayName=Rt.displayName;const ga=1,ya=1e6;let ze=0;function pa(){return ze=(ze+1)%Number.MAX_SAFE_INTEGER,ze.toString()}const $e=new Map,ht=t=>{if($e.has(t))return;const n=setTimeout(()=>{$e.delete(t),Te({type:"REMOVE_TOAST",toastId:t})},ya);$e.set(t,n)},fa=(t,n)=>{switch(n.type){case"ADD_TOAST":return{...t,toasts:[n.toast,...t.toasts].slice(0,ga)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===n.toast.id?{...s,...n.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=n;return s?ht(s):t.toasts.forEach(o=>{ht(o.id)}),{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,open:!1}:o)}}case"REMOVE_TOAST":return n.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==n.toastId)}}},Me=[];let Oe={toasts:[]};function Te(t){Oe=fa(Oe,t),Me.forEach(n=>{n(Oe)})}function _a({...t}){const n=pa(),s=i=>Te({type:"UPDATE_TOAST",toast:{...i,id:n}}),o=()=>Te({type:"DISMISS_TOAST",toastId:n});return Te({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:i=>{i||o()}}}),{id:n,dismiss:o,update:s}}function se(){const[t,n]=_.useState(Oe);return _.useEffect(()=>(Me.push(n),()=>{const s=Me.indexOf(n);s>-1&&Me.splice(s,1)}),[t]),{...t,toast:_a,dismiss:s=>Te({type:"DISMISS_TOAST",toastId:s})}}function ba(){const{toasts:t}=se();return e.jsxs(ua,{children:[t.map(function({id:n,title:s,description:o,action:i,...g}){return e.jsxs(as,{...g,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(ns,{children:s}),o&&e.jsx(is,{children:o})]}),i,e.jsx(rs,{})]},n)}),e.jsx(ss,{})]})}const Na="https://qewndmyixpzmtgjjihoj.supabase.co",va="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFld25kbXlpeHB6bXRnamppaG9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNjI0MDEsImV4cCI6MjA3MTYzODQwMX0.qGJGQ0U-0JjuFCn1deB5aOEA52y_uA9weCvZah3N6kI",E=gs(Na,va,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),I=_.forwardRef(({className:t,type:n,...s},o)=>e.jsx("input",{type:n,className:w("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:o,...s}));I.displayName="Input";const gt=[{name:"Overview",href:"/overview",icon:ps,description:"Key metrics and trends",category:"main",priority:"high"},{name:"Omega Daily",href:"/omega-daily",icon:me,description:"Daily business metrics",category:"main",priority:"high"},{name:"Calendar",href:"/calendar",icon:te,description:"Events and reminders",category:"main",priority:"medium"},{name:"Interviews & Hires",href:"/interviews",icon:fs,description:"Manage candidates and hiring",category:"main",priority:"medium"},{name:"OSAT",href:"/smg",icon:_s,description:"Customer feedback metrics",category:"main",priority:"medium"},{name:"Goal Setting",href:"/goals",icon:bs,description:"Set goals & track progress",category:"main",priority:"medium"},{name:"Setup",href:"/setup",icon:Ns,description:"Copy SQL & configure",category:"main",priority:"low"}];function ja({open:t}){const n=ys(),[s,o]=_.useState(""),[i,g]=_.useState(null),l=_.useMemo(()=>{if(!s.trim())return gt;const u=s.toLowerCase();return gt.filter(x=>x.name.toLowerCase().includes(u)||x.description.toLowerCase().includes(u))},[s]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:w("bg-gradient-to-b from-white to-gray-50 shadow-2xl border-r border-gray-200 transition-[width] duration-300 ease-in-out shrink-0 overflow-hidden",t?"w-64":"w-16"),children:e.jsxs("div",{className:"flex flex-col h-full relative",children:[t&&e.jsx("div",{className:"p-4 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{placeholder:"Search navigation...",value:s,onChange:u=>o(u.target.value),className:"pl-10 h-9 bg-gray-50 border-gray-200 focus:border-wendys-red focus:ring-wendys-red/20"})]})}),e.jsxs("nav",{className:w("overflow-y-auto flex-1",t?"p-4":"p-2"),children:[e.jsx("div",{className:"space-y-1",children:l.map(u=>{const x=n.pathname===u.href,p=u.icon;return e.jsxs("div",{className:"relative",children:[e.jsxs(Ye,{to:u.href,className:w("flex items-center transition-all duration-200 group relative",t?"space-x-3 p-3 rounded-lg mx-0":"justify-center p-3 rounded-lg mx-1",x?"bg-gradient-to-r from-wendys-red to-wendys-dark-red text-white shadow-lg ring-1 ring-red-200":"text-gray-700 hover:bg-white hover:shadow-sm hover:ring-1 hover:ring-gray-200"),onMouseEnter:()=>!t&&g(u.href),onMouseLeave:()=>!t&&g(null),children:[e.jsx("div",{className:w("flex-shrink-0 p-2 rounded-lg transition-all duration-200",x?"bg-white/20":"bg-gray-100 group-hover:bg-wendys-red/10 group-hover:scale-110"),children:e.jsx(p,{className:w("h-5 w-5 transition-colors duration-200",x?"text-white":"text-gray-600 group-hover:text-wendys-red")})}),t&&e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:w("font-semibold text-sm",x?"text-white":"text-gray-800"),children:u.name}),u.priority==="high"&&e.jsx(de,{className:"h-3 w-3 text-yellow-500 fill-current"})]}),e.jsx("div",{className:w("text-xs mt-1",x?"text-red-100":"text-gray-500"),children:u.description})]})]}),!t&&i===u.href&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 transform -translate-y-1/2 z-50",children:e.jsxs("div",{className:"bg-gray-900 text-white text-sm px-3 py-2 rounded-lg shadow-lg whitespace-nowrap",children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-gray-300 text-xs mt-1",children:u.description}),e.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]})})]},u.href)})}),s.trim()&&l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ge,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No navigation items found"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Try a different search term"})]})]}),t&&e.jsx("div",{className:"p-4 border-t border-gray-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-wendys-red rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"W"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Dashboard v3.0"})]})})]})})})}const Ke=Xe("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),R=_.forwardRef(({className:t,variant:n,size:s,asChild:o=!1,...i},g)=>{const l=o?vs:"button";return e.jsx(l,{className:w(Ke({variant:n,size:s,className:t})),ref:g,...i})});R.displayName="Button";const wa=Es,Ea=Ss,Sa=_.forwardRef(({className:t,inset:n,children:s,...o},i)=>e.jsxs(Ct,{ref:i,className:w("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",t),...o,children:[s,e.jsx(js,{className:"ml-auto h-4 w-4"})]}));Sa.displayName=Ct.displayName;const Ta=_.forwardRef(({className:t,...n},s)=>e.jsx(At,{ref:s,className:w("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Ta.displayName=At.displayName;const os=_.forwardRef(({className:t,sideOffset:n=4,...s},o)=>e.jsx(ws,{children:e.jsx(Dt,{ref:o,sideOffset:n,className:w("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));os.displayName=Dt.displayName;const ls=_.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(Lt,{ref:o,className:w("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",t),...s}));ls.displayName=Lt.displayName;const Ra=_.forwardRef(({className:t,children:n,checked:s,...o},i)=>e.jsxs(It,{ref:i,className:w("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(kt,{children:e.jsx(Mt,{className:"h-4 w-4"})})}),n]}));Ra.displayName=It.displayName;const Ca=_.forwardRef(({className:t,children:n,...s},o)=>e.jsxs(Ot,{ref:o,className:w("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(kt,{children:e.jsx(Ut,{className:"h-2 w-2 fill-current"})})}),n]}));Ca.displayName=Ot.displayName;const Aa=_.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(Ft,{ref:o,className:w("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));Aa.displayName=Ft.displayName;const Da=_.forwardRef(({className:t,...n},s)=>e.jsx(Vt,{ref:s,className:w("-mx-1 my-1 h-px bg-muted",t),...n}));Da.displayName=Vt.displayName;function La({user:t,onNavToggle:n,navOpen:s}){const{toast:o}=se(),i=async()=>{try{await E.auth.signOut(),o({title:"Signed out",description:"You have been successfully signed out."})}catch(g){console.error("Error signing out:",g),o({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:n,className:"p-2 hover:bg-gray-100","aria-label":s?"Close navigation":"Open navigation",children:e.jsx(Ts,{className:"h-5 w-5 text-wendys-charcoal"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-wendys-red rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"W"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-wendys-charcoal",children:"SE 14th GM Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500",children:k(new Date,"EEEE, MMMM d, yyyy")})]})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(wa,{children:[e.jsx(Ea,{asChild:!0,children:e.jsxs(R,{variant:"ghost",className:"flex items-center space-x-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:t.email})]})}),e.jsx(os,{align:"end",children:e.jsxs(ls,{onClick:i,children:[e.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Sign out"]})})]})})]})})}const Ia=ue({business_date:q().min(1,"Business date is required"),net_sales:$.number().min(0,"Net sales must be positive"),last_year_sales:$.number().min(0,"Last year sales must be positive"),labor_hours:$.number().min(0,"Labor hours must be positive"),ideal_labor_hours:$.number().min(0,"Ideal labor hours must be positive"),labor_percentage:$.number().min(0,"Labor percentage must be positive"),food_variance_cost:$.number(),waste_amount:$.number().min(0,"Waste amount must be positive"),breakfast_sales:$.number().min(0,"Breakfast sales must be positive"),night_sales:$.number().min(0,"Night sales must be positive")}),ka=ue({date:q().min(1,"Date is required"),accuracy_decimal:Ie().min(0,"Accuracy must be 0 or greater"),zod_per_10k:Ie().min(0,"ZOD per 10k must be 0 or greater"),cc_complaints:Ie().min(0,"CC Complaints must be 0 or greater"),osat_decimal:Ie().min(0,"OSAT Score must be 0 or greater"),notes:q().optional()});ue({candidate_name:q().min(1,"Candidate name is required"),phone:q().optional(),email:q().email("Invalid email format").optional().or(As("")),position:q().optional(),interview_date:q().min(1,"Interview date is required"),interview_time:q().min(1,"Interview time is required"),status:Cs(["SCHEDULED","COMPLETED","NO_SHOW","HIRED","REJECTED"]),notes:q().optional()});ue({entry_date:q().min(1,"Entry date is required"),accuracy_of_order:$.number().min(0).max(5).optional(),zone_of_defection:$.number().min(0).max(5).optional(),customer_computers:$.number().min(0).max(5).optional(),taste_of_food:$.number().min(0).max(5).optional(),osat:$.number().min(0).max(5).optional()});ue({documents_received:Ds().default(!1),documents_folder:q().optional(),onboarding_sent_date:q().optional(),onboarding_completed_date:q().optional(),manager_reviewed_date:q().optional(),entered_in_system_date:q().optional(),fingerprint_scheduled_date:q().optional(),first_day:q().optional(),notes:q().optional()});const Ma=ue({email:q().email("Invalid email format"),password:q().min(6,"Password must be at least 6 characters")}),Oa=Xe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),A=_.forwardRef(({className:t,...n},s)=>e.jsx(qt,{ref:s,className:w(Oa(),t),...n}));A.displayName=qt.displayName;function Ua(){const[t,n]=_.useState(!1),[s,o]=_.useState(!1),{toast:i}=se(),{register:g,handleSubmit:l,formState:{errors:u}}=Fe({resolver:Ve(Ma)}),x=async p=>{n(!0);try{const{error:m}=await E.auth.signInWithPassword({email:p.email,password:p.password});if(m)throw m;i({title:"Welcome!",description:"Successfully signed in to your dashboard."})}catch(m){console.error("Login error:",m),i({title:"Login failed",description:m.message||"Please check your credentials and try again.",variant:"destructive"})}finally{n(!1)}};return e.jsx("div",{className:"min-h-screen bg-wendys-gray flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-wendys-red rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-white font-bold text-3xl",children:"W"})}),e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal mb-2",children:"SE 14th GM Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to access your restaurant metrics"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 border border-gray-200",children:[e.jsxs("form",{onSubmit:l(x),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"email",className:"text-wendys-charcoal font-medium",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-10",...g("email")})]}),u.email&&e.jsx("p",{className:"text-red-600 text-sm",children:u.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"password",className:"text-wendys-charcoal font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{id:"password",type:s?"text":"password",placeholder:"Enter your password",className:"pl-10 pr-10",...g("password")}),e.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?e.jsx(Is,{className:"h-4 w-4"}):e.jsx(Ht,{className:"h-4 w-4"})})]}),u.password&&e.jsx("p",{className:"text-red-600 text-sm",children:u.password.message})]}),e.jsx(R,{type:"submit",className:"w-full wendys-button",disabled:t,children:t?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Demo Credentials"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," gm@se14th.wendys.com"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," test123"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use these credentials to test the dashboard functionality."})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Â© 2024 Wendy's International, Inc. All rights reserved."})})]})})}const ae=ks({component:Fa});function Fa(){const[t,n]=_.useState(null),[s,o]=_.useState(!0),[i,g]=_.useState(()=>{const x=localStorage.getItem("navOpen");return x?JSON.parse(x):!0}),{toast:l}=se(),u=Ms();return _.useEffect(()=>{if((async()=>{try{if("https://qewndmyixpzmtgjjihoj.supabase.co".trim()===""){n({id:"mock-user-id",email:"gm@wendys-se14th.com",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString()}),o(!1);return}const{data:{session:p}}=await E.auth.getSession();p!=null&&p.user&&n(p.user)}catch(p){console.error("Error checking session:",p),n({id:"mock-user-id",email:"gm@wendys-se14th.com",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString()})}finally{o(!1)}})(),"https://qewndmyixpzmtgjjihoj.supabase.co".trim()!==""){const{data:{subscription:p}}=E.auth.onAuthStateChange(async(m,d)=>{m==="SIGNED_IN"&&(d!=null&&d.user)?(n(d.user),l({title:"Welcome back!",description:"Successfully signed in to your dashboard."})):m==="SIGNED_OUT"&&(n(null),u({to:"/"}),l({title:"Signed out",description:"You have been successfully signed out."}))});return()=>p.unsubscribe()}},[u,l]),_.useEffect(()=>{localStorage.setItem("navOpen",JSON.stringify(i))},[i]),s?e.jsx("div",{className:"min-h-screen bg-wendys-gray flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-wendys-red mx-auto mb-4"}),e.jsx("p",{className:"text-wendys-charcoal",children:"Loading dashboard..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-wendys-gray",children:[e.jsx(La,{user:t,onNavToggle:()=>g(!i),navOpen:i}),e.jsxs("div",{className:"flex",children:[e.jsx(ja,{open:i}),e.jsx("main",{className:w("flex-1 p-6 transition-all duration-300 ease-in-out","ml-0"),children:e.jsx(Os,{})})]})]}):e.jsx(Ua,{})}function Le({className:t,classNames:n,showOutsideDays:s=!0,...o}){return e.jsx(Us,{showOutsideDays:s,className:w("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:w(Ke({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:w(Ke({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...n},...o})}Le.displayName="Calendar";const st=Vs,at=Ps,qe=_.forwardRef(({className:t,align:n="center",sideOffset:s=4,...o},i)=>e.jsx(Fs,{children:e.jsx(zt,{ref:i,align:n,sideOffset:s,className:w("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})}));qe.displayName=zt.displayName;function Va({columns:t,data:n,className:s,emptyMessage:o="No data available",loading:i=!1}){const[g,l]=_.useState(null),[u,x]=_.useState(null),p=_.useMemo(()=>!g||!u?n:[...n].sort((f,C)=>{const N=f[g],M=C[g];if(N==null&&M==null)return 0;if(N==null)return u==="asc"?-1:1;if(M==null)return u==="asc"?1:-1;if(typeof N=="number"&&typeof M=="number")return u==="asc"?N-M:M-N;if(typeof N=="string"&&typeof M=="string")return u==="asc"?N.localeCompare(M):M.localeCompare(N);if(N instanceof Date&&M instanceof Date)return u==="asc"?N.getTime()-M.getTime():M.getTime()-N.getTime();const v=String(N),c=String(M);return u==="asc"?v.localeCompare(c):c.localeCompare(v)}),[n,g,u]),m=f=>{g===f?u==="asc"?x("desc"):u==="desc"&&(x(null),l(null)):(l(f),x("asc"))},d=f=>g!==f?e.jsx(mt,{className:"h-3 w-3 text-gray-400"}):u==="asc"?e.jsx($t,{className:"h-3 w-3 text-gray-600"}):u==="desc"?e.jsx(Ze,{className:"h-3 w-3 text-gray-600"}):e.jsx(mt,{className:"h-3 w-3 text-gray-400"});return i?e.jsx(Pa,{columns:t}):e.jsx("div",{className:w("overflow-x-auto",s),children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:t.map(f=>e.jsx("th",{className:w("py-3 px-4 font-medium text-gray-700 text-sm",f.align==="center"&&"text-center",f.align==="right"&&"text-right",f.sortable&&"cursor-pointer hover:bg-gray-100 select-none",f.className),onClick:()=>f.sortable&&m(f.key),children:e.jsxs("div",{className:w("flex items-center gap-1",f.align==="center"&&"justify-center",f.align==="right"&&"justify-end"),children:[f.label,f.sortable&&d(f.key)]})},f.key))})}),e.jsx("tbody",{children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"py-8 px-4 text-center text-gray-500",children:o})}):p.map((f,C)=>e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:t.map(N=>e.jsx("td",{className:w("py-3 px-4 text-sm",N.align==="center"&&"text-center",N.align==="right"&&"text-right",N.className),children:N.render?N.render(f[N.key],f):f[N.key]},N.key))},f.id||C))})]})})}function Pa({columns:t}){return e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:t.map(n=>e.jsx("th",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})},n.key))})}),e.jsx("tbody",{children:[...Array(5)].map((n,s)=>e.jsx("tr",{className:"border-b border-gray-100",children:t.map(o=>e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-100 rounded w-full"})},o.key))},s))})]})})})}function Ne({title:t,subtitle:n,className:s,children:o,loading:i=!1,error:g,onRefresh:l}){return e.jsxs("div",{className:w("wendys-card",s),children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:t}),n&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]}),l&&e.jsx("button",{onClick:l,className:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Refresh chart",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),g?e.jsx("div",{className:"flex items-center justify-center h-[300px] text-red-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Error loading chart"}),e.jsx("p",{className:"text-xs mt-1 text-red-400",children:g}),l&&e.jsx("button",{onClick:l,className:"mt-2 px-3 py-1 text-xs bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Try again"})]})}):i?e.jsx(qa,{}):o]})}function qa(){return e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"h-[300px] bg-gray-100 rounded flex flex-col justify-end p-4",children:[e.jsx("div",{className:"absolute left-2 top-4 space-y-8",children:[...Array(4)].map((t,n)=>e.jsx("div",{className:"w-8 h-2 bg-gray-200 rounded"},n))}),e.jsx("div",{className:"flex items-end justify-between h-48 mb-4",children:[...Array(12)].map((t,n)=>e.jsx("div",{className:"bg-gray-200 rounded-t",style:{height:`${Math.random()*80+20}%`,width:"6%"}},n))}),e.jsx("div",{className:"flex justify-between",children:[...Array(6)].map((t,n)=>e.jsx("div",{className:"w-12 h-2 bg-gray-200 rounded"},n))})]})})}const H={currency:t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t),currencyDetailed:t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t),percent:(t,n=1)=>`${(t??0).toFixed(n)}%`,hours:(t,n=1)=>`${(t??0).toFixed(n)}h`,dateShort:t=>{const n=typeof t=="string"?new Date(Number(String(t).slice(0,4)),Number(String(t).slice(5,7))-1,Number(String(t).slice(8,10))):t;return k(n,"MMM d")},dateFull:t=>{const n=typeof t=="string"?new Date(Number(String(t).slice(0,4)),Number(String(t).slice(5,7))-1,Number(String(t).slice(8,10))):t;return k(n,"MMM dd, yyyy")},currencyCompact:t=>{const n=Math.abs(t);return n>=1e6?`$${(t/1e6).toFixed(1)}M`:n>=1e3?`$${(t/1e3).toFixed(1)}k`:H.currency(t)}},O={sales:"#E2231A",salesSecondary:"#B71C13",labor:"#374151",laborIdeal:"#6B7280",waste:"#EF4444",foodVariance:"#F59E0B",positive:"#10B981",warning:"#F59E0B",gridStroke:"#E5E7EB",textPrimary:"#111827",textSecondary:"#6B7280"},F={cartesianGrid:{strokeDasharray:"3 3",stroke:O.gridStroke},xAxis:{stroke:O.textSecondary,fontSize:12,tickMargin:8},yAxis:{stroke:O.textSecondary,fontSize:12,tickMargin:8},tooltip:{contentStyle:{backgroundColor:"white",border:`1px solid ${O.gridStroke}`,borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",fontSize:"14px"},labelStyle:{color:O.textPrimary,fontWeight:"600",marginBottom:"4px"}},legend:{iconType:"rect",wrapperStyle:{fontSize:"12px",color:O.textSecondary}}},Be=(t,n=new Date)=>{const s=new Date(n);switch(t){case"today":return{start:k(s,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd"),label:"Today"};case"wtd":const o=new Date(s);return o.setDate(s.getDate()-s.getDay()),{start:k(o,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd"),label:"Week to Date"};case"mtd":const i=new Date(s.getFullYear(),s.getMonth(),1);return{start:k(i,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd"),label:"Month to Date"};case"last7":const g=new Date(s);return g.setDate(s.getDate()-6),{start:k(g,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd"),label:"Last 7 Days"};case"last30":const l=new Date(s);return l.setDate(s.getDate()-29),{start:k(l,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd"),label:"Last 30 Days"};default:return{start:"",end:"",label:"All Time"}}},Wa=oe("/smg")({component:Ha});function Ha(){const[t,n]=_.useState(null),[s,o]=_.useState(),{toast:i}=se(),g=Pe(),l=Fe({resolver:Ve(ka),defaultValues:{date:"",accuracy_decimal:0,zod_per_10k:0,cc_complaints:0,osat_decimal:0,notes:""}});_.useEffect(()=>{let c=!0;return(async()=>{var W;const{data:D}=await E.auth.getUser(),U=(W=D.user)==null?void 0:W.id;if(!U)return;const{data:L,error:P}=await E.from("users").select("store_id").eq("id",U).maybeSingle();c&&(P||n((L==null?void 0:L.store_id)??null))})(),()=>{c=!1}},[]);const{data:u=[],isLoading:x,error:p}=B({queryKey:["smg_daily",t],queryFn:async()=>{if(!t)return[];const{data:c,error:D}=await E.from("smg_daily").select("*").eq("store_id",t).order("date",{ascending:!1});if(D)throw D;return c||[]},enabled:!!t}),{data:m=[]}=B({queryKey:["smg_entries_import",t],queryFn:async()=>{if(!t)return[];const{data:c,error:D}=await E.from("smg_entries").select("*").eq("store_id",t).order("entry_date",{ascending:!1});if(D)throw D;return c||[]},enabled:!!t}),d=_.useMemo(()=>u.length>0?u:m.length?m.map(c=>({id:c.id,date:c.entry_date,accuracy_decimal:Number(c.accuracy_of_order)||0,zod_per_10k:Number(c.zone_of_defection)||0,cc_complaints:Number(c.customer_computers)||0,osat_decimal:Number(c.osat)||0,notes:"",created_at:c.created_at})):[],[u,m]),f=ee({mutationFn:async c=>{if(!t)throw new Error("Store not connected");const{error:D}=await E.from("smg_daily").insert({store_id:t,date:c.date,accuracy_decimal:c.accuracy_decimal,zod_per_10k:c.zod_per_10k,cc_complaints:c.cc_complaints,osat_decimal:c.osat_decimal,notes:c.notes||null});if(D)throw D},onSuccess:()=>{g.invalidateQueries({queryKey:["smg_daily",t]}),l.reset(),o(void 0),i({title:"Success",description:"SMG entry saved successfully."})},onError:c=>{i({title:"Error",description:c.message||"Failed to save SMG entry.",variant:"destructive"})}}),C=c=>{f.mutate(c)},N=c=>{const D=Number(c.slice(0,4)),U=Number(c.slice(5,7)),L=Number(c.slice(8,10));return new Date(D,(U||1)-1,L||1)},M=[{key:"date",label:"Date",sortable:!0,render:c=>k(N(c),"MMM dd, yyyy")},{key:"accuracy_decimal",label:"Accuracy of Order",sortable:!0,align:"right",render:c=>c.toFixed(2)},{key:"zod_per_10k",label:"ZOD per 10k",sortable:!0,align:"right",render:c=>c.toFixed(2)},{key:"cc_complaints",label:"CC Complaints",sortable:!0,align:"right",render:c=>c.toFixed(2)},{key:"osat_decimal",label:"OSAT Score",sortable:!0,align:"right",render:c=>c.toFixed(2)},{key:"notes",label:"Notes",sortable:!1,render:c=>e.jsx("div",{className:"max-w-32 truncate",title:c,children:c||"-"})}],v=_.useMemo(()=>d.length?d.slice().reverse().map(c=>({date:H.dateShort(c.date),osat:c.osat_decimal})):[],[d]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"SMG Manual Entry"}),e.jsx("p",{className:"text-gray-600",children:"Record your daily service metrics and customer satisfaction scores"})]})}),p&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:["Error loading data: ",p.message]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Re,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Add New Entry"})]}),e.jsxs("form",{onSubmit:l.handleSubmit(C),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"date",children:"Date *"}),e.jsxs(st,{children:[e.jsx(at,{asChild:!0,children:e.jsxs(R,{variant:"outline",id:"date",className:"w-full justify-start text-left font-normal",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),s?k(s,"MMM dd, yyyy"):"Select date"]})}),e.jsx(qe,{className:"w-auto p-0",align:"start",children:e.jsx(Le,{mode:"single",selected:s,onSelect:c=>{o(c),c&&l.setValue("date",k(c,"yyyy-MM-dd"))},initialFocus:!0})})]}),l.formState.errors.date&&e.jsx("p",{className:"text-sm text-red-600",children:l.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"accuracy_decimal",children:"Accuracy of Order *"}),e.jsx(I,{id:"accuracy_decimal",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...l.register("accuracy_decimal",{valueAsNumber:!0})}),l.formState.errors.accuracy_decimal&&e.jsx("p",{className:"text-sm text-red-600",children:l.formState.errors.accuracy_decimal.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"zod_per_10k",children:"ZOD per 10k *"}),e.jsx(I,{id:"zod_per_10k",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...l.register("zod_per_10k",{valueAsNumber:!0})}),l.formState.errors.zod_per_10k&&e.jsx("p",{className:"text-sm text-red-600",children:l.formState.errors.zod_per_10k.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"cc_complaints",children:"CC Complaints *"}),e.jsx(I,{id:"cc_complaints",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...l.register("cc_complaints",{valueAsNumber:!0})}),l.formState.errors.cc_complaints&&e.jsx("p",{className:"text-sm text-red-600",children:l.formState.errors.cc_complaints.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"osat_decimal",children:"OSAT Score *"}),e.jsx(I,{id:"osat_decimal",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...l.register("osat_decimal",{valueAsNumber:!0})}),l.formState.errors.osat_decimal&&e.jsx("p",{className:"text-sm text-red-600",children:l.formState.errors.osat_decimal.message})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2 lg:col-span-1",children:[e.jsx(A,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-wendys-red focus:border-wendys-red",placeholder:"Optional notes...",...l.register("notes")})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(R,{type:"submit",disabled:f.isPending||!t,className:"bg-wendys-red hover:bg-wendys-red/90",children:f.isPending?"Saving...":"Save Entry"})})]})]}),e.jsx(Ne,{title:"OSAT Score Trend",subtitle:`${d.length} entries`,loading:x,error:p==null?void 0:p.message,children:v.length>0?e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Ce,{data:v,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:c=>c.toFixed(1)}),e.jsx(be,{...F.tooltip,formatter:c=>[c.toFixed(2),"OSAT Score"]}),e.jsx(ve,{type:"monotone",dataKey:"osat",stroke:O.sales,strokeWidth:3,dot:{fill:O.sales,strokeWidth:2,r:4},activeDot:{r:6,stroke:O.salesSecondary,strokeWidth:2},name:"OSAT Score"})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see OSAT trends"})]})})}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Previous Entries"}),e.jsx("div",{className:"text-sm text-gray-600",children:x?"Loading...":`${d.length} entries`})]}),t?e.jsx(Va,{columns:M,data:d,loading:x,emptyMessage:"No SMG entries found. Add your first entry above."}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"Store not connected"}),e.jsx("p",{className:"text-sm mt-2",children:"Please go to Setup to link your account to a store first."})]})})]})]})}const yt=`-- Goals table for Goal Setting tab
create table if not exists public.goals (
  id uuid primary key default gen_random_uuid(),
  store_id uuid not null references stores(id) on delete cascade,
  scope text not null check (scope in ('week','month','custom')),
  period_start date not null,
  period_end date not null,
  sales_target numeric not null default 0,
  labor_target_pct numeric not null default 0,
  waste_target_pct numeric not null default 0,
  food_variance_target_pct numeric not null default 0,
  service_seconds_target numeric not null default 0,
  team_notes text,
  created_at timestamp with time zone default now(),
  unique (store_id, period_start, period_end)
);
-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Create stores table
CREATE TABLE stores (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text NOT NULL,
  created_at timestamptz DEFAULT now()
);

-- Create users table linked to auth.users
CREATE TABLE users (
  id uuid PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  store_id uuid NOT NULL REFERENCES stores(id),
  role text NOT NULL DEFAULT 'gm',
  created_at timestamptz DEFAULT now()
);

-- Create Omega Daily table for daily business metrics
CREATE TABLE omega_daily (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  business_date date NOT NULL,
  net_sales numeric NOT NULL,
  last_year_sales numeric NOT NULL,
  comp_net_sales numeric GENERATED ALWAYS AS (net_sales - last_year_sales) STORED,
  labor_hours numeric NOT NULL,
  ideal_labor_hours numeric NOT NULL,
  labor_hours_diff numeric GENERATED ALWAYS AS (labor_hours - ideal_labor_hours) STORED,
  labor_percentage numeric NOT NULL,
  theoretical_food_cost numeric NOT NULL,
  food_variance_cost numeric NOT NULL,
  food_variance_percentage numeric GENERATED ALWAYS AS (
    CASE WHEN theoretical_food_cost = 0 THEN 0 ELSE (food_variance_cost / theoretical_food_cost) * 100 END
  ) STORED,
  waste_amount numeric NOT NULL,
  waste_percentage numeric GENERATED ALWAYS AS (
    CASE WHEN net_sales = 0 THEN 0 ELSE (waste_amount / net_sales) * 100 END
  ) STORED,
  breakfast_sales numeric NOT NULL,
  night_sales numeric NOT NULL,
  created_at timestamptz DEFAULT now()
);

-- Create unique index on store_id and business_date
CREATE UNIQUE INDEX ON omega_daily (store_id, business_date);

-- Create interview status enum
CREATE TYPE interview_status AS ENUM ('SCHEDULED','COMPLETED','NO_SHOW','HIRED','REJECTED');

-- Create interviews table
CREATE TABLE interviews (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  candidate_name text NOT NULL,
  phone text,
  email text,
  position text,
  interview_date date NOT NULL,
  interview_time time NOT NULL,
  status interview_status NOT NULL DEFAULT 'SCHEDULED',
  notes text,
  created_at timestamptz DEFAULT now()
);

-- Create hiring process table
CREATE TABLE hires (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  interview_id uuid UNIQUE NOT NULL REFERENCES interviews(id) ON DELETE CASCADE,
  documents_received boolean DEFAULT false,
  documents_folder text, -- Supabase Storage path
  onboarding_sent_date date,
  onboarding_completed_date date,
  manager_reviewed_date date,
  entered_in_system_date date,
  fingerprint_scheduled_date date,
  first_day date,
  notes text,
  created_at timestamptz DEFAULT now()
);

-- Create SMG daily entries table
CREATE TABLE smg_entries (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  entry_date date NOT NULL,
  accuracy_of_order numeric,
  zone_of_defection numeric,
  customer_computers numeric,
  taste_of_food numeric,
  osat numeric,
  created_at timestamptz DEFAULT now()
);

-- Create unique index on store_id and entry_date
CREATE UNIQUE INDEX ON smg_entries (store_id, entry_date);

-- Create view for SMG monthly aggregations
CREATE VIEW smg_monthly AS
SELECT
  store_id,
  date_trunc('month', entry_date)::date AS month_start,
  AVG(accuracy_of_order) AS avg_accuracy_of_order,
  AVG(zone_of_defection) AS avg_zone_of_defection,
  AVG(customer_computers) AS avg_customer_computers,
  AVG(taste_of_food) AS avg_taste_of_food,
  AVG(osat) AS avg_osat,
  COUNT(*) AS total_entries
FROM smg_entries
GROUP BY store_id, date_trunc('month', entry_date);

-- Enable Row Level Security on all tables
ALTER TABLE stores ENABLE ROW LEVEL SECURITY;
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE omega_daily ENABLE ROW LEVEL SECURITY;
ALTER TABLE interviews ENABLE ROW LEVEL SECURITY;
ALTER TABLE hires ENABLE ROW LEVEL SECURITY;
ALTER TABLE smg_entries ENABLE ROW LEVEL SECURITY;
-- RLS Policies for goals
ALTER TABLE goals ENABLE ROW LEVEL SECURITY;
CREATE POLICY goals_isolate ON goals
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for stores (only allow reading own store)
CREATE POLICY stores_isolate ON stores
  FOR ALL USING (id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for users (only allow reading own user record)
CREATE POLICY users_isolate ON users
  FOR ALL USING (id = auth.uid());

-- RLS Policies for omega_daily
CREATE POLICY omega_daily_isolate ON omega_daily
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for interviews
CREATE POLICY interviews_isolate ON interviews
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for hires
CREATE POLICY hires_isolate ON hires
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for smg_entries
CREATE POLICY smg_entries_isolate ON smg_entries
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for smg_monthly view
CREATE POLICY smg_monthly_isolate ON smg_monthly
  FOR SELECT USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- Create SMG Daily table for manual entry
CREATE TABLE smg_daily (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  store_id UUID NOT NULL REFERENCES stores(id) ON DELETE CASCADE,
  date DATE NOT NULL,
  accuracy_decimal NUMERIC NOT NULL CHECK (accuracy_decimal >= 0),
  zod_per_10k NUMERIC NOT NULL CHECK (zod_per_10k >= 0),
  cc_complaints NUMERIC NOT NULL CHECK (cc_complaints >= 0),
  osat_decimal NUMERIC NOT NULL CHECK (osat_decimal >= 0),
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(store_id, date)
);

-- Enable RLS for smg_daily
ALTER TABLE smg_daily ENABLE ROW LEVEL SECURITY;

-- Create RLS policies for smg_daily
CREATE POLICY "Users can view their store's SMG data" ON smg_daily
  FOR SELECT USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can insert SMG data for their store" ON smg_daily
  FOR INSERT WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can update their store's SMG data" ON smg_daily
  FOR UPDATE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can delete their store's SMG data" ON smg_daily
  FOR DELETE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- Create indexes for better performance
CREATE INDEX idx_omega_daily_store_date ON omega_daily(store_id, business_date);
CREATE INDEX idx_interviews_store_date ON interviews(store_id, interview_date);
CREATE INDEX idx_smg_entries_store_date ON smg_entries(store_id, entry_date);
CREATE INDEX idx_smg_daily_store_date ON smg_daily(store_id, date);
CREATE INDEX idx_hires_interview_id ON hires(interview_id);
`,pt=`-- Seed data for Wendy's GM Dashboard
-- This creates a test store, user, and sample data

-- Insert SE 14th store
INSERT INTO stores (id, name) VALUES 
('550e8400-e29b-41d4-a716-446655440000', 'SE 14th');

-- Insert test GM user (password: test123)
-- Note: You'll need to create this user in Supabase Auth first, then update the ID here
INSERT INTO users (id, store_id, role) VALUES 
('550e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440000', 'gm');

-- Insert sample Omega Daily data (last 35 days for better testing)
INSERT INTO omega_daily (store_id, business_date, net_sales, last_year_sales, labor_hours, ideal_labor_hours, labor_percentage, food_variance_cost, waste_amount, breakfast_sales, night_sales) VALUES
-- Today and recent days
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE, 12500.00, 11800.00, 85.5, 82.0, 6.8, 125.00, 87.50, 3200.00, 9300.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 11800.00, 11200.00, 82.0, 78.5, 6.9, 118.00, 82.60, 2950.00, 8850.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 13200.00, 12500.00, 88.0, 85.0, 6.7, 132.00, 92.40, 3300.00, 9900.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 11500.00, 10800.00, 79.5, 76.0, 6.9, 115.00, 80.50, 2875.00, 8625.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 12800.00, 12100.00, 86.0, 83.0, 6.7, 128.00, 89.60, 3200.00, 9600.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 12100.00, 11400.00, 81.5, 78.0, 6.7, 121.00, 84.70, 3025.00, 9075.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 13500.00, 12800.00, 90.0, 87.0, 6.7, 135.00, 94.50, 3375.00, 10125.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 11200.00, 10500.00, 75.5, 72.0, 6.7, 112.00, 78.40, 2800.00, 8400.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 12900.00, 12200.00, 86.5, 83.5, 6.7, 129.00, 90.30, 3225.00, 9675.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 11600.00, 10900.00, 78.0, 74.5, 6.7, 116.00, 81.20, 2900.00, 8700.00),
-- Additional days (10-34) for 30+ day testing
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 12300.00, 11600.00, 83.0, 80.0, 6.7, 123.00, 86.10, 3075.00, 9225.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '11 days', 11900.00, 11300.00, 81.0, 77.5, 6.8, 119.00, 83.30, 2975.00, 8925.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '12 days', 13100.00, 12400.00, 87.5, 84.5, 6.7, 131.00, 91.70, 3275.00, 9825.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '13 days', 11700.00, 11000.00, 79.0, 75.5, 6.8, 117.00, 81.90, 2925.00, 8775.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '14 days', 12600.00, 11900.00, 84.5, 81.5, 6.7, 126.00, 88.20, 3150.00, 9450.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '15 days', 12000.00, 11300.00, 80.5, 77.0, 6.7, 120.00, 84.00, 3000.00, 9000.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '16 days', 13400.00, 12700.00, 89.5, 86.5, 6.7, 134.00, 93.80, 3350.00, 10050.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '17 days', 11400.00, 10700.00, 76.5, 73.0, 6.7, 114.00, 79.80, 2850.00, 8550.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '18 days', 12700.00, 12000.00, 85.0, 82.0, 6.7, 127.00, 88.90, 3175.00, 9525.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '19 days', 11800.00, 11100.00, 79.5, 76.0, 6.7, 118.00, 82.60, 2950.00, 8850.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '20 days', 13000.00, 12300.00, 87.0, 84.0, 6.7, 130.00, 91.00, 3250.00, 9750.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '21 days', 11600.00, 10900.00, 78.0, 74.5, 6.7, 116.00, 81.20, 2900.00, 8700.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '22 days', 12400.00, 11700.00, 83.5, 80.5, 6.7, 124.00, 86.80, 3100.00, 9300.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '23 days', 12200.00, 11500.00, 82.0, 78.5, 6.7, 122.00, 85.40, 3050.00, 9150.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '24 days', 13300.00, 12600.00, 88.5, 85.5, 6.7, 133.00, 93.10, 3325.00, 9975.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '25 days', 11300.00, 10600.00, 76.0, 72.5, 6.7, 113.00, 79.10, 2825.00, 8475.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '26 days', 12800.00, 12100.00, 86.0, 83.0, 6.7, 128.00, 89.60, 3200.00, 9600.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '27 days', 11900.00, 11200.00, 80.0, 76.5, 6.7, 119.00, 83.30, 2975.00, 8925.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '28 days', 13200.00, 12500.00, 88.0, 85.0, 6.7, 132.00, 92.40, 3300.00, 9900.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '29 days', 11500.00, 10800.00, 77.5, 74.0, 6.7, 115.00, 80.50, 2875.00, 8625.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '30 days', 12700.00, 12000.00, 85.5, 82.5, 6.7, 127.00, 88.90, 3175.00, 9525.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '31 days', 11700.00, 11000.00, 78.5, 75.0, 6.7, 117.00, 81.90, 2925.00, 8775.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '32 days', 12500.00, 11800.00, 84.0, 81.0, 6.7, 125.00, 87.50, 3125.00, 9375.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '33 days', 12100.00, 11400.00, 81.0, 77.5, 6.7, 121.00, 84.70, 3025.00, 9075.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '34 days', 13000.00, 12300.00, 87.0, 84.0, 6.7, 130.00, 91.00, 3250.00, 9750.00);

-- Insert sample interviews
INSERT INTO interviews (store_id, candidate_name, phone, email, position, interview_date, interview_time, status, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', 'John Smith', '555-0101', 'john.smith@email.com', 'Crew Member', CURRENT_DATE + INTERVAL '1 day', '14:00:00', 'SCHEDULED', 'Experienced in food service'),
('550e8400-e29b-41d4-a716-446655440000', 'Sarah Johnson', '555-0102', 'sarah.j@email.com', 'Shift Leader', CURRENT_DATE, '10:00:00', 'DONE', 'Great communication skills, recommended for hire'),
('550e8400-e29b-41d4-a716-446655440000', 'Mike Davis', '555-0103', 'mike.d@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '1 day', '15:30:00', 'NO_SHOW', 'No call, no show'),
('550e8400-e29b-41d4-a716-446655440000', 'Lisa Wilson', '555-0104', 'lisa.w@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '2 days', '11:00:00', 'HIRED', 'Excellent candidate, starting next week'),
('550e8400-e29b-41d4-a716-446655440000', 'Tom Brown', '555-0105', 'tom.b@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '3 days', '16:00:00', 'REJECTED', 'Not a good fit for the team');

-- Insert sample hire for Lisa Wilson
INSERT INTO hires (store_id, interview_id, documents_received, onboarding_sent_date, onboarding_completed_date, manager_reviewed_date, entered_in_system_date, fingerprint_scheduled_date, first_day, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', 
 (SELECT id FROM interviews WHERE candidate_name = 'Lisa Wilson'), 
 true, 
 CURRENT_DATE - INTERVAL '1 day', 
 CURRENT_DATE, 
 CURRENT_DATE, 
 CURRENT_DATE, 
 CURRENT_DATE + INTERVAL '3 days', 
 CURRENT_DATE + INTERVAL '7 days', 
 'Lisa is very organized and completed all requirements quickly');

-- Insert sample SMG entries (last 30 days)
INSERT INTO smg_entries (store_id, entry_date, accuracy_of_order, zone_of_defection, customer_computers, taste_of_food, osat) VALUES
-- Recent days
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE, 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '11 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '12 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '13 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '14 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '15 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '16 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '17 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '18 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '19 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '20 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '21 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '22 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '23 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '24 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '25 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '26 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '27 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '28 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '29 days', 4.7, 1.3, 4.5, 4.6, 4.5);

-- Add sample SMG daily data
INSERT INTO smg_daily (store_id, date, accuracy_decimal, zod_per_10k, cc_complaints, osat_decimal, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 0.87, 2.50, 1.25, 0.92, 'Good day overall, slight accuracy issues during lunch rush'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 0.91, 1.80, 0.95, 0.94, 'Improvement in accuracy, training paying off'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 0.89, 3.20, 2.10, 0.88, 'Busy Friday, some service delays during dinner'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 0.93, 1.50, 0.80, 0.96, 'Excellent performance, team working well together'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 0.85, 4.10, 1.75, 0.90, 'Weekend rush, need to focus on order accuracy'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 0.88, 2.80, 1.45, 0.91, 'Steady performance throughout the day'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 0.92, 1.90, 1.05, 0.95, 'Great week start, team motivated'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 0.86, 3.50, 1.85, 0.89, 'Some challenges during shift change'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 0.90, 2.20, 1.15, 0.93, 'Solid performance across all metrics'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 0.94, 1.40, 0.75, 0.97, 'Outstanding day, new training methods working');`,za=oe("/setup")({component:$a});function ft(t){navigator.clipboard.writeText(t)}function $a(){return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Project Setup"}),e.jsxs("ol",{className:"list-decimal ml-5 space-y-4 text-gray-700",children:[e.jsx("li",{children:"Supabase â Auth â Providers â Email: enable. Then Auth â Users â Add user (auto-confirm)."}),e.jsx("li",{children:"Supabase â SQL Editor: paste the schema SQL, run it. Then paste the seed SQL, run it."}),e.jsxs("li",{children:["In ",e.jsx("code",{children:".env.local"})," set URL, ANON KEY, set ",e.jsx("code",{children:"VITE_USE_MOCK_DATA=false"}),", restart dev server."]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-wendys-charcoal",children:"Schema SQL"}),e.jsx(R,{onClick:()=>ft(yt),className:"wendys-button",children:"Copy"})]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto max-h-80 text-xs",children:yt})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-wendys-charcoal",children:"Seed SQL"}),e.jsx(R,{onClick:()=>ft(pt),className:"wendys-button",children:"Copy"})]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto max-h-80 text-xs",children:pt})]})]})}function ie({title:t,value:n,format:s,delta:o,deltaLabel:i,icon:g,trend:l,suffix:u,sparklineData:x,className:p}){const m=C=>{switch(s){case"currency":return ye(C);case"percentage":return K(C);case"number":return C.toLocaleString();default:return C.toString()}},d=()=>{switch(l){case"up":return e.jsx(me,{className:"h-4 w-4 text-green-600"});case"down":return e.jsx(je,{className:"h-4 w-4 text-red-600"});case"neutral":return e.jsx(qs,{className:"h-4 w-4 text-gray-400"})}},f=()=>{switch(l){case"up":return"text-green-600";case"down":return"text-red-600";case"neutral":return"text-gray-600"}};return e.jsx("div",{className:w("wendys-card",p),children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 truncate",children:t}),e.jsx("div",{className:"w-8 h-8 bg-wendys-red bg-opacity-10 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(g,{className:"h-4 w-4 text-wendys-red"})})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("span",{className:"text-2xl font-bold text-wendys-charcoal",children:[m(n),u&&e.jsx("span",{className:"text-lg ml-1 font-normal",children:u})]}),x&&x.length>0&&e.jsx("div",{className:"w-16 h-8 ml-2",children:e.jsx(ce,{width:"100%",height:"100%",children:e.jsx(Ce,{data:x,children:e.jsx(ve,{type:"monotone",dataKey:"value",stroke:l==="up"?O.positive:l==="down"?O.waste:O.textSecondary,strokeWidth:1.5,dot:!1})})})})]}),o!==void 0&&i&&e.jsxs("div",{className:"flex items-center space-x-1 mt-3",children:[d(),e.jsxs("span",{className:w("text-sm font-medium",f()),children:[o>0?"+":"",Math.abs(o)<1&&s!=="percentage"?K(Math.abs(o)*100):m(Math.abs(o)),u&&s!=="percentage"&&e.jsx("span",{className:"ml-1",children:u})]}),e.jsx("span",{className:"text-xs text-gray-500",children:i})]})]})})})}function Ga({data:t=[]}){const n=_.useMemo(()=>{if(!t.length){const s=[];for(let o=13;o>=0;o--){const i=new Date;i.setDate(i.getDate()-o),s.push({date:H.dateShort(i.toISOString().slice(0,10)),sales:0})}return s}return t.sort((s,o)=>new Date(s.business_date).getTime()-new Date(o.business_date).getTime()).slice(-30).map(s=>({date:H.dateShort(s.business_date),sales:s.net_sales||0}))},[t]);return e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Ce,{data:n,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:s=>H.currencyCompact(s)}),e.jsx(be,{...F.tooltip,formatter:s=>[H.currencyDetailed(s),"Net Sales"]}),e.jsx(ve,{type:"monotone",dataKey:"sales",stroke:O.sales,strokeWidth:3,dot:{fill:O.sales,strokeWidth:2,r:4},activeDot:{r:6,stroke:O.salesSecondary,strokeWidth:2}})]})})}function Ya({data:t=[]}){console.log("ð LaborVsIdealChart received data:",t.slice(0,3));const n=_.useMemo(()=>{if(!t.length){const o=[];for(let i=6;i>=0;i--){const g=new Date;g.setDate(g.getDate()-i),o.push({date:H.dateShort(g.toISOString().slice(0,10)),ideal:0,actual:0})}return o}const s=t.sort((o,i)=>new Date(o.business_date).getTime()-new Date(i.business_date).getTime()).slice(-30).map(o=>{const i=Number(o.ideal_labor_hours)||0,g=Number(o.labor_hours)||0;return console.log("ð Processing entry:",o.business_date,"ideal:",o.ideal_labor_hours,"=>",i,"actual:",o.labor_hours,"=>",g),{date:H.dateShort(o.business_date),ideal:i,actual:g}});return console.log("ð Processed chart data:",s.slice(0,3)),s},[t]);return console.log("ð Final chartData being rendered:",n.slice(0,3)),e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Gt,{data:n,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:s=>H.hours(s)}),e.jsx(be,{...F.tooltip,formatter:(s,o)=>[H.hours(s),o==="ideal"?"Ideal Hours":"Actual Hours"]}),e.jsx(Ws,{...F.legend}),e.jsx(Yt,{dataKey:"ideal",fill:O.laborIdeal,opacity:.6,name:"Ideal Hours"}),e.jsx(ve,{type:"monotone",dataKey:"actual",stroke:O.labor,strokeWidth:3,dot:{fill:O.labor,strokeWidth:2,r:4},activeDot:{r:6,stroke:O.textPrimary,strokeWidth:2},name:"Actual Hours"})]})})}function Ka(){const[t,n]=_.useState(null);_.useEffect(()=>{let m=!0;return(async()=>{var f;const{data:d}=await E.from("users").select("store_id").eq("id",(f=(await E.auth.getUser()).data.user)==null?void 0:f.id).single();m&&n((d==null?void 0:d.store_id)??null)})(),()=>{m=!1}},[]);const{data:s=[],isLoading:o}=B({queryKey:["smg_snapshot",t],queryFn:async()=>{if(!t)return[];const m=new Date;m.setDate(m.getDate()-30);const{data:d,error:f}=await E.from("smg_daily").select("*").eq("store_id",t).gte("date",m.toISOString().split("T")[0]).order("date",{ascending:!1});if(f)throw f;return d||[]},enabled:!!t}),i=s.length>0?{accuracy:s.reduce((m,d)=>m+d.accuracy_decimal,0)/s.length,zod:s.reduce((m,d)=>m+d.zod_per_10k,0)/s.length,complaints:s.reduce((m,d)=>m+d.cc_complaints,0)/s.length,osat:s.reduce((m,d)=>m+d.osat_decimal,0)/s.length}:{accuracy:0,zod:0,complaints:0,osat:0},g=m=>{if(m.length<4)return"neutral";const d=Math.floor(m.length/2),f=m.slice(0,d).reduce((M,v)=>M+v,0)/d,N=m.slice(d).reduce((M,v)=>M+v,0)/(m.length-d)-f;return Math.abs(N)<.1?"neutral":N>0?"up":"down"},l={accuracy:g(s.map(m=>m.accuracy_decimal).reverse()),zod:g(s.map(m=>m.zod_per_10k).reverse()),complaints:g(s.map(m=>m.cc_complaints).reverse()),osat:g(s.map(m=>m.osat_decimal).reverse())},u=(m,d=!1)=>d?m<=1?"text-green-600":m<=3?"text-yellow-600":"text-red-600":m>=90?"text-green-600":m>=80?"text-yellow-600":"text-red-600",x=(m,d=!1)=>d?m<=1?e.jsx(ke,{className:"h-4 w-4 text-green-600"}):m<=3?e.jsx(he,{className:"h-4 w-4 text-yellow-600"}):e.jsx(he,{className:"h-4 w-4 text-red-600"}):m>=90?e.jsx(ke,{className:"h-4 w-4 text-green-600"}):m>=80?e.jsx(he,{className:"h-4 w-4 text-yellow-600"}):e.jsx(he,{className:"h-4 w-4 text-red-600"}),p=m=>{switch(m){case"up":return e.jsx(me,{className:"h-3 w-3 text-green-600"});case"down":return e.jsx(je,{className:"h-3 w-3 text-red-600"});default:return null}};return o?e.jsx("div",{className:"wendys-card",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4"}),e.jsx("div",{className:"space-y-4",children:[...Array(4)].map((m,d)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32 mt-1"})]})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-12"})]},d))})]})}):e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"OSAT Snapshot (Last 30 Days)"}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(de,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{children:[s.length," entries"]})]})]}),s.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(de,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"font-medium",children:"No OSAT data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in the OSAT tab to see metrics"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(de,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"OSAT Score"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overall satisfaction"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p(l.osat),x(i.osat),e.jsx("span",{className:w("text-xl font-bold",u(i.osat)),children:i.osat.toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ke,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"Accuracy of Order"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Order accuracy metric"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p(l.accuracy),x(i.accuracy),e.jsx("span",{className:w("text-xl font-bold",u(i.accuracy)),children:i.accuracy.toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(he,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"ZOD per 10k"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zone of defection"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p(l.zod==="up"?"down":l.zod==="down"?"up":"neutral"),x(i.zod,!0),e.jsx("span",{className:w("text-xl font-bold",u(i.zod,!0)),children:i.zod.toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(he,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"CC Complaints"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Customer complaints"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p(l.complaints==="up"?"down":l.complaints==="down"?"up":"neutral"),x(i.complaints,!0),e.jsx("span",{className:w("text-xl font-bold",u(i.complaints,!0)),children:i.complaints.toFixed(1)})]})]})]})]})}function Ba(){const[t,n]=_.useState(null),s=k(new Date,"EEEE, MMMM d"),o=k(new Date,"yyyy-MM-dd");_.useEffect(()=>{let u=!0;return(async()=>{var C;console.log("ð [InterviewsToday] Checking user authentication...");const{data:x,error:p}=await E.auth.getUser();console.log("ð¤ [InterviewsToday] Auth data:",x,"Auth error:",p);const m=(C=x.user)==null?void 0:C.id;if(!m){console.log("â [InterviewsToday] No user ID found - user not authenticated");return}console.log("ð [InterviewsToday] Looking up store for user:",m);const{data:d,error:f}=await E.from("users").select("store_id").eq("id",m).maybeSingle();if(console.log("ðª [InterviewsToday] Store lookup result - data:",d,"error:",f),!!u){if(f){console.error("â [InterviewsToday] Store lookup error:",f);return}n((d==null?void 0:d.store_id)??null),console.log("â [InterviewsToday] Store ID set to:",(d==null?void 0:d.store_id)??null)}})(),()=>{u=!1}},[]);const{data:i=[],isLoading:g}=B({queryKey:["interviews-today",t,o],queryFn:async()=>{if(!t)return[];const{data:u,error:x}=await E.from("interviews").select("*").eq("store_id",t).eq("interview_date",o).order("interview_time",{ascending:!0});if(x)throw x;return u||[]},enabled:!!t}),l=u=>k(new Date(`2000-01-01T${u}`),"h:mm a");return e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Interviews Today"}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:s})]})]}),g?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):i.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Pt,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No interviews scheduled for today"})]}):e.jsx("div",{className:"space-y-3",children:i.map(u=>e.jsx(Ye,{to:"/interviews",className:"block p-4 border border-gray-200 rounded-lg hover:border-wendys-red hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-wendys-charcoal",children:u.candidate_name}),e.jsx("span",{className:Qa("px-2 py-1 text-xs font-medium rounded-full",ts(u.status)),children:u.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(et,{className:"h-3 w-3"}),e.jsx("span",{children:u.position})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(tt,{className:"h-3 w-3"}),e.jsx("span",{children:l(u.interview_time)})]})]}),u.notes&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 italic",children:['"',u.notes,'"']})]})})},u.id))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs(Ye,{to:"/interviews",className:"inline-flex items-center space-x-2 text-wendys-red hover:text-wendys-dark-red font-medium text-sm",children:[e.jsx("span",{children:"View all interviews"}),e.jsx("span",{children:"â"})]})})]})}function Qa(...t){return t.filter(Boolean).join(" ")}const _t=[{key:"today",label:"Today"},{key:"wtd",label:"WTD",description:"Week to Date"},{key:"mtd",label:"MTD",description:"Month to Date"},{key:"last7",label:"Last 7",description:"Last 7 Days"},{key:"last30",label:"Last 30",description:"Last 30 Days"},{key:"custom",label:"Custom"}];function rt({selectedRange:t="last30",selectedDate:n,onRangeChange:s,onDateChange:o,onClearFilters:i,className:g,compact:l=!1}){const u=t!=="last30"||n,x=m=>{s==null||s(m),m!=="custom"&&(o==null||o(void 0))},p=()=>{if(t==="custom"&&n)return k(n,"MMM dd, yyyy");const m=_t.find(d=>d.key===t);return(m==null?void 0:m.label)||"Last 30"};return e.jsxs("div",{className:w("flex items-center gap-3 p-4 bg-gray-50 rounded-lg border",l&&"p-3",g),children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{className:w("text-sm font-medium",l&&"hidden sm:inline"),children:"Filters:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:_t.map(m=>e.jsx(R,{variant:t===m.key?"default":"ghost",size:"sm",onClick:()=>x(m.key),className:w("text-xs h-7 px-2",t===m.key?"bg-wendys-red text-white hover:bg-wendys-red/90":"text-gray-600 hover:text-gray-900 hover:bg-gray-100",l&&"text-[11px] h-6 px-1.5"),title:m.description,children:m.label},m.key))}),t==="custom"&&e.jsxs(st,{children:[e.jsx(at,{asChild:!0,children:e.jsxs(R,{variant:"outline",size:"sm",className:w("justify-start text-left font-normal h-7",!n&&"text-muted-foreground",l&&"h-6 text-xs"),children:[e.jsx(te,{className:"mr-1 h-3 w-3"}),n?k(n,"MMM dd"):"Pick date"]})}),e.jsx(qe,{className:"w-auto p-0",align:"start",children:e.jsx(Le,{mode:"single",selected:n,onSelect:o,initialFocus:!0})})]}),!l&&u&&e.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-gray-500 border-l pl-3 ml-1",children:[e.jsx("span",{children:"Showing:"}),e.jsx("span",{className:"font-medium text-gray-700",children:p()})]}),u&&i&&e.jsxs(R,{variant:"ghost",size:"sm",onClick:i,className:w("text-xs text-gray-500 hover:text-gray-700 h-7 px-2",l&&"h-6 px-1.5"),children:[e.jsx(St,{className:"h-3 w-3 mr-1"}),"Clear"]})]})}function nt(t,n="last30"){const[s,o]=le.useState(()=>typeof window<"u"&&localStorage.getItem(`${t}_range`)||n),[i,g]=le.useState(()=>{if(typeof window<"u"){const m=localStorage.getItem(`${t}_date`);if(m){const[d,f,C]=m.split("-").map(Number);return new Date(d,(f||1)-1,C||1)}return}}),l=le.useCallback(m=>{o(m),typeof window<"u"&&localStorage.setItem(`${t}_range`,m)},[t]),u=le.useCallback(m=>{if(g(m),typeof window<"u")if(m){const d=k(m,"yyyy-MM-dd");localStorage.setItem(`${t}_date`,d)}else localStorage.removeItem(`${t}_date`)},[t]),x=le.useCallback(()=>{o(n),g(void 0),typeof window<"u"&&(localStorage.removeItem(`${t}_range`),localStorage.removeItem(`${t}_date`))},[t,n]),p=le.useCallback(()=>{if(s==="custom"&&i){const m=k(i,"yyyy-MM-dd");return{start:m,end:m}}if(s&&s!=="custom"){const m=Be(s);return m.start?{start:m.start,end:m.end}:null}return null},[s,i]);return{selectedRange:s,selectedDate:i,handleRangeChange:l,handleDateChange:u,clearFilters:x,getDateRangeFilter:p,getSelectedLabel:()=>s==="custom"&&i?k(i,"MMM dd, yyyy"):Be(s).label}}const Ja=oe("/overview")({component:Xa});function Xa(){const[t,n]=_.useState(null),s=nt("overview","today");_.useEffect(()=>{let p=!0;return(async()=>{var N;const{data:m}=await E.auth.getUser(),d=(N=m.user)==null?void 0:N.id;if(!d)return;const{data:f,error:C}=await E.from("users").select("store_id").eq("id",d).maybeSingle();if(p){if(C){console.error("Error fetching store ID:",C);return}n((f==null?void 0:f.store_id)??null)}})(),()=>{p=!1}},[]);const o=s.getDateRangeFilter(),{data:i=[]}=B({queryKey:["overview-charts",t],queryFn:async()=>{if(!t)return[];const p=new Date;p.setDate(p.getDate()-30);const m=p.toISOString().slice(0,10),{data:d,error:f}=await E.from("omega_daily").select("*").eq("store_id",t).gte("business_date",m).order("business_date",{ascending:!0});if(f)throw f;return d||[]},enabled:!!t}),{data:g=[],isLoading:l,error:u}=B({queryKey:["overview-omega",t,o==null?void 0:o.start,o==null?void 0:o.end],queryFn:async()=>{if(!t)return[];let p=E.from("omega_daily").select("*").eq("store_id",t);o&&(p=p.gte("business_date",o.start).lte("business_date",o.end));const{data:m,error:d}=await p.order("business_date",{ascending:!0});if(d)throw d;return m||[]},enabled:!!t}),x=_.useMemo(()=>{if(g.length===0)return{netSales:0,compNetSales:0,laborHours:0,idealLaborHours:0,laborPercentage:0,foodVarianceCost:0,foodVariancePercentage:0,wasteAmount:0,wastePercentage:0,breakfastSales:0,nightSales:0};const p=g.reduce((C,N)=>({netSales:C.netSales+(N.net_sales||0),compNetSales:C.compNetSales+((N.net_sales||0)-(N.last_year_sales||0)),laborHours:C.laborHours+(N.labor_hours||0),idealLaborHours:C.idealLaborHours+(N.ideal_labor_hours||0),foodVarianceCost:C.foodVarianceCost+(N.food_variance_cost||0),wasteAmount:C.wasteAmount+(N.waste_amount||0),breakfastSales:C.breakfastSales+(N.breakfast_sales||0),nightSales:C.nightSales+(N.night_sales||0)}),{netSales:0,compNetSales:0,laborHours:0,idealLaborHours:0,foodVarianceCost:0,wasteAmount:0,breakfastSales:0,nightSales:0}),m=p.netSales>0?p.laborHours/p.netSales*100:0,d=p.netSales>0?p.foodVarianceCost/p.netSales*100:0,f=p.netSales>0?p.wasteAmount/p.netSales*100:0;return{...p,laborPercentage:m,foodVariancePercentage:d,wastePercentage:f}},[g]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Overview"}),e.jsxs("p",{className:"text-gray-600",children:["Key metrics and performance indicators for ",s.getSelectedLabel(),l&&e.jsx("span",{className:"ml-2 text-sm",children:"(Loading...)"})]}),u&&e.jsxs("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:["Error loading data: ",u.message]})]}),e.jsx(rt,{selectedRange:s.selectedRange,selectedDate:s.selectedDate,onRangeChange:s.handleRangeChange,onDateChange:s.handleDateChange,onClearFilters:s.clearFilters,compact:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(ie,{title:"Net Sales",value:x.netSales,format:"currency",delta:x.compNetSales,deltaLabel:"vs Last Year",icon:He,trend:x.compNetSales>=0?"up":"down"}),e.jsx(ie,{title:"Labor Hours",value:x.laborHours,format:"number",delta:x.laborHours-x.idealLaborHours,deltaLabel:"vs Ideal",icon:tt,trend:x.laborHours>x.idealLaborHours?"down":"up",suffix:"hrs"}),e.jsx(ie,{title:"Labor %",value:x.laborPercentage,format:"percentage",icon:me,trend:"neutral"}),e.jsx(ie,{title:"Food Variance",value:x.foodVarianceCost,format:"currency",delta:x.foodVariancePercentage,deltaLabel:"% of Sales",icon:je,trend:x.foodVarianceCost>=0?"down":"up"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(ie,{title:"Waste Amount",value:x.wasteAmount,format:"currency",delta:x.wastePercentage,deltaLabel:"% of Sales",icon:je,trend:x.wasteAmount>=0?"down":"up"}),e.jsx(ie,{title:"Breakfast Sales",value:x.breakfastSales,format:"currency",icon:He,trend:"neutral"}),e.jsx(ie,{title:"Night Sales",value:x.nightSales,format:"currency",icon:He,trend:"neutral"}),e.jsx(ie,{title:"Comp Net Sales",value:x.compNetSales,format:"currency",icon:me,trend:x.compNetSales>=0?"up":"down"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(Ne,{title:"Net Sales Trend",subtitle:"Last 30 days",loading:!i.length&&!u,error:u==null?void 0:u.message,children:i.length>0?e.jsx(Ga,{data:i}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in OMEGA Daily to see trends"})]})})}),e.jsx(Ne,{title:"Labor Hours vs Ideal",subtitle:"Last 30 days",loading:!i.length&&!u,error:u==null?void 0:u.message,children:i.length>0?e.jsx(Ya,{data:i}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in OMEGA Daily to see trends"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ka,{}),e.jsx(Ba,{})]})]})}function Za({columns:t,data:n,mobileCardRender:s,className:o,emptyMessage:i="No data available",loading:g=!1}){if(g)return e.jsx(er,{columns:t});const l=u=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-2",children:t.map(x=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[x.label,":"]}),e.jsx("span",{className:"text-sm",children:x.render?x.render(u[x.key],u):u[x.key]})]},x.key))});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:w("hidden md:block",o),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200",children:t.map(u=>e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 text-sm",children:u.label},u.key))})}),e.jsx("tbody",{children:n.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"py-8 px-4 text-center text-gray-500",children:i})}):n.map((u,x)=>e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:t.map(p=>e.jsx("td",{className:w("py-3 px-4 text-sm",p.className),children:p.render?p.render(u[p.key],u):u[p.key]},p.key))},u.id||x))})]})})}),e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:i}):n.map((u,x)=>e.jsx("div",{children:s?s(u):l(u)},u.id||x))})})]})}function er({columns:t}){return e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200",children:t.map(n=>e.jsx("th",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})},n.key))})}),e.jsx("tbody",{children:[...Array(3)].map((n,s)=>e.jsx("tr",{className:"border-b border-gray-100",children:t.map(o=>e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-100 rounded w-full"})},o.key))},s))})]})})})}const tr=oe("/omega-daily")({component:sr});function sr(){const[t,n]=_.useState(!1),[s,o]=_.useState(null),{toast:i}=se(),g=Pe(),[l,u]=_.useState(null),x=nt("omega-daily","last30"),p=async()=>{if(!l){i({title:"Store not linked",description:"Please link your account to a store first.",variant:"destructive"});return}try{const a=[],h=new Date;for(let y=9;y>=0;y--){const T=new Date(h);T.setDate(T.getDate()-y),a.push({store_id:l,business_date:k(T,"yyyy-MM-dd"),net_sales:Math.floor(Math.random()*5e3)+8e3,last_year_sales:Math.floor(Math.random()*4e3)+7e3,labor_hours:Math.floor(Math.random()*40)+60,ideal_labor_hours:Math.floor(Math.random()*30)+50,labor_percentage:Math.floor(Math.random()*10)+15,food_variance_cost:Math.floor(Math.random()*200)-100,waste_amount:Math.floor(Math.random()*100)+50,breakfast_sales:Math.floor(Math.random()*1e3)+500,night_sales:Math.floor(Math.random()*1500)+1e3})}const{error:r}=await E.from("omega_daily").insert(a);if(r)throw r;i({title:"Sample data added!",description:"10 days of sample OMEGA entries have been created."}),g.invalidateQueries({queryKey:["omega_daily","last30",l]})}catch(a){i({title:"Error adding sample data",description:a.message,variant:"destructive"})}},m=()=>{g.invalidateQueries({queryKey:["omega_daily",l]}),i({title:"Refreshing data...",description:"Reloading your OMEGA entries."})},d=Fe({resolver:Ve(Ia),defaultValues:{business_date:k(new Date,"yyyy-MM-dd"),net_sales:0,last_year_sales:0,labor_hours:0,ideal_labor_hours:0,labor_percentage:0,food_variance_cost:0,waste_amount:0,breakfast_sales:0,night_sales:0}}),f=ee({onMutate:async a=>{if(!l)throw new Error("No store is linked to your account. See Setup to link one.");await g.cancelQueries({queryKey:["omega_daily"]});const h=`temp-${Date.now()}`,r={id:h,store_id:l,business_date:a.business_date,net_sales:a.net_sales,last_year_sales:a.last_year_sales,labor_hours:a.labor_hours,ideal_labor_hours:a.ideal_labor_hours,labor_percentage:a.labor_percentage,food_variance_cost:a.food_variance_cost,waste_amount:a.waste_amount,breakfast_sales:a.breakfast_sales,night_sales:a.night_sales},y=[],T=g.getQueriesData({queryKey:["omega_daily"]});for(const[V,X]of T){const Z=V;if(!Z.includes(l))continue;let Y=!0;const it=typeof Z[2]=="string"?String(Z[2]):void 0,ot=typeof Z[3]=="string"?String(Z[3]):void 0;if(it&&ot&&(Y=a.business_date>=it&&a.business_date<=ot),!Y)continue;const lt=[r,...X||[]];lt.sort((dt,ct)=>dt.business_date>ct.business_date?-1:dt.business_date<ct.business_date?1:0),y.push({queryKey:V,previousData:X}),g.setQueryData(V,lt)}return{optimisticId:h,touchedCaches:y}},mutationFn:async a=>{if(console.log("ð Starting insertMutation with payload:",a),console.log("ðª Store ID:",l),!l)throw console.error("â No store ID found"),new Error("No store is linked to your account. See Setup to link one.");const h={store_id:l,business_date:a.business_date,net_sales:a.net_sales,last_year_sales:a.last_year_sales,labor_hours:a.labor_hours,ideal_labor_hours:a.ideal_labor_hours,labor_percentage:a.labor_percentage,food_variance_cost:a.food_variance_cost,waste_amount:a.waste_amount,breakfast_sales:a.breakfast_sales,night_sales:a.night_sales};console.log("ð¤ Inserting data:",h);const{data:r,error:y}=await E.from("omega_daily").insert(h).select();if(console.log("ð¥ Supabase response - data:",r,"error:",y),y)throw console.error("â Supabase error:",y),y;return console.log("â Insert successful:",r),r},onError:(a,h,r)=>{if(r!=null&&r.touchedCaches)for(const{queryKey:y,previousData:T}of r.touchedCaches)g.setQueryData(y,T||[]);console.error("ð¥ Insert mutation failed (rolled back):",a),i({title:"Save failed",description:(a==null?void 0:a.message)||"Unable to save entry.",variant:"destructive"})},onSuccess:(a,h,r)=>{console.log("ð Insert mutation succeeded with data:",a),i({title:"Success!",description:"Daily metrics saved successfully."});const y=Array.isArray(a)&&a[0]?a[0]:void 0;if(y&&(r!=null&&r.touchedCaches)&&r.optimisticId)for(const{queryKey:T}of r.touchedCaches){const X=(g.getQueryData(T)??[]).map(Z=>Z.id===r.optimisticId?y:Z);g.setQueryData(T,X)}n(!1),o(null),d.reset()}}),C=ee({mutationFn:async({id:a,payload:h})=>{if(!l)throw new Error("No store is linked to your account. See Setup to link one.");const{error:r}=await E.from("omega_daily").update({business_date:h.business_date,net_sales:h.net_sales,last_year_sales:h.last_year_sales,labor_hours:h.labor_hours,ideal_labor_hours:h.ideal_labor_hours,labor_percentage:h.labor_percentage,food_variance_cost:h.food_variance_cost,waste_amount:h.waste_amount,breakfast_sales:h.breakfast_sales,night_sales:h.night_sales}).eq("id",a);if(r)throw r},onSuccess:()=>{i({title:"Updated!",description:"Daily metrics updated successfully."}),n(!1),o(null),d.reset(),g.invalidateQueries({queryKey:["omega_daily","last30",l]})},onError:a=>{i({title:"Update failed",description:a.message,variant:"destructive"})}}),N=a=>{console.log("ð onSubmit called with data:",a),console.log("ð Form errors:",d.formState.errors),console.log("ðª Store ID:",l),console.log("âï¸ Editing entry:",s),console.log("ð Insert mutation pending:",f.isPending),console.log("ð Update mutation pending:",C.isPending),s?(console.log("ð Calling updateMutation..."),C.mutate({id:s.id,payload:a})):(console.log("â Calling insertMutation..."),f.mutate(a))},M=a=>{console.error("â Form validation failed with errors:",a),i({title:"Validation Error",description:"Please check the form for errors and try again.",variant:"destructive"})},v=ee({mutationFn:async a=>{const{error:h}=await E.from("omega_daily").delete().eq("id",a);if(h)throw h},onSuccess:()=>{i({title:"Deleted",description:"Daily metrics entry removed."}),g.invalidateQueries({queryKey:["omega_daily","last30",l]})},onError:a=>{i({title:"Delete failed",description:a.message,variant:"destructive"})}});_.useEffect(()=>{let a=!0;return(async()=>{var X;console.log("ð Checking user authentication...");const{data:h,error:r}=await E.auth.getUser();console.log("ð¤ Auth data:",h,"Auth error:",r);const y=(X=h.user)==null?void 0:X.id;if(!y){console.log("â No user ID found - user not authenticated");return}console.log("ð Looking up store for user:",y);const{data:T,error:V}=await E.from("users").select("store_id").eq("id",y).maybeSingle();if(console.log("ðª Store lookup result - data:",T,"error:",V),!!a){if(V){console.error("â Store lookup error:",V),i({title:"Connection Error",description:"Unable to connect to your store. Please check your setup.",variant:"destructive"});return}u((T==null?void 0:T.store_id)??null),console.log("â Store ID set to:",(T==null?void 0:T.store_id)??null),T!=null&&T.store_id||(console.log("â ï¸ No store linked to user account"),i({title:"Store Not Linked",description:"Your account isn't linked to a store yet. Please go to Setup to link your account.",variant:"destructive"}))}})(),()=>{a=!1}},[]);const c=x.getDateRangeFilter(),{data:D=[],isLoading:U,error:L}=B({queryKey:["omega_daily",l,c==null?void 0:c.start,c==null?void 0:c.end],queryFn:async()=>{if(!l)return[];let a=E.from("omega_daily").select("*").eq("store_id",l);c&&(a=a.gte("business_date",c.start).lte("business_date",c.end));const{data:h,error:r}=await a.order("business_date",{ascending:!1}).limit(100);if(r)throw r;return h},enabled:!!l}),{data:P=[]}=B({queryKey:["omega_daily_charts",l],queryFn:async()=>{if(!l)return[];const a=new Date;a.setDate(a.getDate()-30);const h=k(a,"yyyy-MM-dd"),{data:r,error:y}=await E.from("omega_daily").select("*").eq("store_id",l).gte("business_date",h).order("business_date",{ascending:!0});if(y)throw y;return r},enabled:!!l}),{data:W=[]}=B({queryKey:["omega_daily_mtd",l],queryFn:async()=>{if(!l)return[];const{start:a,end:h}=Be("mtd"),{data:r,error:y}=await E.from("omega_daily").select("*").eq("store_id",l).gte("business_date",a).lte("business_date",h).order("business_date",{ascending:!0});if(y)throw y;return r},enabled:!!l}),z=a=>{if(!a)return;x.handleRangeChange("custom");const h=Number(a.slice(0,4)),r=Number(a.slice(5,7)),y=Number(a.slice(8,10));x.handleDateChange(new Date(h,(r||1)-1,y||1))},re=_.useMemo(()=>P.length?P.map(a=>({date:H.dateShort(a.business_date),dateFull:H.dateFull(a.business_date),isoDate:(typeof a.business_date=="string",a.business_date),comp_net_sales_percentage:a.last_year_sales?(a.net_sales-a.last_year_sales)/a.last_year_sales*100:0})):[],[P]),ne=_.useMemo(()=>P.length?P.map(a=>({date:H.dateShort(a.business_date),dateFull:H.dateFull(a.business_date),isoDate:(typeof a.business_date=="string",a.business_date),waste_percentage:a.net_sales?a.waste_amount/a.net_sales*100:0,food_variance_percentage:a.net_sales?-(a.food_variance_cost/a.net_sales)*100:0})):[],[P]),xe=a=>{o(a);const h={business_date:a.business_date||k(new Date,"yyyy-MM-dd"),net_sales:a.net_sales!=null?Number(a.net_sales):0,last_year_sales:a.last_year_sales!=null?Number(a.last_year_sales):0,labor_hours:a.labor_hours!=null?Number(a.labor_hours):0,ideal_labor_hours:a.ideal_labor_hours!=null?Number(a.ideal_labor_hours):0,labor_percentage:a.labor_percentage!=null?Number(a.labor_percentage):0,food_variance_cost:a.food_variance_cost!=null?Number(a.food_variance_cost):0,waste_amount:a.waste_amount!=null?Number(a.waste_amount):0,breakfast_sales:a.breakfast_sales!=null?Number(a.breakfast_sales):0,night_sales:a.night_sales!=null?Number(a.night_sales):0};d.reset(h),n(!0)},we=a=>{v.mutate(a)},G=d.watch(),b=G.last_year_sales>0?(G.net_sales-G.last_year_sales)/G.last_year_sales*100:0,S=G.labor_hours-G.ideal_labor_hours,j=G.net_sales>0?G.food_variance_cost/G.net_sales*100:0,Q=G.net_sales>0?G.waste_amount/G.net_sales*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-wendys-charcoal",children:"Omega Daily"}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Daily business metrics and performance tracking"})]}),e.jsxs("div",{className:"flex flex-col space-y-2 md:flex-row md:space-y-0 md:space-x-2 md:items-center",children:[e.jsxs(R,{onClick:()=>{o(null),d.reset({business_date:k(new Date,"yyyy-MM-dd"),net_sales:0,last_year_sales:0,labor_hours:0,ideal_labor_hours:0,labor_percentage:0,food_variance_cost:0,waste_amount:0,breakfast_sales:0,night_sales:0}),n(!0)},className:"wendys-button w-full md:w-auto",size:"sm",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Add Daily Entry"]}),l&&e.jsxs("div",{className:"flex space-x-2 md:space-x-0 md:flex-col md:space-y-2",children:[e.jsx(R,{onClick:p,variant:"outline",size:"sm",className:"flex-1 md:flex-none border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:"Sample Data"}),e.jsx(R,{onClick:m,variant:"outline",size:"sm",className:"flex-1 md:flex-none border-gray-400 text-gray-600 hover:bg-gray-100",children:"Refresh"})]})]})]}),e.jsx("div",{className:"wendys-card",children:(()=>{const a=W.reduce((T,V)=>T+(Number(V.net_sales)||0),0),h=W.length>0?W.reduce((T,V)=>T+(Number(V.labor_percentage)||0),0)/W.length:0,r=W.reduce((T,V)=>T+(Number(V.waste_amount)||0),0),y=a>0?r/a*100:0;return e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Net Sales"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:ye(a)})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Labor %"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:K(h)})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Waste %"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:K(y)})]})]})})()}),e.jsx(rt,{selectedRange:x.selectedRange,selectedDate:x.selectedDate,onRangeChange:x.handleRangeChange,onDateChange:x.handleDateChange,onClearFilters:x.clearFilters}),L&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:["Error loading data: ",L.message]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[e.jsx(Ne,{title:"Comp Net Sales Trend",subtitle:"Last 30 days",loading:!P.length&&!L,error:L==null?void 0:L.message,children:re.length>0?e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Ce,{data:re,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:a=>H.percent(a)}),e.jsx(be,{...F.tooltip,formatter:a=>[H.percent(a,1),"Comp Sales %"],labelFormatter:(a,h)=>{var r;return h&&h[0]&&((r=h[0].payload)==null?void 0:r.dateFull)||a}}),e.jsx(ve,{type:"monotone",dataKey:"comp_net_sales_percentage",stroke:O.sales,strokeWidth:2,dot:{fill:O.sales,strokeWidth:2,r:3},activeDot:{r:5,stroke:O.salesSecondary,strokeWidth:2},onClick:a=>{var h;return z((h=a==null?void 0:a.payload)==null?void 0:h.isoDate)}})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})}),e.jsx(Ne,{title:"Waste Percentage",subtitle:"Last 30 days",loading:!P.length&&!L,error:L==null?void 0:L.message,children:ne.length>0?e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Gt,{data:ne,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:a=>H.percent(a)}),e.jsx(be,{...F.tooltip,formatter:a=>[H.percent(a,2),"Waste %"],labelFormatter:(a,h)=>{var r;return h&&h[0]&&((r=h[0].payload)==null?void 0:r.dateFull)||a}}),e.jsx(ut,{y:.5,stroke:O.textSecondary,strokeDasharray:"4 4",label:{value:"Goal 0.5%",position:"right",fill:O.textSecondary,fontSize:12}}),e.jsx(Yt,{dataKey:"waste_percentage",fill:O.waste,opacity:.7,onClick:a=>{var h;return z((h=a==null?void 0:a.payload)==null?void 0:h.isoDate)}})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})}),e.jsx(Ne,{title:"Food Variance",subtitle:"Last 30 days",loading:!P.length&&!L,error:L==null?void 0:L.message,children:ne.length>0?e.jsx(ce,{width:"100%",height:300,children:e.jsxs(Ce,{data:ne,children:[e.jsx(pe,{...F.cartesianGrid}),e.jsx(fe,{dataKey:"date",...F.xAxis}),e.jsx(_e,{...F.yAxis,tickFormatter:a=>H.percent(a)}),e.jsx(be,{...F.tooltip,formatter:(a,h,r)=>{var T;const y=((T=r==null?void 0:r.payload)==null?void 0:T.food_variance_percentage)!==void 0?-r.payload.food_variance_percentage:0;return[H.percent(y,2),"Food Variance %"]},labelFormatter:(a,h)=>{var r;return h&&h[0]&&((r=h[0].payload)==null?void 0:r.dateFull)||a}}),e.jsx(ut,{y:0,stroke:O.textSecondary,strokeDasharray:"4 4",label:{value:"Target 0%",position:"right",fill:O.textSecondary,fontSize:12}}),e.jsx(ve,{type:"monotone",dataKey:"food_variance_percentage",stroke:O.foodVariance,strokeWidth:2,dot:{fill:O.foodVariance,strokeWidth:2,r:3},activeDot:{r:5,stroke:O.warning,strokeWidth:2},onClick:a=>{var h;return z((h=a==null?void 0:a.payload)==null?void 0:h.isoDate)}})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:x.selectedRange==="last30"?"All Entries":"Filtered Entries"}),e.jsxs("div",{className:"text-xs md:text-sm text-gray-600 flex items-center",children:[U?"Loading...":`${D.length} entries`,x.selectedRange!=="last30"&&` for ${x.getSelectedLabel()}`,(x.selectedRange!=="last30"||x.selectedDate)&&e.jsx(R,{variant:"ghost",size:"sm",onClick:x.clearFilters,className:"ml-3 text-xs text-gray-600 hover:text-gray-900",children:"Show All"})]})]}),(D==null?void 0:D.length)===0&&!U?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:l?e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"No data found"}),e.jsx("p",{className:"text-sm mt-2",children:x.selectedRange==="last30"?"You haven't added any daily entries yet.":"No entries found for the selected filter. Try changing the filter or adding a new entry."})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"Store not connected"}),e.jsx("p",{className:"text-sm mt-2",children:"Please go to Setup to link your account to a store first."})]})}),l&&e.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3 justify-center",children:[e.jsxs(R,{onClick:()=>n(!0),className:"wendys-button",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Add Your First Entry"]}),e.jsx(R,{onClick:p,variant:"outline",className:"border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:"Generate Sample Data"})]})]}):e.jsx(Za,{columns:[{key:"business_date",label:"Date",render:a=>Se(a)},{key:"net_sales",label:"Net Sales",render:a=>ye(a)},{key:"comp_sales",label:"Comp Sales",render:(a,h)=>{const r=(h.net_sales??0)-(h.last_year_sales??0);return e.jsxs("span",{className:`flex items-center ${r>=0?"text-green-600":"text-red-600"}`,children:[r>=0?e.jsx(me,{className:"h-3 w-3 mr-1"}):e.jsx(je,{className:"h-3 w-3 mr-1"}),ye(Math.abs(r))]})}},{key:"labor_hours",label:"Labor Hours",render:a=>`${a}h`},{key:"labor_percentage",label:"Labor %",render:a=>K(a)},{key:"food_variance",label:"Food Variance",render:(a,h)=>{const r=h.net_sales?h.food_variance_cost/h.net_sales*100:0;return K(r)}},{key:"waste",label:"Waste",render:(a,h)=>{const r=h.net_sales?h.waste_amount/h.net_sales*100:0;return K(r)}},{key:"actions",label:"Actions",render:(a,h)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>xe(h),className:"h-8 w-8 p-0",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>{z(h.business_date),i({title:"Details",description:"Detailed view coming soon."})},className:"h-8 w-8 p-0",title:"View details",children:e.jsx(Ht,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>we(h.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})}],data:D,mobileCardRender:a=>{const h=(a.net_sales??0)-(a.last_year_sales??0),r=a.net_sales?a.food_variance_cost/a.net_sales*100:0,y=a.net_sales?a.waste_amount/a.net_sales*100:0;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-900",children:Se(a.business_date)}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>xe(a),className:"h-8 w-8 p-0",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>we(a.id),className:"h-8 w-8 p-0 text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Net Sales:"}),e.jsx("div",{className:"font-medium",children:ye(a.net_sales)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Comp Sales:"}),e.jsxs("div",{className:`font-medium flex items-center ${h>=0?"text-green-600":"text-red-600"}`,children:[h>=0?e.jsx(me,{className:"h-3 w-3 mr-1"}):e.jsx(je,{className:"h-3 w-3 mr-1"}),ye(Math.abs(h))]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Labor:"}),e.jsxs("div",{className:"font-medium",children:[a.labor_hours,"h (",K(a.labor_percentage),")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Food Variance:"}),e.jsx("div",{className:"font-medium",children:K(r)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Waste:"}),e.jsx("div",{className:"font-medium",children:K(y)})]})]})]})},emptyMessage:"No entries found",loading:U})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-wendys-charcoal",children:s?"Edit Daily Entry":"Add Daily Entry"}),e.jsx(R,{variant:"ghost",onClick:()=>{n(!1),o(null),d.reset()},className:"h-8 w-8 p-0",children:"Ã"})]}),e.jsxs("form",{onSubmit:d.handleSubmit(N,M),className:"space-y-4",children:[Object.keys(d.formState.errors).length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Please fix the following errors:"}),e.jsx("ul",{className:"text-sm text-red-700 mt-1 space-y-1",children:Object.entries(d.formState.errors).map(([a,h])=>e.jsxs("li",{children:["â¢ ",h==null?void 0:h.message]},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(A,{children:"Business Date"}),e.jsxs(st,{children:[e.jsx(at,{asChild:!0,children:e.jsxs(R,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),d.watch("business_date")?Se(d.watch("business_date")):"Pick a date"]})}),e.jsx(qe,{className:"w-auto p-0",children:e.jsx(Le,{mode:"single",selected:(()=>{const a=d.watch("business_date");if(!a)return;const h=Number(a.slice(0,4)),r=Number(a.slice(5,7)),y=Number(a.slice(8,10));return new Date(h,(r||1)-1,y||1)})(),onSelect:a=>{const h=a?k(a,"yyyy-MM-dd"):"";if(d.setValue("business_date",h),h){const r=D.find(y=>y.business_date===h);r?(o(r),d.reset({business_date:r.business_date,net_sales:r.net_sales!=null?Number(r.net_sales):0,last_year_sales:r.last_year_sales!=null?Number(r.last_year_sales):0,labor_hours:r.labor_hours!=null?Number(r.labor_hours):0,ideal_labor_hours:r.ideal_labor_hours!=null?Number(r.ideal_labor_hours):0,labor_percentage:r.labor_percentage!=null?Number(r.labor_percentage):0,food_variance_cost:r.food_variance_cost!=null?Number(r.food_variance_cost):0,waste_amount:r.waste_amount!=null?Number(r.waste_amount):0,breakfast_sales:r.breakfast_sales!=null?Number(r.breakfast_sales):0,night_sales:r.night_sales!=null?Number(r.night_sales):0}),i({title:"Loaded existing entry",description:`Loaded data for ${Se(r.business_date)} to edit.`})):(o(null),d.reset({business_date:h,net_sales:0,last_year_sales:0,labor_hours:0,ideal_labor_hours:0,labor_percentage:0,food_variance_cost:0,waste_amount:0,breakfast_sales:0,night_sales:0}))}},initialFocus:!0})})]}),d.formState.errors.business_date&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.business_date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"net_sales",children:"Net Sales ($)"}),e.jsx(I,{id:"net_sales",type:"number",step:"0.01",...d.register("net_sales")}),d.formState.errors.net_sales&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.net_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"last_year_sales",children:"Last Year Sales ($)"}),e.jsx(I,{id:"last_year_sales",type:"number",step:"0.01",...d.register("last_year_sales")}),d.formState.errors.last_year_sales&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.last_year_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"comp_net_sales",children:"Comp Net Sales (%)"}),e.jsx(I,{id:"comp_net_sales",value:K(b),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"labor_hours",children:"Labor Hours"}),e.jsx(I,{id:"labor_hours",type:"number",step:"0.1",...d.register("labor_hours")}),d.formState.errors.labor_hours&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.labor_hours.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"ideal_labor_hours",children:"Ideal Labor Hours"}),e.jsx(I,{id:"ideal_labor_hours",type:"number",step:"0.1",...d.register("ideal_labor_hours")}),d.formState.errors.ideal_labor_hours&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.ideal_labor_hours.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"labor_hours_diff",children:"Labor Hours +/-"}),e.jsx(I,{id:"labor_hours_diff",value:`${S>=0?"+":""}${S.toFixed(1)}h`,disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"labor_percentage",children:"Labor Percentage (%)"}),e.jsx(I,{id:"labor_percentage",type:"number",step:"0.1",...d.register("labor_percentage")}),d.formState.errors.labor_percentage&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.labor_percentage.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"food_variance_cost",children:"Food Variance Cost ($)"}),e.jsx(I,{id:"food_variance_cost",type:"number",step:"0.01",...d.register("food_variance_cost")}),d.formState.errors.food_variance_cost&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.food_variance_cost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"food_variance_percentage",children:"Food Variance %"}),e.jsx(I,{id:"food_variance_percentage",value:K(j),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"waste_amount",children:"Waste Amount ($)"}),e.jsx(I,{id:"waste_amount",type:"number",step:"0.01",...d.register("waste_amount")}),d.formState.errors.waste_amount&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.waste_amount.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"waste_percentage",children:"Waste %"}),e.jsx(I,{id:"waste_percentage",value:K(Q),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"breakfast_sales",children:"Breakfast Sales ($)"}),e.jsx(I,{id:"breakfast_sales",type:"number",step:"0.01",...d.register("breakfast_sales")}),d.formState.errors.breakfast_sales&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.breakfast_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"night_sales",children:"Night Sales ($)"}),e.jsx(I,{id:"night_sales",type:"number",step:"0.01",...d.register("night_sales")}),d.formState.errors.night_sales&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.night_sales.message})]})]}),!l&&e.jsx("div",{className:"text-sm text-red-600",children:"Your account isnât linked to a store yet. Open Setup and link your user to a store, then try again."}),e.jsxs("div",{className:"flex flex-col-reverse space-y-2 space-y-reverse md:flex-row md:space-y-0 md:space-x-3 pt-4 md:col-span-2",children:[e.jsx(R,{type:"button",variant:"outline",onClick:()=>{n(!1),o(null),d.reset()},className:"w-full md:w-auto",children:"Cancel"}),e.jsx(R,{type:"submit",className:"wendys-button w-full md:w-auto",disabled:f.isPending||C.isPending||!l,children:s?"Update Entry":"Save Entry"})]})]})]})})]})}const Ue=_.forwardRef(({className:t,...n},s)=>e.jsx("textarea",{className:w("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n}));Ue.displayName="Textarea";const ar=oe("/calendar")({component:rr});function rr(){var Q,a,h;const[t,n]=_.useState(!1),[s,o]=_.useState(!1),[i,g]=_.useState(null),[l,u]=_.useState(null),[x,p]=_.useState(new Date),[m,d]=_.useState("month"),{toast:f}=se(),C=Pe(),[N,M]=_.useState(null);_.useEffect(()=>{(async()=>{const{data:{user:y}}=await E.auth.getUser();M((y==null?void 0:y.id)||null)})()},[]);const{data:v=[]}=B({queryKey:["calendar-events",N],queryFn:async()=>{if(!N)return[];const{data:r,error:y}=await E.from("calendar_events").select("*").eq("created_by",N).order("start_date",{ascending:!0});if(y)throw y;return r||[]},enabled:!!N}),{data:c=[]}=B({queryKey:["calendar-reminders",N],queryFn:async()=>{if(!N)return[];const{data:r,error:y}=await E.from("calendar_reminders").select("*").eq("created_by",N).order("due_date",{ascending:!0});if(y)throw y;return r||[]},enabled:!!N}),D=ee({mutationFn:async r=>{if(!N)throw new Error("User not authenticated");if(i){const{error:y}=await E.from("calendar_events").update({...r,updated_at:new Date().toISOString()}).eq("id",i.id);if(y)throw y}else{const{error:y}=await E.from("calendar_events").insert({...r,created_by:N,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(y)throw y}},onSuccess:()=>{f({title:i?"Event updated!":"Event created!",description:i?"Your event has been updated successfully.":"Your event has been created successfully."}),n(!1),g(null),C.invalidateQueries({queryKey:["calendar-events",N]})},onError:r=>{f({title:"Error",description:r.message||"Failed to save event",variant:"destructive"})}}),U=ee({mutationFn:async r=>{if(!N)throw new Error("User not authenticated");if(l){const{error:y}=await E.from("calendar_reminders").update({...r,updated_at:new Date().toISOString()}).eq("id",l.id);if(y)throw y}else{const{error:y}=await E.from("calendar_reminders").insert({...r,created_by:N,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(y)throw y}},onSuccess:()=>{f({title:l?"Reminder updated!":"Reminder created!",description:l?"Your reminder has been updated successfully.":"Your reminder has been created successfully."}),o(!1),u(null),C.invalidateQueries({queryKey:["calendar-reminders",N]})},onError:r=>{f({title:"Error",description:r.message||"Failed to save reminder",variant:"destructive"})}}),L=ee({mutationFn:async r=>{const{error:y}=await E.from("calendar_events").delete().eq("id",r);if(y)throw y},onSuccess:()=>{f({title:"Event deleted",description:"Event has been removed successfully."}),C.invalidateQueries({queryKey:["calendar-events",N]})},onError:r=>{f({title:"Delete failed",description:r.message,variant:"destructive"})}}),P=ee({mutationFn:async r=>{const{error:y}=await E.from("calendar_reminders").delete().eq("id",r);if(y)throw y},onSuccess:()=>{f({title:"Reminder deleted",description:"Reminder has been removed successfully."}),C.invalidateQueries({queryKey:["calendar-reminders",N]})},onError:r=>{f({title:"Delete failed",description:r.message,variant:"destructive"})}}),W=ee({mutationFn:async({id:r,completed:y})=>{const{error:T}=await E.from("calendar_reminders").update({completed:y,updated_at:new Date().toISOString()}).eq("id",r);if(T)throw T},onSuccess:()=>{C.invalidateQueries({queryKey:["calendar-reminders",N]})},onError:r=>{f({title:"Error",description:r.message,variant:"destructive"})}}),z=v.filter(r=>Ee(ge(r.start_date),x)),re=c.filter(r=>Ee(ge(r.due_date),x)),ne=zs({start:$s(x),end:Gs(x)}),xe=r=>v.filter(y=>Ee(ge(y.start_date),r)),we=r=>c.filter(y=>Ee(ge(y.due_date),r)),G=r=>{r&&p(r)},b=r=>{g(r||null),n(!0)},S=r=>{u(r||null),o(!0)},j=r=>{switch(r){case"high":return e.jsx(de,{className:"h-3 w-3 fill-red-500 text-red-500"});case"medium":return e.jsx(de,{className:"h-3 w-3 fill-yellow-500 text-yellow-500"});case"low":return e.jsx(de,{className:"h-3 w-3 fill-green-500 text-green-500"});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-wendys-red via-red-600 to-wendys-dark-red opacity-10"}),e.jsx("div",{className:"relative px-6 py-8 sm:px-8 lg:px-12",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-4xl lg:text-5xl font-bold bg-gradient-to-r from-wendys-charcoal to-gray-700 bg-clip-text text-transparent",children:"Calendar"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl",children:"Organize your schedule with beautiful events and smart reminders"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(R,{onClick:()=>b(),className:"wendys-button shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[e.jsx(Re,{className:"h-5 w-5 mr-2"}),"Add Event"]}),e.jsxs(R,{onClick:()=>S(),variant:"outline",className:"border-2 border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[e.jsx(xt,{className:"h-5 w-5 mr-2"}),"Add Reminder"]})]})]})})})]}),e.jsx("div",{className:"px-6 sm:px-8 lg:px-12 pb-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"inline-flex bg-white rounded-xl p-1 shadow-lg border border-gray-200",children:["month","week","day"].map(r=>e.jsx(R,{variant:m===r?"default":"ghost",onClick:()=>d(r),size:"sm",className:`rounded-lg px-6 py-2 font-medium transition-all duration-200 ${m===r?"wendys-button shadow-md":"text-gray-600 hover:text-wendys-charcoal hover:bg-gray-100"}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:e.jsx(Le,{mode:"single",selected:x,onSelect:G,className:"rounded-xl border-0",classNames:{day_selected:"bg-wendys-red text-white hover:bg-wendys-dark-red focus:bg-wendys-dark-red",day_today:"bg-wendys-red/10 text-wendys-red font-bold",day:"h-12 w-12 text-center text-sm p-0 font-normal aria-selected:opacity-100 hover:bg-gray-100 rounded-lg transition-colors duration-200",head_cell:"text-gray-500 font-semibold text-sm uppercase tracking-wide pb-4",nav_button:"text-gray-600 hover:text-wendys-charcoal hover:bg-gray-100 rounded-lg transition-colors duration-200",nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",caption:"relative px-8 py-4 text-center text-xl font-semibold text-wendys-charcoal",caption_label:"text-xl font-semibold text-wendys-charcoal",table:"w-full border-collapse space-y-1",head_row:"flex",row:"flex w-full mt-2",cell:"h-12 w-12 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20"}})})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-wendys-red to-wendys-dark-red rounded-full mb-4",children:e.jsx(te,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-wendys-charcoal",children:k(x,"EEEE")}),e.jsx("p",{className:"text-lg text-gray-600",children:k(x,"MMMM d, yyyy")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-700 flex items-center text-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"Events (",z.length,")"]}),z.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No events scheduled"})]}):e.jsx("div",{className:"space-y-3",children:z.map(r=>e.jsx("div",{className:"group bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-blue-900 text-lg",children:r.title}),r.description&&e.jsx("p",{className:"text-sm text-blue-700 mt-2 leading-relaxed",children:r.description}),e.jsxs("div",{className:"flex items-center text-xs text-blue-600 mt-3 space-x-4",children:[e.jsxs("span",{className:"flex items-center bg-blue-200 px-2 py-1 rounded-full",children:[e.jsx(tt,{className:"h-3 w-3 mr-1"}),k(ge(r.start_date),"h:mm a")]}),r.location&&e.jsxs("span",{className:"flex items-center bg-blue-200 px-2 py-1 rounded-full",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),r.location]})]})]}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>b(r),className:"h-8 w-8 p-0 hover:bg-blue-200",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>L.mutate(r.id),className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",children:e.jsx(De,{className:"h-4 w-4"})})]})]})},r.id))})]}),e.jsxs("div",{className:"space-y-4 mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("h4",{className:"font-semibold text-gray-700 flex items-center text-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-3"}),"Reminders (",re.length,")"]}),re.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No reminders due"})]}):e.jsx("div",{className:"space-y-3",children:re.map(r=>e.jsx("div",{className:`group border rounded-xl p-4 transition-all duration-200 hover:shadow-md ${r.completed?"bg-gray-50 border-gray-200":r.priority==="high"?"bg-gradient-to-r from-red-50 to-red-100 border-red-200":r.priority==="medium"?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-200":"bg-gradient-to-r from-green-50 to-green-100 border-green-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>W.mutate({id:r.id,completed:!r.completed}),className:"flex-shrink-0",children:r.completed?e.jsx(ke,{className:"h-5 w-5 text-green-600"}):e.jsx(Ut,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 transition-colors duration-200"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[j(r.priority),e.jsx("h5",{className:`font-semibold text-lg ${r.completed?"text-gray-500 line-through":"text-gray-900"}`,children:r.title})]})]}),r.description&&e.jsx("p",{className:`text-sm mt-2 leading-relaxed ${r.completed?"text-gray-500":"text-gray-700"}`,children:r.description}),e.jsx("div",{className:"flex items-center mt-3",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r.priority==="high"?"bg-red-100 text-red-800":r.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[r.priority.charAt(0).toUpperCase()+r.priority.slice(1)," Priority"]})})]}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>S(r),className:"h-8 w-8 p-0 hover:bg-gray-200",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>P.mutate(r.id),className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",children:e.jsx(De,{className:"h-4 w-4"})})]})]})},r.id))})]})]})})]}),m==="month"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-wendys-charcoal mb-6 text-center",children:k(x,"MMMM yyyy")}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(r=>e.jsx("div",{className:"text-center text-sm font-semibold text-gray-500 py-3 px-2",children:r},r)),ne.map((r,y)=>{const T=xe(r),V=we(r),X=Ys(r),Z=Ee(r,x),We=Ks(r,x);return e.jsxs("div",{className:`min-h-[100px] p-2 border border-gray-200 cursor-pointer transition-all duration-200 rounded-lg ${We?"bg-white hover:bg-gray-50":"bg-gray-50 text-gray-400"} ${X?"bg-gradient-to-br from-wendys-red/20 to-wendys-dark-red/20 border-wendys-red/30 shadow-md":""} ${Z?"bg-blue-50 border-blue-300 shadow-md":""}`,onClick:()=>p(r),children:[e.jsx("div",{className:`text-sm font-semibold mb-2 ${X?"text-wendys-red":We?"text-gray-900":"text-gray-400"}`,children:k(r,"d")}),T.slice(0,2).map(Y=>e.jsx("div",{className:"text-xs bg-gradient-to-r from-blue-500 to-blue-600 text-white px-2 py-1 rounded-full mb-1 truncate shadow-sm",title:Y.title,children:Y.title},Y.id)),V.slice(0,2).map(Y=>e.jsx("div",{className:`text-xs px-2 py-1 rounded-full mb-1 truncate shadow-sm ${Y.completed?"bg-gray-400 text-white":Y.priority==="high"?"bg-gradient-to-r from-red-500 to-red-600 text-white":Y.priority==="medium"?"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}`,title:Y.title,children:Y.title},Y.id)),T.length+V.length>4&&e.jsxs("div",{className:"text-xs text-gray-500 text-center bg-gray-100 rounded-full py-1 mt-1",children:["+",T.length+V.length-4," more"]})]},y)})]})]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-wendys-charcoal",children:i?"Edit Event":"Add Event"}),e.jsx(R,{variant:"ghost",onClick:()=>{n(!1),g(null)},className:"h-10 w-10 p-0 rounded-full hover:bg-gray-100",children:"Ã"})]}),e.jsxs("form",{onSubmit:r=>{r.preventDefault();const y=new FormData(r.currentTarget),T={title:y.get("title"),description:y.get("description"),start_date:y.get("start_date"),end_date:y.get("end_date")||void 0,all_day:y.get("all_day")==="on",location:y.get("location"),reminder_type:y.get("reminder_type")};D.mutate(T)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"title",className:"text-sm font-semibold text-gray-700",children:"Event Title *"}),e.jsx(I,{id:"title",name:"title",defaultValue:i==null?void 0:i.title,required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter event title"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"description",className:"text-sm font-semibold text-gray-700",children:"Description"}),e.jsx(Ue,{id:"description",name:"description",defaultValue:i==null?void 0:i.description,rows:3,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter event description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"start_date",className:"text-sm font-semibold text-gray-700",children:"Start Date *"}),e.jsx(I,{id:"start_date",name:"start_date",type:"datetime-local",defaultValue:(Q=i==null?void 0:i.start_date)==null?void 0:Q.slice(0,16),required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"end_date",className:"text-sm font-semibold text-gray-700",children:"End Date"}),e.jsx(I,{id:"end_date",name:"end_date",type:"datetime-local",defaultValue:(a=i==null?void 0:i.end_date)==null?void 0:a.slice(0,16),className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"all_day",name:"all_day",type:"checkbox",defaultChecked:i==null?void 0:i.all_day,className:"rounded border-gray-300 text-wendys-red focus:ring-wendys-red/20 h-4 w-4"}),e.jsx(A,{htmlFor:"all_day",className:"text-sm font-medium text-gray-700",children:"All day event"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"location",className:"text-sm font-semibold text-gray-700",children:"Location"}),e.jsx(I,{id:"location",name:"location",defaultValue:i==null?void 0:i.location,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter location"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"reminder_type",className:"text-sm font-semibold text-gray-700",children:"Reminder"}),e.jsxs("select",{id:"reminder_type",name:"reminder_type",defaultValue:(i==null?void 0:i.reminder_type)||"none",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-wendys-red focus:ring-wendys-red/20",children:[e.jsx("option",{value:"none",children:"No reminder"}),e.jsx("option",{value:"15min",children:"15 minutes before"}),e.jsx("option",{value:"1hour",children:"1 hour before"}),e.jsx("option",{value:"1day",children:"1 day before"}),e.jsx("option",{value:"1week",children:"1 week before"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6",children:[e.jsx(R,{type:"button",variant:"outline",onClick:()=>{n(!1),g(null)},className:"border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg",children:"Cancel"}),e.jsx(R,{type:"submit",className:"wendys-button rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:i?"Update Event":"Create Event"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-wendys-charcoal",children:l?"Edit Reminder":"Add Reminder"}),e.jsx(R,{variant:"ghost",onClick:()=>{o(!1),u(null)},className:"h-10 w-10 p-0 rounded-full hover:bg-gray-100",children:"Ã"})]}),e.jsxs("form",{onSubmit:r=>{r.preventDefault();const y=new FormData(r.currentTarget),T={title:y.get("title"),description:y.get("description"),due_date:y.get("due_date"),priority:y.get("priority"),completed:!1};U.mutate(T)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"reminder_title",className:"text-sm font-semibold text-gray-700",children:"Reminder Title *"}),e.jsx(I,{id:"reminder_title",name:"title",defaultValue:l==null?void 0:l.title,required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter reminder title"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"reminder_description",className:"text-sm font-semibold text-gray-700",children:"Description"}),e.jsx(Ue,{id:"reminder_description",name:"description",defaultValue:l==null?void 0:l.description,rows:3,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter reminder description"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"reminder_due_date",className:"text-sm font-semibold text-gray-700",children:"Due Date *"}),e.jsx(I,{id:"reminder_due_date",name:"due_date",type:"datetime-local",defaultValue:(h=l==null?void 0:l.due_date)==null?void 0:h.slice(0,16),required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(A,{htmlFor:"reminder_priority",className:"text-sm font-semibold text-gray-700",children:"Priority"}),e.jsxs("select",{id:"reminder_priority",name:"priority",defaultValue:(l==null?void 0:l.priority)||"medium",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-wendys-red focus:ring-wendys-red/20",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6",children:[e.jsx(R,{type:"button",variant:"outline",onClick:()=>{o(!1),u(null)},className:"border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg",children:"Cancel"}),e.jsx(R,{type:"submit",className:"wendys-button rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:l?"Update Reminder":"Create Reminder"})]})]})]})})]})}const bt=ea,Nt=ta,Qe=_.forwardRef(({className:t,children:n,...s},o)=>e.jsxs(Kt,{ref:o,className:w("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[n,e.jsx(Bs,{asChild:!0,children:e.jsx(Ze,{className:"h-4 w-4 opacity-50"})})]}));Qe.displayName=Kt.displayName;const ds=_.forwardRef(({className:t,...n},s)=>e.jsx(Bt,{ref:s,className:w("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx($t,{className:"h-4 w-4"})}));ds.displayName=Bt.displayName;const cs=_.forwardRef(({className:t,...n},s)=>e.jsx(Qt,{ref:s,className:w("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(Ze,{className:"h-4 w-4"})}));cs.displayName=Qt.displayName;const Je=_.forwardRef(({className:t,children:n,position:s="popper",...o},i)=>e.jsx(Qs,{children:e.jsxs(Jt,{ref:i,className:w("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...o,children:[e.jsx(ds,{}),e.jsx(Js,{className:w("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(cs,{})]})}));Je.displayName=Jt.displayName;const nr=_.forwardRef(({className:t,...n},s)=>e.jsx(Xt,{ref:s,className:w("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n}));nr.displayName=Xt.displayName;const J=_.forwardRef(({className:t,children:n,...s},o)=>e.jsxs(Zt,{ref:o,className:w("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Xs,{children:e.jsx(Mt,{className:"h-4 w-4"})})}),e.jsx(Zs,{children:n})]}));J.displayName=Zt.displayName;const ir=_.forwardRef(({className:t,...n},s)=>e.jsx(es,{ref:s,className:w("-mx-1 my-1 h-px bg-muted",t),...n}));ir.displayName=es.displayName;const or=oe("/interviews")({component:lr});function lr(){const[t,n]=_.useState(null),[s,o]=_.useState(null),[i,g]=_.useState([]),[l,u]=_.useState(!1),[x,p]=_.useState(null),[m,d]=_.useState(""),[f,C]=_.useState("ALL"),[N,M]=_.useState(!1),{toast:v}=se(),[c,D]=_.useState({candidate_name:"",phone:"",email:"",position:"",interview_date:"",interview_time:"",status:"SCHEDULED",notes:""});_.useEffect(()=>{(async()=>{try{const{data:{user:S}}=await E.auth.getUser();if(!S)return;o(S.id);const{data:j}=await E.from("users").select("store_id").eq("id",S.id).single();j!=null&&j.store_id&&(n(j.store_id),U(j.store_id))}catch(S){console.error("Error getting store ID:",S)}})()},[]);const U=async b=>{try{M(!0);const{data:S,error:j}=await E.from("interviews").select("*").eq("store_id",b).order("interview_date",{ascending:!0}).order("interview_time",{ascending:!0});if(j)throw j;g(S||[])}catch(S){console.error("Error fetching interviews:",S),v({title:"Error",description:"Failed to fetch interviews",variant:"destructive"})}finally{M(!1)}},L=(b,S)=>{D(j=>({...j,[b]:S}))},P=()=>{D({candidate_name:"",phone:"",email:"",position:"",interview_date:"",interview_time:"",status:"SCHEDULED",notes:""}),p(null)},W=async b=>{if(!s)return null;try{const{data:S,error:j}=await E.from("calendar_events").select("id").eq("created_by",s).ilike("title","Interview: %").ilike("description",`%interviewId: ${b}%`).single();return j&&j.code!=="PGRST116"?(console.error("Error finding calendar event:",j),null):S}catch(S){return console.error("Error in findCalendarEvent:",S),null}},z=async(b,S=!1)=>{if(!s){console.warn("No user ID available for calendar event creation");return}try{if(!b.interview_date||!b.interview_time){console.warn("Invalid date or time for calendar event:",{date:b.interview_date,time:b.interview_time});return}const j=b.interview_time.includes(":")&&b.interview_time.split(":").length===2?`${b.interview_time}:00`:b.interview_time,Q=`${b.interview_date}T${j}`,a=new Date(Q);if(isNaN(a.getTime()))throw console.error("Invalid start date created:",Q,"from:",{date:b.interview_date,time:b.interview_time,formattedTime:j}),new Error("Invalid interview date/time format");const h=new Date(a.getTime()+60*60*1e3);if(isNaN(h.getTime()))throw console.error("Invalid end date calculated from start date:",a),new Error("Invalid end date calculation");const r=h.toISOString(),y={title:`Interview: ${b.candidate_name}`,description:`Interview for ${b.position||"position"}
${b.notes||""}
Phone: ${b.phone||"N/A"}
Email: ${b.email||"N/A"}
interviewId: ${b.id}`,start_date:Q,end_date:r,all_day:!1,location:"Store Interview Room",reminder_type:"15min",updated_at:new Date().toISOString()};if(S){const T=await W(b.id);if(T){const{error:V}=await E.from("calendar_events").update(y).eq("id",T.id);V?console.error("Error updating calendar event:",V):console.log("Calendar event updated successfully for interview:",b.id)}else{const{error:V}=await E.from("calendar_events").insert([{...y,created_by:s}]);V?console.error("Error creating calendar event:",V):console.log("Calendar event created successfully for interview:",b.id)}}else{const{error:T}=await E.from("calendar_events").insert([{...y,created_by:s}]);T?(console.error("Error creating calendar event:",T),v({title:"Warning",description:"Interview scheduled but calendar event creation failed.",variant:"destructive"})):console.log("Calendar event created successfully for interview:",b.id)}}catch(j){throw console.error("Error in createOrUpdateCalendarEvent:",j),j}},re=async()=>{if(!s){v({title:"Error",description:"User not authenticated",variant:"destructive"});return}if(!t){v({title:"Error",description:"No store selected",variant:"destructive"});return}if(!c.candidate_name.trim()){v({title:"Error",description:"Candidate name is required",variant:"destructive"});return}if(!c.interview_date){v({title:"Error",description:"Interview date is required",variant:"destructive"});return}if(!c.interview_time){v({title:"Error",description:"Interview time is required",variant:"destructive"});return}console.log("Saving interview with data:",c),console.log("Interview date format:",typeof c.interview_date,c.interview_date),console.log("Interview time format:",typeof c.interview_time,c.interview_time);const b=c.interview_time.includes(":")&&c.interview_time.split(":").length===2?`${c.interview_time}:00`:c.interview_time;console.log("Formatted time for database:",b);try{if(x){const{data:S,error:j}=await E.from("interviews").update({candidate_name:c.candidate_name,phone:c.phone||null,email:c.email||null,position:c.position||null,interview_date:c.interview_date,interview_time:b,status:c.status,notes:c.notes||null}).eq("id",x.id).select().single();if(j)throw j;if(S)try{await z(S,!0)}catch(Q){console.warn("Calendar event update failed, but interview was saved:",Q)}v({title:"Success!",description:"Interview updated and calendar synced!"})}else{const{data:S,error:j}=await E.from("interviews").insert([{store_id:t,candidate_name:c.candidate_name,phone:c.phone||null,email:c.email||null,position:c.position||null,interview_date:c.interview_date,interview_time:b,status:c.status,notes:c.notes||null}]).select().single();if(j)throw j;if(S)try{await z(S,!1)}catch(Q){console.warn("Calendar event creation failed, but interview was saved:",Q)}v({title:"Success!",description:"Interview scheduled and added to calendar!"})}U(t),u(!1),P()}catch(S){console.error("Error saving interview:",S),console.error("Error details:",S.details),console.error("Error hint:",S.hint);let j="Failed to save interview";S.message?j=S.message:S.details?j=`Database error: ${S.details}`:S.hint&&(j=`Hint: ${S.hint}`),v({title:"Error",description:j,variant:"destructive"})}},ne=b=>{p(b),D({candidate_name:b.candidate_name,phone:b.phone||"",email:b.email||"",position:b.position||"",interview_date:b.interview_date,interview_time:b.interview_time,status:b.status,notes:b.notes||""}),u(!0)},xe=async b=>{if(confirm("Are you sure you want to delete this interview?"))try{const{error:S}=await E.from("interviews").delete().eq("id",b);if(S)throw S;v({title:"Deleted!",description:"Interview removed successfully."}),U(t)}catch(S){console.error("Error deleting interview:",S),v({title:"Error",description:S.message||"Failed to delete interview",variant:"destructive"})}},G=i.filter(b=>{const S=b.candidate_name.toLowerCase().includes(m.toLowerCase())||(b.position||"").toLowerCase().includes(m.toLowerCase()),j=f==="ALL"||b.status===f;return S&&j}).reduce((b,S)=>{const j=S.interview_date;return b[j]||(b[j]=[]),b[j].push(S),b},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Interviews & New Hires"}),e.jsx("p",{className:"text-gray-600",children:"Manage candidate interviews and track the hiring process"})]}),e.jsxs(R,{onClick:()=>u(!0),className:"wendys-button",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Schedule Interview"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(I,{placeholder:"Search by name or position...",value:m,onChange:b=>d(b.target.value),className:"pl-10"})]})}),e.jsxs(bt,{value:f,onValueChange:C,children:[e.jsx(Qe,{className:"w-full sm:w-48",children:e.jsx(Nt,{placeholder:"Filter by status"})}),e.jsxs(Je,{children:[e.jsx(J,{value:"ALL",children:"All Statuses"}),e.jsx(J,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(J,{value:"COMPLETED",children:"Completed"}),e.jsx(J,{value:"NO_SHOW",children:"No Show"}),e.jsx(J,{value:"HIRED",children:"Hired"}),e.jsx(J,{value:"REJECTED",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[N&&e.jsx("div",{className:"text-center text-gray-500",children:"Loading interviews..."}),!N&&Object.keys(G).length===0&&e.jsx("div",{className:"text-center text-gray-500",children:"No interviews found."}),Object.entries(G).map(([b,S])=>e.jsxs("div",{className:"wendys-card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4 flex items-center",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),Se(b)]}),e.jsx("div",{className:"space-y-3",children:S.map(j=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-wendys-charcoal",children:j.candidate_name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ts(j.status)}`,children:j.status.replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx("span",{children:j.position||"No position specified"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:ma(j.interview_time)})]}),j.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:j.phone})]}),j.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{children:j.email})]})]}),j.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx(aa,{className:"h-4 w-4 inline mr-1"}),j.notes]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>ne(j),children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>xe(j.id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})]})},j.id))})]},b))]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-wendys-charcoal",children:x?"Edit Interview":"Schedule New Interview"}),e.jsx(R,{variant:"ghost",onClick:()=>{u(!1),P()},className:"h-8 w-8 p-0",children:"Ã"})]}),e.jsxs("form",{onSubmit:b=>{b.preventDefault(),re()},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"candidate_name",children:"Candidate Name *"}),e.jsx(I,{id:"candidate_name",value:c.candidate_name,onChange:b=>L("candidate_name",b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"position",children:"Position"}),e.jsx(I,{id:"position",value:c.position,onChange:b=>L("position",b.target.value),placeholder:"e.g., Crew Member, Manager"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"phone",children:"Phone"}),e.jsx(I,{id:"phone",type:"tel",value:c.phone,onChange:b=>L("phone",b.target.value),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"email",children:"Email"}),e.jsx(I,{id:"email",type:"email",value:c.email,onChange:b=>L("email",b.target.value),placeholder:"candidate@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"interview_date",children:"Interview Date *"}),e.jsx(I,{id:"interview_date",type:"date",value:c.interview_date,onChange:b=>L("interview_date",b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"interview_time",children:"Interview Time *"}),e.jsx(I,{id:"interview_time",type:"time",value:c.interview_time,onChange:b=>L("interview_time",b.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"status",children:"Status *"}),e.jsxs(bt,{value:c.status,onValueChange:b=>L("status",b),children:[e.jsx(Qe,{id:"status",children:e.jsx(Nt,{})}),e.jsxs(Je,{children:[e.jsx(J,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(J,{value:"COMPLETED",children:"Completed"}),e.jsx(J,{value:"NO_SHOW",children:"No Show"}),e.jsx(J,{value:"HIRED",children:"Hired"}),e.jsx(J,{value:"REJECTED",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"notes",children:"Notes"}),e.jsx(Ue,{id:"notes",value:c.notes,onChange:b=>L("notes",b.target.value),placeholder:"Additional notes about the candidate...",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(R,{type:"button",variant:"outline",onClick:()=>{u(!1),P()},children:"Cancel"}),e.jsx(R,{type:"submit",className:"wendys-button",children:x?"Update Interview":"Schedule Interview"})]})]})]})})]})}const dr=ue({sales_target:$.number().min(0),labor_target_pct:$.number().min(0),waste_target_pct:$.number().min(0),food_variance_target_pct:$.number().min(0),team_notes:q().optional()});function cr(){const{toast:t}=se(),n=Pe(),[s,o]=_.useState(null),i=nt("goals","wtd"),g=i.getDateRangeFilter(),l=(g==null?void 0:g.start)||k(new Date,"yyyy-MM-dd"),u=(g==null?void 0:g.end)||k(new Date,"yyyy-MM-dd"),x=i.selectedRange==="mtd"?"month":i.selectedRange==="wtd"?"week":"custom",p=Fe({resolver:Ve(dr),defaultValues:{sales_target:0,labor_target_pct:25,waste_target_pct:.5,food_variance_target_pct:.5,team_notes:""}});_.useEffect(()=>{let v=!0;return(async()=>{var P;const{data:c}=await E.auth.getUser(),D=(P=c.user)==null?void 0:P.id;if(!D)return;const{data:U,error:L}=await E.from("users").select("store_id").eq("id",D).maybeSingle();v&&(L||o((U==null?void 0:U.store_id)??null))})(),()=>{v=!1}},[]);const{data:m}=B({queryKey:["goals_settings",s,l,u],queryFn:async()=>{if(!s)return null;try{const{data:v,error:c}=await E.from("goals").select("*").eq("store_id",s).eq("period_start",l).eq("period_end",u).maybeSingle();if(c&&c.code!=="PGRST116"){const D=String(c.code||""),U=String(c.message||"");if(D.startsWith("42")||U.toLowerCase().includes("relation")||U.toLowerCase().includes("does not exist"))return console.warn("[Goals] Goals table not available; returning null"),null;throw c}return v||null}catch(v){const c=String((v==null?void 0:v.code)||""),D=String((v==null?void 0:v.message)||"");if(c.startsWith("42")||D.toLowerCase().includes("relation")||D.toLowerCase().includes("does not exist"))return console.warn("[Goals] Goals table not available; returning null"),null;throw v}},enabled:!!s});_.useEffect(()=>{m&&p.reset({sales_target:m.sales_target,labor_target_pct:m.labor_target_pct,waste_target_pct:m.waste_target_pct,food_variance_target_pct:m.food_variance_target_pct,team_notes:m.team_notes||""})},[m]);const{data:d=[]}=B({queryKey:["omega_daily_for_goals",s,l,u],queryFn:async()=>{if(!s)return[];const{data:v,error:c}=await E.from("omega_daily").select("*").eq("store_id",s).gte("business_date",l).lte("business_date",u).order("business_date",{ascending:!0});if(c)throw c;return v},enabled:!!s}),f=_.useMemo(()=>{const v=d.reduce((W,z)=>W+(Number(z.net_sales)||0),0),c=d.length>0?d.reduce((W,z)=>W+(Number(z.labor_percentage)||0),0)/d.length:0,D=d.reduce((W,z)=>W+(Number(z.waste_amount)||0),0),U=d.reduce((W,z)=>W+(Number(z.food_variance_cost)||0),0),L=v>0?D/v*100:0,P=v>0?U/v*100:0;return{totalSales:v,avgLaborPct:c,wastePct:L,foodVarPct:P}},[d]),C=ee({mutationFn:async v=>{if(!s)throw new Error("No store is linked to your account. See Setup to link one.");const c={store_id:s,scope:x,period_start:l,period_end:u,sales_target:v.sales_target,labor_target_pct:v.labor_target_pct,waste_target_pct:v.waste_target_pct,food_variance_target_pct:v.food_variance_target_pct,team_notes:v.team_notes||null},{error:D}=await E.from("goals").upsert(c,{onConflict:"store_id,period_start,period_end"});if(D){const U=String(D.code||""),L=String(D.message||"");throw U.startsWith("42")||L.toLowerCase().includes("relation")||L.toLowerCase().includes("does not exist")?new Error("Goals table is not installed in this Supabase project. Open Setup and run the SQL to create it, then try again."):D}},onSuccess:()=>{t({title:"Saved",description:"Goals saved for selected period."}),n.invalidateQueries({queryKey:["goals_settings",s,l,u]})},onError:v=>{t({title:"Save failed",description:v.message,variant:"destructive"})}}),N=()=>{p.reset({sales_target:0,labor_target_pct:25,waste_target_pct:.5,food_variance_target_pct:.5,team_notes:""})},M=(v,c)=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${v?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Goal Setting"}),e.jsx("p",{className:"text-gray-600",children:"Set targets and track progress against Omega Daily actuals"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{variant:"outline",onClick:N,children:"Reset Goals"}),e.jsx(R,{className:"wendys-button",onClick:p.handleSubmit(v=>C.mutate(v)),disabled:!s||C.isPending,children:"Save Goals"})]})]}),e.jsx(rt,{selectedRange:i.selectedRange,selectedDate:i.selectedDate,onRangeChange:i.handleRangeChange,onDateChange:i.handleDateChange,onClearFilters:i.clearFilters}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"wendys-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-3",children:"Sales"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Target"}),e.jsx(I,{type:"number",step:"0.01",...p.register("sales_target")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Actual"}),e.jsxs("p",{className:"text-xl font-semibold",children:["$",f.totalSales.toLocaleString()]})]})]}),e.jsx("div",{children:M(f.totalSales>=(p.watch("sales_target")||0),f.totalSales>=(p.watch("sales_target")||0)?"On Track":"Behind")})]})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-3",children:"Labor"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Target %"}),e.jsx(I,{type:"number",step:"0.1",...p.register("labor_target_pct")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Actual %"}),e.jsxs("p",{className:"text-xl font-semibold",children:[f.avgLaborPct.toFixed(1),"%"]})]})]}),e.jsx("div",{children:M(f.avgLaborPct<=(p.watch("labor_target_pct")||0),f.avgLaborPct<=(p.watch("labor_target_pct")||0)?"On Track":"High")})]})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-3",children:"Waste & Food"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Waste Target %"}),e.jsx(I,{type:"number",step:"0.1",...p.register("waste_target_pct")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Waste Actual %"}),e.jsxs("p",{className:"text-xl font-semibold",children:[f.wastePct.toFixed(2),"%"]})]})]}),e.jsx("div",{children:M(f.wastePct<=(p.watch("waste_target_pct")||0),f.wastePct<=(p.watch("waste_target_pct")||0)?"On Track":"High")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Food Var Target %"}),e.jsx(I,{type:"number",step:"0.1",...p.register("food_variance_target_pct")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Food Var Actual %"}),e.jsxs("p",{className:"text-xl font-semibold",children:[f.foodVarPct.toFixed(2),"%"]})]})]}),e.jsx("div",{children:M(f.foodVarPct<=(p.watch("food_variance_target_pct")||0),f.foodVarPct<=(p.watch("food_variance_target_pct")||0)?"On Track":"High")})]})]}),e.jsxs("div",{className:"wendys-card md:col-span-2 xl:col-span-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-3",children:"Team & Personal"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"team_notes",children:"Notes"}),e.jsx(I,{id:"team_notes",...p.register("team_notes"),placeholder:"Notes, personal goals, shout-outs..."})]})})]})]})]})}const mr=oe("/goals")({component:cr}),ur=oe("/")({beforeLoad:()=>{throw ra({to:"/overview"})}}),xr=Wa.update({id:"/smg",path:"/smg",getParentRoute:()=>ae}),hr=za.update({id:"/setup",path:"/setup",getParentRoute:()=>ae}),gr=Ja.update({id:"/overview",path:"/overview",getParentRoute:()=>ae}),yr=tr.update({id:"/omega-daily",path:"/omega-daily",getParentRoute:()=>ae}),pr=ar.update({id:"/calendar",path:"/calendar",getParentRoute:()=>ae}),fr=or.update({id:"/interviews",path:"/interviews",getParentRoute:()=>ae}),_r=mr.update({id:"/goals",path:"/goals",getParentRoute:()=>ae}),br=ur.update({id:"/",path:"/",getParentRoute:()=>ae}),Nr={IndexRoute:br,CalendarRoute:pr,GoalsRoute:_r,InterviewsRoute:fr,OmegaDailyRoute:yr,OverviewRoute:gr,SetupRoute:hr,SmgRoute:xr},vr=ae._addFileChildren(Nr)._addFileTypes(),ms=new na({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}}),jr=ia({routeTree:vr,context:{queryClient:ms},defaultPreload:"intent"});oa.createRoot(document.getElementById("root")).render(e.jsx(le.StrictMode,{children:e.jsxs(la,{client:ms,children:[e.jsx(da,{router:jr}),e.jsx(ba,{}),e.jsx(ca,{initialIsOpen:!1})]})}));

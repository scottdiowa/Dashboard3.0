import{t as Gt,c as Qt,f as H,p as We,r as p,j as e,V as Js,R as Xs,a as Fs,A as Zs,C as et,X as He,T as st,D as tt,P as Jt,b as Xt,S as Zt,u as ea,B as As,d as ce,F as Ue,e as Ne,U as at,g as fs,M as sa,h as ps,i as ts,W as ta,k as Ze,l as Ns,m as rt,L as Ls,n as Pe,o as nt,q as it,s as aa,v as lt,I as ot,w as dt,x as ct,y as mt,z as ut,E as xt,G as ht,H as gt,J as ra,K as na,N as ia,O as ft,Q as la,Y as De,Z as J,_ as Z,$ as ls,a0 as pt,a1 as oa,a2 as da,a3 as yt,a4 as Be,a5 as Ye,a6 as vt,a7 as Ae,a8 as $e,a9 as ke,aa as ca,ab as ma,ac as ua,ad as xa,ae as ha,af as bt,ag as ga,ah as fa,ai as we,aj as qe,ak as me,al as ne,am as Te,an as _t,ao as Fe,ap as Ee,aq as pa,ar as Nt,as as ya,at as Oe,au as va,av as Ce,aw as ze,ax as Re,ay as ba,az as _e,aA as wt,aB as Le,aC as Ie,aD as Me,aE as Ve,aF as jt,aG as Is,aH as Ps,aI as Et,aJ as St,aK as _a,aL as kt,aM as Ct,aN as Na,aO as Tt,aP as wa,aQ as Rt,aR as Dt,aS as ja,aT as Ea,aU as At,aV as Sa,aW as ka,aX as ys,aY as Lt,aZ as vs,a_ as Ca,a$ as zs,b0 as qs,b1 as It,b2 as Mt,b3 as es,b4 as je,b5 as Os,b6 as Ke,b7 as os,b8 as Ta,b9 as Ra,ba as Da,bb as Cs,bc as ds,bd as Xe,be as Aa,bf as La,bg as Ia,bh as Ws,bi as Ma,bj as Va,bk as Fa,bl as Oa,bm as Ua,bn as Pa,bo as za,bp as qa,bq as Wa}from"./vendor-Bk6OlFXv.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const h of r)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const h={};return r.integrity&&(h.integrity=r.integrity),r.referrerPolicy&&(h.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?h.credentials="include":r.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function c(r){if(r.ep)return;r.ep=!0;const h=t(r);fetch(r.href,h)}})();function P(...s){return Gt(Qt(s))}function pe(s){return s==null||isNaN(s)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)}function de(s,a=1){return s==null||isNaN(s)?"0%":`${s.toFixed(a)}%`}function he(s){const a=typeof s=="string"?new Date(Number(s.slice(0,4)),Number(s.slice(5,7))-1,Number(s.slice(8,10))):s;return H(a,"MMM dd, yyyy")}function $a(s){return H(We(`2000-01-01T${s}`),"h:mm a")}function Vt(s){switch(s.toLowerCase()){case"scheduled":return"bg-blue-100 text-blue-800";case"done":return"bg-green-100 text-green-800";case"no_show":return"bg-red-100 text-red-800";case"hired":return"bg-purple-100 text-purple-800";case"rejected":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}const Ha=Jt,Ft=p.forwardRef(({className:s,...a},t)=>e.jsx(Js,{ref:t,className:P("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));Ft.displayName=Js.displayName;const Ka=Fs("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ot=p.forwardRef(({className:s,variant:a,...t},c)=>e.jsx(Xs,{ref:c,className:P(Ka({variant:a}),s),...t}));Ot.displayName=Xs.displayName;const Ba=p.forwardRef(({className:s,...a},t)=>e.jsx(Zs,{ref:t,className:P("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));Ba.displayName=Zs.displayName;const Ut=p.forwardRef(({className:s,...a},t)=>e.jsx(et,{ref:t,className:P("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(He,{className:"h-4 w-4"})}));Ut.displayName=et.displayName;const Pt=p.forwardRef(({className:s,...a},t)=>e.jsx(st,{ref:t,className:P("text-sm font-semibold",s),...a}));Pt.displayName=st.displayName;const zt=p.forwardRef(({className:s,...a},t)=>e.jsx(tt,{ref:t,className:P("text-sm opacity-90",s),...a}));zt.displayName=tt.displayName;const Ya=1,Ga=1e6;let Ts=0;function Qa(){return Ts=(Ts+1)%Number.MAX_SAFE_INTEGER,Ts.toString()}const Rs=new Map,$s=s=>{if(Rs.has(s))return;const a=setTimeout(()=>{Rs.delete(s),ss({type:"REMOVE_TOAST",toastId:s})},Ga);Rs.set(s,a)},Ja=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Ya)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?$s(t):s.toasts.forEach(c=>{$s(c.id)}),{...s,toasts:s.toasts.map(c=>c.id===t||t===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},hs=[];let gs={toasts:[]};function ss(s){gs=Ja(gs,s),hs.forEach(a=>{a(gs)})}function Xa({...s}){const a=Qa(),t=r=>ss({type:"UPDATE_TOAST",toast:{...r,id:a}}),c=()=>ss({type:"DISMISS_TOAST",toastId:a});return ss({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:r=>{r||c()}}}),{id:a,dismiss:c,update:t}}function ge(){const[s,a]=p.useState(gs);return p.useEffect(()=>(hs.push(a),()=>{const t=hs.indexOf(a);t>-1&&hs.splice(t,1)}),[s]),{...s,toast:Xa,dismiss:t=>ss({type:"DISMISS_TOAST",toastId:t})}}function Za(){const{toasts:s}=ge();return e.jsxs(Ha,{children:[s.map(function({id:a,title:t,description:c,action:r,...h}){return e.jsxs(Ot,{...h,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(Pt,{children:t}),c&&e.jsx(zt,{children:c})]}),r,e.jsx(Ut,{})]},a)}),e.jsx(Ft,{})]})}const er="https://qewndmyixpzmtgjjihoj.supabase.co",sr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFld25kbXlpeHB6bXRnamppaG9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNjI0MDEsImV4cCI6MjA3MTYzODQwMX0.qGJGQ0U-0JjuFCn1deB5aOEA52y_uA9weCvZah3N6kI",V=Xt(er,sr,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),$=p.forwardRef(({className:s,type:a,...t},c)=>e.jsx("input",{type:a,className:P("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:c,...t}));$.displayName="Input";const Ms=Fs("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),I=p.forwardRef(({className:s,variant:a,size:t,asChild:c=!1,...r},h)=>{const d=c?Zt:"button";return e.jsx(d,{className:P(Ms({variant:a,size:t,className:s})),ref:h,...r})});I.displayName="Button";const Ds=[{id:"dashboard",name:"Dashboard & Analytics",icon:As,items:[{name:"Overview",href:"/overview",icon:As,description:"Key metrics and trends",priority:"high"},{name:"Omega Daily",href:"/omega-daily",icon:ce,description:"Daily business metrics",priority:"high"},{name:"Weekending Sheet",href:"/weekending-sheet",icon:Ue,description:"Weekly operational data",priority:"high"}]},{id:"operations",name:"Operations",icon:Ne,items:[{name:"Calendar",href:"/calendar",icon:Ne,description:"Events and reminders",priority:"medium"},{name:"Interviews & Hires",href:"/interviews",icon:at,description:"Manage candidates and hiring",priority:"medium"},{name:"Soft Inventory",href:"/soft-inventory",icon:fs,description:"Track variance percentages",priority:"medium"}]},{id:"performance",name:"Performance & Goals",icon:ps,items:[{name:"OSAT",href:"/smg",icon:sa,description:"Customer feedback metrics",priority:"medium"},{name:"Goal Setting",href:"/goals",icon:ps,description:"Set goals & track progress",priority:"medium"}]},{id:"system",name:"System",icon:ts,items:[{name:"Settings",href:"/settings",icon:ts,description:"Configure dashboard preferences",priority:"low"},{name:"Setup",href:"/setup",icon:ta,description:"Copy SQL & configure",priority:"low"}]}],qt=p.forwardRef(({open:s,isMobile:a,onClose:t},c)=>{const r=ea(),[h,d]=p.useState(""),[N,g]=p.useState(null),[L,x]=p.useState(new Set(["dashboard","operations"])),n=p.useMemo(()=>Ds.flatMap(D=>D.items.map(u=>({...u,categoryId:D.id,categoryName:D.name}))),[]),f=p.useMemo(()=>{if(!h.trim())return n;const D=h.toLowerCase();return n.filter(u=>u.name.toLowerCase().includes(D)||u.description.toLowerCase().includes(D)||u.categoryName.toLowerCase().includes(D))},[h,n]),M=()=>{a&&t()},E=D=>{x(u=>{const y=new Set(u);return y.has(D)?y.delete(D):y.add(D),y})},q=(D,u=!1)=>{const y=r.pathname===D.href,w=D.icon;return e.jsxs("div",{className:"relative",children:[e.jsxs(Ls,{to:D.href,className:P("flex items-center transition-all duration-200 group relative",s?"space-x-3 p-3 rounded-lg mx-0":"justify-center p-3 rounded-lg mx-1",y?"bg-gradient-to-r from-wendys-red to-wendys-dark-red text-white shadow-lg ring-1 ring-red-200":"text-gray-700 hover:bg-white hover:shadow-sm hover:ring-1 hover:ring-gray-200",u&&s&&"ml-4"),onMouseEnter:()=>!s&&g(D.href),onMouseLeave:()=>!s&&g(null),onClick:M,children:[e.jsx("div",{className:P("flex-shrink-0 p-2 rounded-lg transition-all duration-200",y?"bg-white/20":"bg-gray-100 group-hover:bg-wendys-red/10 group-hover:scale-110"),children:e.jsx(w,{className:P("h-5 w-5 transition-colors duration-200",y?"text-white":"text-gray-600 group-hover:text-wendys-red")})}),s&&e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:P("font-semibold text-sm",y?"text-white":"text-gray-800"),children:D.name}),D.priority==="high"&&e.jsx(Pe,{className:"h-3 w-3 text-yellow-500 fill-current"})]}),e.jsx("div",{className:P("text-xs mt-1",y?"text-red-100":"text-gray-500"),children:D.description})]})]}),!s&&N===D.href&&e.jsx("div",{className:"absolute left-full ml-2 top-1/2 transform -translate-y-1/2 z-50",children:e.jsxs("div",{className:"bg-gray-900 text-white text-sm px-3 py-2 rounded-lg shadow-lg whitespace-nowrap",children:[e.jsx("div",{className:"font-medium",children:D.name}),e.jsx("div",{className:"text-gray-300 text-xs mt-1",children:D.description}),e.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]})})]},D.href)};return a?e.jsx("div",{ref:c,className:P("fixed top-0 left-0 w-80 h-full bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-in-out",s?"translate-x-0":"-translate-x-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-wendys-red rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"W"})}),e.jsx("h2",{className:"font-semibold text-wendys-charcoal",children:"Navigation"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"tap","aria-label":"Close navigation",children:"Ã—"})]}),e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{placeholder:"Search navigation...",value:h,onChange:D=>d(D.target.value),className:"pl-10 bg-gray-50 border-gray-200 focus:border-wendys-red focus:ring-wendys-red/20"})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto p-4",children:[h.trim()?e.jsx("div",{className:"space-y-2",children:f.map(D=>q(D,!0))}):e.jsx("div",{className:"space-y-4",children:Ds.map(D=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-500 text-xs font-medium uppercase tracking-wider",children:[e.jsx(D.icon,{className:"h-4 w-4"}),e.jsx("span",{children:D.name})]}),e.jsx("div",{className:"space-y-1",children:D.items.map(u=>q(u))})]},D.id))}),h.trim()&&f.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ze,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No navigation items found"}),e.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-wendys-red rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"W"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Dashboard v3.0"})]})})]})}):e.jsx("div",{className:P("bg-gradient-to-b from-white to-gray-50 shadow-2xl border-r border-gray-200 transition-[width] duration-300 ease-in-out shrink-0 overflow-hidden",s?"w-64":"w-16"),children:e.jsxs("div",{className:"flex flex-col h-full relative",children:[s&&e.jsx("div",{className:"p-4 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{placeholder:"Search navigation...",value:h,onChange:D=>d(D.target.value),className:"pl-10 h-9 bg-gray-50 border-gray-200 focus:border-wendys-red focus:ring-wendys-red/20"})]})}),e.jsxs("nav",{className:P("overflow-y-auto flex-1",s?"p-4":"p-2"),children:[h.trim()?e.jsx("div",{className:"space-y-1",children:f.map(D=>q(D,!0))}):e.jsx("div",{className:"space-y-4",children:Ds.map(D=>{const u=L.has(D.id);return e.jsxs("div",{className:"space-y-2",children:[s&&e.jsxs("button",{onClick:()=>E(D.id),className:"flex items-center space-x-2 text-gray-500 text-xs font-medium uppercase tracking-wider hover:text-gray-700 transition-colors w-full text-left",children:[e.jsx(D.icon,{className:"h-4 w-4"}),e.jsx("span",{className:"flex-1",children:D.name}),u?e.jsx(Ns,{className:"h-3 w-3"}):e.jsx(rt,{className:"h-3 w-3"})]}),u&&e.jsx("div",{className:"space-y-1",children:D.items.map(y=>q(y))})]},D.id)})}),h.trim()&&f.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ze,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No navigation items found"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Try a different search term"})]})]}),s&&e.jsx("div",{className:"p-4 border-t border-gray-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-wendys-red rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"W"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Dashboard v3.0"})]})})]})})});qt.displayName="RightNavDrawer";const tr=ra,ar=na,rr=p.forwardRef(({className:s,inset:a,children:t,...c},r)=>e.jsxs(nt,{ref:r,className:P("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s),...c,children:[t,e.jsx(rt,{className:"ml-auto h-4 w-4"})]}));rr.displayName=nt.displayName;const nr=p.forwardRef(({className:s,...a},t)=>e.jsx(it,{ref:t,className:P("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));nr.displayName=it.displayName;const Wt=p.forwardRef(({className:s,sideOffset:a=4,...t},c)=>e.jsx(aa,{children:e.jsx(lt,{ref:c,sideOffset:a,className:P("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));Wt.displayName=lt.displayName;const $t=p.forwardRef(({className:s,inset:a,...t},c)=>e.jsx(ot,{ref:c,className:P("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...t}));$t.displayName=ot.displayName;const ir=p.forwardRef(({className:s,children:a,checked:t,...c},r)=>e.jsxs(dt,{ref:r,className:P("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ct,{children:e.jsx(mt,{className:"h-4 w-4"})})}),a]}));ir.displayName=dt.displayName;const lr=p.forwardRef(({className:s,children:a,...t},c)=>e.jsxs(ut,{ref:c,className:P("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ct,{children:e.jsx(xt,{className:"h-2 w-2 fill-current"})})}),a]}));lr.displayName=ut.displayName;const or=p.forwardRef(({className:s,inset:a,...t},c)=>e.jsx(ht,{ref:c,className:P("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));or.displayName=ht.displayName;const dr=p.forwardRef(({className:s,...a},t)=>e.jsx(gt,{ref:t,className:P("-mx-1 my-1 h-px bg-muted",s),...a}));dr.displayName=gt.displayName;function cr({user:s,onNavToggle:a,navOpen:t}){const{toast:c}=ge(),r=async()=>{try{await V.auth.signOut(),c({title:"Signed out",description:"You have been successfully signed out."})}catch(h){console.error("Error signing out:",h),c({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30",children:e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:a,className:"tap p-2 hover:bg-gray-100","aria-label":t?"Close navigation":"Open navigation",children:e.jsx(ia,{className:"h-5 w-5 text-wendys-charcoal"})}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-wendys-red rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm sm:text-xl",children:"W"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg sm:text-xl font-bold text-wendys-charcoal",children:[e.jsx("span",{className:"hidden sm:inline",children:"SE 14th GM Dashboard"}),e.jsx("span",{className:"sm:hidden",children:"Dashboard"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 hide-on-mobile",children:H(new Date,"EEEE, MMMM d, yyyy")})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2 sm:space-x-4",children:e.jsxs(tr,{children:[e.jsx(ar,{asChild:!0,children:e.jsxs(I,{variant:"ghost",className:"flex items-center space-x-1 sm:space-x-2 tap",children:[e.jsx(ft,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:s.email})]})}),e.jsx(Wt,{align:"end",children:e.jsxs($t,{onClick:r,children:[e.jsx(la,{className:"mr-2 h-4 w-4"}),"Sign out"]})})]})})]})})}const mr=De({business_date:Z().min(1,"Business date is required"),net_sales:J.number().min(0,"Net sales must be positive"),last_year_sales:J.number().min(0,"Last year sales must be positive"),labor_hours:J.number().min(0,"Labor hours must be positive"),ideal_labor_hours:J.number().min(0,"Ideal labor hours must be positive"),labor_percentage:J.number().min(0,"Labor percentage must be positive"),theoretical_food_cost:J.number().min(0,"Theoretical food cost must be positive"),food_variance_cost:J.number(),waste_amount:J.number().min(0,"Waste amount must be positive"),breakfast_sales:J.number().min(0,"Breakfast sales must be positive"),night_sales:J.number().min(0,"Night sales must be positive")}),ur=De({date:Z().min(1,"Date is required"),accuracy_decimal:ls().min(0,"Accuracy must be 0 or greater"),zod_per_10k:ls().min(0,"ZOD per 10k must be 0 or greater"),cc_complaints:ls().min(0,"CC Complaints must be 0 or greater"),osat_decimal:ls().min(0,"OSAT Score must be 0 or greater"),notes:Z().optional()});De({candidate_name:Z().min(1,"Candidate name is required"),phone:Z().optional(),email:Z().email("Invalid email format").optional().or(oa("")),position:Z().optional(),interview_date:Z().min(1,"Interview date is required"),interview_time:Z().min(1,"Interview time is required"),status:pt(["SCHEDULED","COMPLETED","NO_SHOW","HIRED","REJECTED"]),notes:Z().optional()});De({entry_date:Z().min(1,"Entry date is required"),accuracy_of_order:J.number().min(0).max(5).optional(),zone_of_defection:J.number().min(0).max(5).optional(),customer_computers:J.number().min(0).max(5).optional(),taste_of_food:J.number().min(0).max(5).optional(),osat:J.number().min(0).max(5).optional()});De({documents_received:da().default(!1),documents_folder:Z().optional(),onboarding_sent_date:Z().optional(),onboarding_completed_date:Z().optional(),manager_reviewed_date:Z().optional(),entered_in_system_date:Z().optional(),fingerprint_scheduled_date:Z().optional(),first_day:Z().optional(),notes:Z().optional()});const xr=De({email:Z().email("Invalid email format"),password:Z().min(6,"Password must be at least 6 characters")}),hr=De({week_ending_date:Z().min(1,"Week ending date is required"),manager_name:pt(["Scott","Sophear","Letoya","Carissa"],{required_error:"Please select a manager"}),breakfast_sales:J.number().min(0,"Breakfast sales must be positive"),late_night_sales:J.number().min(0,"Late night sales must be positive"),net_sales:J.number().min(0,"Net sales must be positive"),discounts:J.number().default(0),cash:J.number().default(0),food_cost:J.number().default(0),variance_dollars:J.number().default(0),food_variance_percentage:J.number().default(0),labor:J.number().min(0,"Labor must be positive"),credit_hours:J.number().min(0,"Credit hours must be positive"),reason:Z().optional(),new_hire_name:Z().optional(),terminations:Z().optional(),term_date:Z().optional()}),gr=De({business_date:Z().min(1,"Business date is required"),bacon_variance:J.number().default(0),beef_4oz_variance:J.number().default(0),beef_small_variance:J.number().default(0),chicken_breaded_variance:J.number().default(0),chicken_diced_variance:J.number().default(0),chicken_nuggets_variance:J.number().default(0),chicken_nuggets_spicy_variance:J.number().default(0),chicken_patty_3_1_variance:J.number().default(0),chicken_breaded_spicy_variance:J.number().default(0),chicken_strips_variance:J.number().default(0),sausage_patty_variance:J.number().default(0),notes:Z().optional()}),fr=Fs("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),U=p.forwardRef(({className:s,...a},t)=>e.jsx(yt,{ref:t,className:P(fr(),s),...a}));U.displayName=yt.displayName;function pr(){const[s,a]=p.useState(!1),[t,c]=p.useState(!1),{toast:r}=ge(),{register:h,handleSubmit:d,formState:{errors:N}}=Be({resolver:Ye(xr)}),g=async L=>{a(!0);try{const{error:x}=await V.auth.signInWithPassword({email:L.email,password:L.password});if(x)throw x;r({title:"Welcome!",description:"Successfully signed in to your dashboard."})}catch(x){console.error("Login error:",x),r({title:"Login failed",description:x.message||"Please check your credentials and try again.",variant:"destructive"})}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen bg-wendys-gray flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-wendys-red rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-white font-bold text-3xl",children:"W"})}),e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal mb-2",children:"SE 14th GM Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to access your restaurant metrics"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 border border-gray-200",children:[e.jsxs("form",{onSubmit:d(g),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"email",className:"text-wendys-charcoal font-medium",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(vt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-10",...h("email")})]}),N.email&&e.jsx("p",{className:"text-red-600 text-sm",children:N.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"password",className:"text-wendys-charcoal font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"password",type:t?"text":"password",placeholder:"Enter your password",className:"pl-10 pr-10",...h("password")}),e.jsx("button",{type:"button",onClick:()=>c(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]}),N.password&&e.jsx("p",{className:"text-red-600 text-sm",children:N.password.message})]}),e.jsx(I,{type:"submit",className:"w-full wendys-button",disabled:s,children:s?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Demo Credentials"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," gm@se14th.wendys.com"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," test123"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use these credentials to test the dashboard functionality."})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Â© 2024 Wendy's International, Inc. All rights reserved."})})]})})}const be=ca({component:yr});function yr(){const[s,a]=p.useState(null),[t,c]=p.useState(!0),[r,h]=p.useState(()=>{const n=localStorage.getItem("navOpen"),f=typeof window<"u"?window.innerWidth>=768:!0;return n?JSON.parse(n):f}),[d,N]=p.useState(typeof window<"u"?window.innerWidth<768:!1),g=p.useRef(null),{toast:L}=ge(),x=ma();return p.useEffect(()=>{const n=()=>{const f=window.innerWidth<768;N(f),f&&r&&h(!1)};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r]),p.useEffect(()=>{const n=M=>{M.key==="Escape"&&r&&d&&h(!1)},f=M=>{d&&r&&g.current&&!g.current.contains(M.target)&&h(!1)};return r&&d?(document.addEventListener("keydown",n),document.addEventListener("mousedown",f),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.removeEventListener("keydown",n),document.removeEventListener("mousedown",f),document.body.style.overflow="unset"}},[r,d]),p.useEffect(()=>{if((async()=>{try{if("https://qewndmyixpzmtgjjihoj.supabase.co".trim()===""){a({id:"mock-user-id",email:"gm@wendys-se14th.com",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString()}),c(!1);return}const{data:{session:f}}=await V.auth.getSession();f!=null&&f.user&&a(f.user)}catch(f){console.error("Error checking session:",f),a({id:"mock-user-id",email:"gm@wendys-se14th.com",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString()})}finally{c(!1)}})(),"https://qewndmyixpzmtgjjihoj.supabase.co".trim()!==""){const{data:{subscription:f}}=V.auth.onAuthStateChange(async(M,E)=>{M==="SIGNED_IN"&&(E!=null&&E.user)?(a(E.user),L({title:"Welcome back!",description:"Successfully signed in to your dashboard."})):M==="SIGNED_OUT"&&(a(null),x({to:"/"}),L({title:"Signed out",description:"You have been successfully signed out."}))});return()=>f.unsubscribe()}},[x,L]),p.useEffect(()=>{localStorage.setItem("navOpen",JSON.stringify(r))},[r]),t?e.jsx("div",{className:"min-h-screen bg-wendys-gray flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-wendys-red mx-auto mb-4"}),e.jsx("p",{className:"text-wendys-charcoal",children:"Loading dashboard..."})]})}):s?e.jsxs("div",{className:"min-h-screen bg-wendys-gray",children:[e.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),e.jsx(cr,{user:s,onNavToggle:()=>h(!r),navOpen:r}),e.jsxs("div",{className:"flex relative",children:[d&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 backdrop-blur-sm",onClick:()=>h(!1)}),e.jsx(qt,{open:r,isMobile:d,onClose:()=>h(!1),ref:g}),e.jsx("main",{id:"main-content",className:P("flex-1 transition-all duration-300 ease-in-out mobile-container","ml-0"),children:e.jsx(ua,{})})]})]}):e.jsx(pr,{})}function Ge({className:s,classNames:a,showOutsideDays:t=!0,...c}){return e.jsx(xa,{showOutsideDays:t,className:P("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:P(Ms({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:P(Ms({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},...c})}Ge.displayName="Calendar";const ws=ga,js=fa,is=p.forwardRef(({className:s,align:a="center",sideOffset:t=4,...c},r)=>e.jsx(ha,{children:e.jsx(bt,{ref:r,align:a,sideOffset:t,className:P("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...c})}));is.displayName=bt.displayName;const vr=we("/weekending-sheet")({component:br});function br(){const[s,a]=p.useState(!1),[t,c]=p.useState(null),{toast:r}=ge(),h=qe(),[d,N]=p.useState(null),g=()=>{const o=Nt(new Date,{weekStartsOn:6});return H(ya(o,{weekStartsOn:6}),"yyyy-MM-dd")},L=()=>({week_ending_date:g(),manager_name:"Scott",breakfast_sales:0,late_night_sales:0,net_sales:0,discounts:0,cash:0,food_cost:0,variance_dollars:0,food_variance_percentage:0,labor:0,credit_hours:0,reason:"",new_hire_name:"",terminations:"",term_date:""}),x=m=>m==="Scott"||m==="Sophear"||m==="Letoya"||m==="Carissa"?m:"Scott",n=Be({resolver:Ye(hr),defaultValues:L()}),f=me({mutationFn:async m=>{if(!d)throw new Error("No store is linked to your account. See Setup to link one.");const o={store_id:d,...m};console.log("Attempting to insert data:",o),console.log("Store ID:",d),console.log("Payload:",m);const{data:R,error:O}=await V.from("weekending_sheet").insert(o).select();if(O)throw console.error("Supabase insert error:",O),console.error("Error details:",O.details),console.error("Error hint:",O.hint),console.error("Error message:",O.message),O;return R},onSuccess:()=>{r({title:"Success!",description:"Weekending sheet saved successfully."}),a(!1),c(null),n.reset(L()),console.log("ðŸ”„ Invalidating queries after weekending save..."),h.invalidateQueries({queryKey:["weekending_sheet",d]}),h.invalidateQueries({predicate:m=>{const o=m.queryKey[0]==="overview-weekending"||m.queryKey[0]==="overview-weekending-charts";return o&&console.log("ðŸ—‘ï¸ Invalidating query:",m.queryKey),o}}),console.log("âœ… Query invalidation complete")},onError:m=>{r({title:"Save failed",description:(m==null?void 0:m.message)||"Unable to save entry.",variant:"destructive"})}}),M=me({mutationFn:async({id:m,payload:o})=>{if(!d)throw new Error("No store is linked to your account. See Setup to link one.");const{error:R}=await V.from("weekending_sheet").update({...o}).eq("id",m);if(R)throw R},onSuccess:()=>{r({title:"Updated!",description:"Weekending sheet updated successfully."}),a(!1),c(null),n.reset(),console.log("ðŸ”„ Invalidating queries after weekending save..."),h.invalidateQueries({queryKey:["weekending_sheet",d]}),h.invalidateQueries({predicate:m=>{const o=m.queryKey[0]==="overview-weekending"||m.queryKey[0]==="overview-weekending-charts";return o&&console.log("ðŸ—‘ï¸ Invalidating query:",m.queryKey),o}}),console.log("âœ… Query invalidation complete")},onError:m=>{r({title:"Update failed",description:(m==null?void 0:m.message)||"Unable to update entry.",variant:"destructive"})}}),E=me({mutationFn:async m=>{const{error:o}=await V.from("weekending_sheet").delete().eq("id",m);if(o)throw o},onSuccess:()=>{r({title:"Deleted",description:"Weekending sheet entry removed."}),console.log("ðŸ”„ Invalidating queries after weekending save..."),h.invalidateQueries({queryKey:["weekending_sheet",d]}),h.invalidateQueries({predicate:m=>{const o=m.queryKey[0]==="overview-weekending"||m.queryKey[0]==="overview-weekending-charts";return o&&console.log("ðŸ—‘ï¸ Invalidating query:",m.queryKey),o}}),console.log("âœ… Query invalidation complete")},onError:m=>{r({title:"Delete failed",description:(m==null?void 0:m.message)||"Unable to delete entry.",variant:"destructive"})}}),q=m=>{const o={...m,breakfast_sales:Number(m.breakfast_sales)||0,late_night_sales:Number(m.late_night_sales)||0,net_sales:Number(m.net_sales)||0,discounts:Number(m.discounts)||0,cash:Number(m.cash)||0,food_cost:Number(m.food_cost)||0,variance_dollars:Number(m.variance_dollars)||0,food_variance_percentage:Number(m.food_variance_percentage)||0,labor:Number(m.labor)||0,credit_hours:Number(m.credit_hours)||0,term_date:m.term_date&&m.term_date.trim()!==""?m.term_date:null};t?M.mutate({id:t.id,payload:o}):f.mutate(o)},D=m=>{console.error("Form validation failed:",m),m.discounts&&console.error("Discounts error:",m.discounts),m.cash&&console.error("Cash error:",m.cash),m.food_cost&&console.error("Food cost error:",m.food_cost),r({title:"Validation Error",description:"Please check the form for errors and try again.",variant:"destructive"})};p.useEffect(()=>{let m=!0;return(async()=>{var R;try{const{data:O}=await V.auth.getUser(),v=(R=O.user)==null?void 0:R.id;if(!v||!m)return;console.log("Resolving store_id for user:",v);const{data:C}=await V.from("users").select("store_id").eq("id",v).maybeSingle();console.log("User data from database:",C),console.log("Store ID resolved:",C==null?void 0:C.store_id),m&&N((C==null?void 0:C.store_id)??null)}catch(O){console.error("Error resolving store ID:",O),m&&N(null)}})(),()=>{m=!1}},[]);const{data:u=[],isLoading:y,error:w}=ne({queryKey:["weekending_sheet",d],queryFn:async()=>{if(!d)return[];const{data:m,error:o}=await V.from("weekending_sheet").select("*").eq("store_id",d).order("week_ending_date",{ascending:!1}).limit(100);if(o)throw o;return m},enabled:!!d}),_=m=>{c(m),n.reset({week_ending_date:m.week_ending_date,manager_name:x(m.manager_name),breakfast_sales:m.breakfast_sales||0,late_night_sales:m.late_night_sales||0,net_sales:m.net_sales||0,discounts:m.discounts||0,cash:m.cash||0,food_cost:m.food_cost||0,variance_dollars:m.variance_dollars||0,food_variance_percentage:m.food_variance_percentage||0,labor:m.labor||0,credit_hours:m.credit_hours||0,reason:m.reason||"",new_hire_name:m.new_hire_name||"",terminations:m.terminations||"",term_date:m.term_date||""}),a(!0)},F=m=>{confirm("Are you sure you want to delete this entry?")&&E.mutate(m)},A=()=>{if(u.length===0){r({title:"No data",description:"No entries to export.",variant:"destructive"});return}const o=[["Week Ending Date","Manager","Breakfast Sales","Late Night Sales","Net Sales","Discounts","Cash","Food Cost","Variance Dollars","Food Variance %","Labor","Credit Hours","Reason","New Hire Name","Terminations","Term Date"].join(","),...u.map(C=>[C.week_ending_date,C.manager_name,C.breakfast_sales,C.late_night_sales,C.net_sales,C.discounts,C.cash,C.food_cost,C.variance_dollars,C.food_variance_percentage,C.labor,C.credit_hours,C.reason||"",C.new_hire_name||"",C.terminations||"",C.term_date||""].join(","))].join(`
`),R=new Blob([o],{type:"text/csv"}),O=window.URL.createObjectURL(R),v=document.createElement("a");v.href=O,v.download=`weekending-sheet-${H(new Date,"yyyy-MM-dd")}.csv`,v.click(),window.URL.revokeObjectURL(O),r({title:"Exported!",description:"CSV file downloaded successfully."})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-wendys-charcoal",children:"Weekending Sheet"}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Weekly operational data and metrics tracking"})]}),e.jsxs("div",{className:"flex flex-col space-y-2 md:flex-row md:space-y-0 md:space-x-2 md:items-center",children:[e.jsxs(I,{onClick:()=>{c(null),n.reset(L()),a(!0)},className:"wendys-button w-full md:w-auto",size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Weekending Entry"]}),u.length>0&&e.jsxs(I,{onClick:A,variant:"outline",size:"sm",className:"w-full md:w-auto border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:[e.jsx(_t,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]}),e.jsx("div",{className:"wendys-card",children:e.jsxs("div",{className:"grid-auto",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Entries"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:u.length})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Latest Week"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:u.length>0?he(u[0].week_ending_date):"N/A"})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Avg Net Sales"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:u.length>0?pe(u.reduce((m,o)=>m+(o.net_sales||0),0)/u.length):"$0"})]})]})}),w&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:["Error loading data: ",w.message]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Weekending Entries"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:y?"Loading...":`${u.length} entries`})]}),(u==null?void 0:u.length)===0&&!y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:d?e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"No data found"}),e.jsx("p",{className:"text-sm mt-2",children:"You haven't added any weekending entries yet."})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"Store not connected"}),e.jsx("p",{className:"text-sm mt-2",children:"Please go to Setup to link your account to a store first."})]})}),d&&e.jsxs(I,{onClick:()=>a(!0),className:"wendys-button",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Your First Entry"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Week Ending"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Manager"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Net Sales"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Food Variance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Labor"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:he(m.week_ending_date)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:m.manager_name})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:pe(m.net_sales)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.food_variance_percentage>0?"bg-red-100 text-red-800":m.food_variance_percentage<0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:de(m.food_variance_percentage)})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:pe(m.labor)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>_(m),className:"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-700",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>F(m.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-100",children:e.jsx(Ee,{className:"h-4 w-4"})})]})})]},m.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-4",children:u.map(m=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:he(m.week_ending_date)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Week Ending"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>_(m),className:"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-700",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>F(m.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-100",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Manager"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:m.manager_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Net Sales"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:pe(m.net_sales)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Food Variance"}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m.food_variance_percentage>0?"bg-red-100 text-red-800":m.food_variance_percentage<0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:de(m.food_variance_percentage)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Labor"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:pe(m.labor)})]})]})]},m.id))})]})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-5xl max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-wendys-red/10 rounded-lg",children:e.jsx(Ue,{className:"h-5 w-5 text-wendys-red"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-wendys-charcoal",children:t?"Edit Weekending Entry":"Add Weekending Entry"})]}),e.jsx(I,{variant:"ghost",onClick:()=>{a(!1),c(null),n.reset()},className:"h-10 w-10 p-0 hover:bg-gray-100 rounded-full",children:e.jsx("span",{className:"text-xl",children:"Ã—"})})]}),e.jsxs("form",{onSubmit:n.handleSubmit(q,D),className:"space-y-6",children:[Object.keys(n.formState.errors).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please fix the following errors:"}),e.jsx("ul",{className:"text-sm text-red-700 mt-2 space-y-1",children:Object.entries(n.formState.errors).map(([m,o])=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-red-400 rounded-full mr-2"}),o==null?void 0:o.message]},m))})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:e.jsx(Ue,{className:"h-5 w-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-3",children:[e.jsx(U,{className:"text-sm font-medium text-gray-700",children:"Week Ending Date *"}),e.jsxs(ws,{children:[e.jsx(js,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:"w-full justify-start text-left font-normal h-12 border-gray-300 hover:border-gray-400 focus:ring-2 focus:ring-wendys-red/20",children:[e.jsx(Ne,{className:"mr-3 h-5 w-5 text-gray-500"}),e.jsx("span",{className:n.watch("week_ending_date")?"text-gray-900":"text-gray-500",children:n.watch("week_ending_date")?he(n.watch("week_ending_date")):"Select week ending date"})]})}),e.jsx(is,{className:"w-auto p-0 shadow-lg",children:e.jsx(Ge,{mode:"single",selected:(()=>{const m=n.watch("week_ending_date");if(!m)return;const o=Number(m.slice(0,4)),R=Number(m.slice(5,7)),O=Number(m.slice(8,10));return new Date(o,(R||1)-1,O||1)})(),onSelect:m=>{const o=m?H(m,"yyyy-MM-dd"):"";n.setValue("week_ending_date",o)},initialFocus:!0})})]}),n.formState.errors.week_ending_date&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.week_ending_date.message]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-3",children:[e.jsx(U,{htmlFor:"reason",className:"text-sm font-medium text-gray-700",children:"Reason (Optional)"}),e.jsx($,{id:"reason",placeholder:"Add any notes or reason for this entry...",className:"h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("reason")}),n.formState.errors.reason&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.reason.message]})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg mr-3",children:e.jsx(pa,{className:"h-5 w-5 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sales & Financial Data"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"breakfast_sales",className:"text-sm font-medium text-gray-700",children:"Breakfast Sales (DP1) *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"breakfast_sales",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("breakfast_sales")})]}),n.formState.errors.breakfast_sales&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.breakfast_sales.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"late_night_sales",className:"text-sm font-medium text-gray-700",children:"Late Night Sales (DP6) *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"late_night_sales",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("late_night_sales")})]}),n.formState.errors.late_night_sales&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.late_night_sales.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"net_sales",className:"text-sm font-medium text-gray-700",children:"Net Sales *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"net_sales",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("net_sales")})]}),n.formState.errors.net_sales&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.net_sales.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"discounts",className:"text-sm font-medium text-gray-700",children:"Discounts (Can be negative)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"discounts",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("discounts")})]}),n.formState.errors.discounts&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.discounts.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"cash",className:"text-sm font-medium text-gray-700",children:"Cash (Can be negative)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"cash",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("cash")})]}),n.formState.errors.cash&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.cash.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"food_cost",className:"text-sm font-medium text-gray-700",children:"Food Cost (Can be negative)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"food_cost",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("food_cost")})]}),n.formState.errors.food_cost&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.food_cost.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"variance_dollars",className:"text-sm font-medium text-gray-700",children:"Variance Dollars (Can be negative)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"variance_dollars",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("variance_dollars")})]}),n.formState.errors.variance_dollars&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.variance_dollars.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"food_variance_percentage",className:"text-sm font-medium text-gray-700",children:"Food Variance % (Can be negative)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})}),e.jsx($,{id:"food_variance_percentage",type:"number",step:"0.1",placeholder:"0.0",className:"pr-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("food_variance_percentage")})]}),n.formState.errors.food_variance_percentage&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.food_variance_percentage.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"labor",className:"text-sm font-medium text-gray-700",children:"Labor *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx($,{id:"labor",type:"number",step:"0.01",placeholder:"0.00",className:"pl-7 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("labor")})]}),n.formState.errors.labor&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.labor.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"credit_hours",className:"text-sm font-medium text-gray-700",children:"Credit Hours *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"hrs"})}),e.jsx($,{id:"credit_hours",type:"number",step:"0.1",placeholder:"0.0",className:"pr-12 h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("credit_hours")})]}),n.formState.errors.credit_hours&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.credit_hours.message]})]})]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg mr-3",children:e.jsx(at,{className:"h-5 w-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Personnel"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"new_hire_name",className:"text-sm font-medium text-gray-700",children:"New Hire Name (Optional)"}),e.jsx($,{id:"new_hire_name",placeholder:"Enter new hire's name...",className:"h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("new_hire_name")}),n.formState.errors.new_hire_name&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.new_hire_name.message]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{htmlFor:"terminations",className:"text-sm font-medium text-gray-700",children:"Terminations (Optional)"}),e.jsx($,{id:"terminations",placeholder:"Enter termination details...",className:"h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("terminations")}),n.formState.errors.terminations&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.terminations.message]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-3",children:[e.jsx(U,{htmlFor:"term_date",className:"text-sm font-medium text-gray-700",children:"Termination Date (Optional)"}),e.jsx($,{id:"term_date",type:"date",className:"h-12 border-gray-300 focus:ring-2 focus:ring-wendys-red/20 focus:border-wendys-red",...n.register("term_date")}),n.formState.errors.term_date&&e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.formState.errors.term_date.message]})]})]})]}),!d&&e.jsx("div",{className:"text-sm text-red-600",children:"Your account isn't linked to a store yet. Open Setup and link your user to a store, then try again."}),e.jsxs("div",{className:"flex flex-col-reverse space-y-2 space-y-reverse md:flex-row md:space-y-0 md:space-x-3 pt-4",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{a(!1),c(null),n.reset()},className:"w-full md:w-auto",children:"Cancel"}),e.jsx(I,{type:"submit",className:"wendys-button w-full md:w-auto",disabled:f.isPending||M.isPending||!d,children:t?"Update Entry":"Save Entry"})]})]})]})})]})}const as=p.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:P("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a}));as.displayName="Textarea";function ve({title:s,subtitle:a,className:t,children:c,loading:r=!1,error:h,onRefresh:d}){return e.jsxs("div",{className:P("wendys-card",t),children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:s}),a&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a})]}),d&&e.jsx("button",{onClick:d,className:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Refresh chart",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),h?e.jsx("div",{className:"flex items-center justify-center h-[300px] text-red-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Error loading chart"}),e.jsx("p",{className:"text-xs mt-1 text-red-400",children:h}),d&&e.jsx("button",{onClick:d,className:"mt-2 px-3 py-1 text-xs bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Try again"})]})}):r?e.jsx(_r,{}):c]})}function _r(){return e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"h-[300px] bg-gray-100 rounded flex flex-col justify-end p-4",children:[e.jsx("div",{className:"absolute left-2 top-4 space-y-8",children:[...Array(4)].map((s,a)=>e.jsx("div",{className:"w-8 h-2 bg-gray-200 rounded"},a))}),e.jsx("div",{className:"flex items-end justify-between h-48 mb-4",children:[...Array(12)].map((s,a)=>e.jsx("div",{className:"bg-gray-200 rounded-t",style:{height:`${Math.random()*80+20}%`,width:"6%"}},a))}),e.jsx("div",{className:"flex justify-between",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"w-12 h-2 bg-gray-200 rounded"},a))})]})})}const re={currency:s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(s),currencyDetailed:s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(s),percent:(s,a=1)=>`${(s??0).toFixed(a)}%`,hours:(s,a=1)=>`${(s??0).toFixed(a)}h`,dateShort:s=>{const a=typeof s=="string"?new Date(Number(String(s).slice(0,4)),Number(String(s).slice(5,7))-1,Number(String(s).slice(8,10))):s;return H(a,"MMM d")},dateFull:s=>{const a=typeof s=="string"?new Date(Number(String(s).slice(0,4)),Number(String(s).slice(5,7))-1,Number(String(s).slice(8,10))):s;return H(a,"MMM dd, yyyy")},currencyCompact:s=>{if(s==null||isNaN(s))return"$0";const a=Math.abs(s);return a>=1e6?`$${(s/1e6).toFixed(1)}M`:a>=1e3?`$${(s/1e3).toFixed(1)}k`:re.currency(s)}},X={sales:"#E2231A",salesSecondary:"#B71C13",labor:"#374151",laborIdeal:"#6B7280",waste:"#EF4444",foodVariance:"#F59E0B",positive:"#10B981",warning:"#F59E0B",gridStroke:"#E5E7EB",textPrimary:"#111827",textSecondary:"#6B7280"},ee={cartesianGrid:{strokeDasharray:"3 3",stroke:X.gridStroke},xAxis:{stroke:X.textSecondary,fontSize:12,tickMargin:8},yAxis:{stroke:X.textSecondary,fontSize:12,tickMargin:8},tooltip:{contentStyle:{backgroundColor:"white",border:`1px solid ${X.gridStroke}`,borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",fontSize:"14px"},labelStyle:{color:X.textPrimary,fontWeight:"600",marginBottom:"4px"}},legend:{iconType:"rect",wrapperStyle:{fontSize:"12px",color:X.textSecondary}}},Vs=(s,a=new Date)=>{const t=new Date(a);switch(s){case"today":return{start:H(t,"yyyy-MM-dd"),end:H(t,"yyyy-MM-dd"),label:"Today"};case"wtd":const c=new Date(t);return c.setDate(t.getDate()-t.getDay()),{start:H(c,"yyyy-MM-dd"),end:H(t,"yyyy-MM-dd"),label:"Week to Date"};case"mtd":const r=new Date(t.getFullYear(),t.getMonth(),1);return{start:H(r,"yyyy-MM-dd"),end:H(t,"yyyy-MM-dd"),label:"Month to Date"};case"last7":const h=new Date(t);return h.setDate(t.getDate()-6),{start:H(h,"yyyy-MM-dd"),end:H(t,"yyyy-MM-dd"),label:"Last 7 Days"};case"last30":const d=new Date(t);return d.setDate(t.getDate()-29),{start:H(d,"yyyy-MM-dd"),end:H(t,"yyyy-MM-dd"),label:"Last 30 Days"};default:return{start:"",end:"",label:"All Time"}}},Hs=[{key:"today",label:"Today"},{key:"wtd",label:"WTD",description:"Week to Date"},{key:"mtd",label:"MTD",description:"Month to Date"},{key:"last7",label:"Last 7",description:"Last 7 Days"},{key:"last30",label:"Last 30",description:"Last 30 Days"},{key:"custom",label:"Custom"}];function Es({selectedRange:s="last30",selectedDate:a,onRangeChange:t,onDateChange:c,onClearFilters:r,className:h,compact:d=!1}){const N=s!=="last30"||a,g=x=>{t==null||t(x),x!=="custom"&&(c==null||c(void 0))},L=()=>{if(s==="custom"&&a)return H(a,"MMM dd, yyyy");const x=Hs.find(n=>n.key===s);return(x==null?void 0:x.label)||"Last 30"};return e.jsxs("div",{className:P("flex items-center gap-3 p-4 bg-gray-50 rounded-lg border",d&&"p-3",h),children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(va,{className:"h-4 w-4"}),e.jsx("span",{className:P("text-sm font-medium",d&&"hidden sm:inline"),children:"Filters:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Hs.map(x=>e.jsx(I,{variant:s===x.key?"default":"ghost",size:"sm",onClick:()=>g(x.key),className:P("text-xs h-7 px-2",s===x.key?"bg-wendys-red text-white hover:bg-wendys-red/90":"text-gray-600 hover:text-gray-900 hover:bg-gray-100",d&&"text-[11px] h-6 px-1.5"),title:x.description,children:x.label},x.key))}),s==="custom"&&e.jsxs(ws,{children:[e.jsx(js,{asChild:!0,children:e.jsxs(I,{variant:"outline",size:"sm",className:P("justify-start text-left font-normal h-7",!a&&"text-muted-foreground",d&&"h-6 text-xs"),children:[e.jsx(Ne,{className:"mr-1 h-3 w-3"}),a?H(a,"MMM dd"):"Pick date"]})}),e.jsx(is,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:a,onSelect:c,initialFocus:!0})})]}),!d&&N&&e.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-gray-500 border-l pl-3 ml-1",children:[e.jsx("span",{children:"Showing:"}),e.jsx("span",{className:"font-medium text-gray-700",children:L()})]}),N&&r&&e.jsxs(I,{variant:"ghost",size:"sm",onClick:r,className:P("text-xs text-gray-500 hover:text-gray-700 h-7 px-2",d&&"h-6 px-1.5"),children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),"Clear"]})]})}function Ss(s,a="last30"){const[t,c]=Oe.useState(()=>typeof window<"u"&&localStorage.getItem(`${s}_range`)||a),[r,h]=Oe.useState(()=>{if(typeof window<"u"){const x=localStorage.getItem(`${s}_date`);if(x){const[n,f,M]=x.split("-").map(Number);return new Date(n,(f||1)-1,M||1)}return}}),d=Oe.useCallback(x=>{c(x),typeof window<"u"&&localStorage.setItem(`${s}_range`,x)},[s]),N=Oe.useCallback(x=>{if(h(x),typeof window<"u")if(x){const n=H(x,"yyyy-MM-dd");localStorage.setItem(`${s}_date`,n)}else localStorage.removeItem(`${s}_date`)},[s]),g=Oe.useCallback(()=>{c(a),h(void 0),typeof window<"u"&&(localStorage.removeItem(`${s}_range`),localStorage.removeItem(`${s}_date`))},[s,a]),L=Oe.useCallback(()=>{if(t==="custom"&&r){const x=H(r,"yyyy-MM-dd");return{start:x,end:x}}if(t&&t!=="custom"){const x=Vs(t);return x.start?{start:x.start,end:x.end}:null}return null},[t,r]);return{selectedRange:t,selectedDate:r,handleRangeChange:d,handleDateChange:N,clearFilters:g,getDateRangeFilter:L,getSelectedLabel:()=>t==="custom"&&r?H(r,"MMM dd, yyyy"):Vs(t).label}}function se({title:s,value:a,format:t,delta:c,deltaLabel:r,icon:h,trend:d,suffix:N,subtitle:g,sparklineData:L,className:x}){const n=E=>{if(E==null||isNaN(E))return"0";switch(t){case"currency":return pe(E);case"percentage":return de(E);case"number":return E.toLocaleString();default:return E.toString()}},f=()=>{switch(d){case"up":return e.jsx(ce,{className:"h-4 w-4 text-green-600"});case"down":return e.jsx(_e,{className:"h-4 w-4 text-red-600"});case"neutral":return e.jsx(ba,{className:"h-4 w-4 text-gray-400"})}},M=()=>{switch(d){case"up":return"text-green-600";case"down":return"text-red-600";case"neutral":return"text-gray-600"}};return e.jsx("div",{className:P("wendys-card",x),children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 truncate",children:s}),e.jsx("div",{className:"w-8 h-8 bg-wendys-red bg-opacity-10 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(h,{className:"h-4 w-4 text-wendys-red"})})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("span",{className:"text-2xl font-bold text-wendys-charcoal",children:[n(a),N&&e.jsx("span",{className:"text-lg ml-1 font-normal",children:N})]}),L&&L.length>0&&e.jsx("div",{className:"w-16 h-8 ml-2",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsx(ze,{data:L,children:e.jsx(Re,{type:"monotone",dataKey:"value",stroke:d==="up"?X.positive:d==="down"?X.waste:X.textSecondary,strokeWidth:1.5,dot:!1})})})})]}),c!=null&&r&&e.jsxs("div",{className:"flex items-center space-x-1 mt-3",children:[f(),e.jsxs("span",{className:P("text-sm font-medium",M()),children:[c>0?"+":"",Math.abs(c)<1&&t!=="percentage"?de(Math.abs(c)*100):n(Math.abs(c)),N&&t!=="percentage"&&e.jsx("span",{className:"ml-1",children:N})]}),e.jsx("span",{className:"text-xs text-gray-500",children:r})]}),g&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-gray-500",children:g})})]})})})}const Nr=we("/soft-inventory")({component:wr}),Se=[{key:"bacon_variance",label:"Bacon",color:"#ef4444"},{key:"beef_4oz_variance",label:"Beef 4oz",color:"#dc2626"},{key:"beef_small_variance",label:"Beef Small",color:"#b91c1c"},{key:"chicken_breaded_variance",label:"Chicken Breaded",color:"#16a34a"},{key:"chicken_diced_variance",label:"Chicken Diced",color:"#15803d"},{key:"chicken_nuggets_variance",label:"Chicken Nuggets",color:"#ca8a04"},{key:"chicken_nuggets_spicy_variance",label:"Chicken Nuggets Spicy",color:"#a16207"},{key:"chicken_patty_3_1_variance",label:"Chicken Patty 3.1",color:"#059669"},{key:"chicken_breaded_spicy_variance",label:"Chicken Breaded Spicy",color:"#047857"},{key:"chicken_strips_variance",label:"Chicken Strips",color:"#0891b2"},{key:"sausage_patty_variance",label:"Sausage Patty",color:"#7c2d12"}];function wr(){const[s,a]=p.useState(null),[t,c]=p.useState(null),[r,h]=p.useState(!1),{toast:d}=ge(),N=qe(),g=Ss("soft-inventory","today");p.useEffect(()=>{let o=!0;return(async()=>{var K;const{data:R}=await V.auth.getUser(),O=(K=R.user)==null?void 0:K.id;if(!O)return;const{data:v,error:C}=await V.from("users").select("store_id").eq("id",O).maybeSingle();if(o){if(C){console.error("Error fetching store ID:",C);return}a((v==null?void 0:v.store_id)??null)}})(),()=>{o=!1}},[]);const L=g.getDateRangeFilter(),{data:x=[],isLoading:n,error:f}=ne({queryKey:["soft-inventory-variance",s,L==null?void 0:L.start,L==null?void 0:L.end],queryFn:async()=>{if(!s)return[];let o=V.from("soft_inventory_variance").select("*").eq("store_id",s);L&&(o=o.gte("business_date",L.start).lte("business_date",L.end));const{data:R,error:O}=await o.order("business_date",{ascending:!1});if(O)throw O;return R||[]},enabled:!!s}),{data:M=[]}=ne({queryKey:["soft-inventory-charts",s],queryFn:async()=>{if(!s)return[];const o=new Date;o.setDate(o.getDate()-30);const R=o.toISOString().slice(0,10),{data:O,error:v}=await V.from("soft_inventory_variance").select("*").eq("store_id",s).gte("business_date",R).order("business_date",{ascending:!0});if(v)throw v;return O||[]},enabled:!!s}),E=Be({resolver:Ye(gr),defaultValues:{business_date:H(new Date,"yyyy-MM-dd"),bacon_variance:0,beef_4oz_variance:0,beef_small_variance:0,chicken_breaded_variance:0,chicken_diced_variance:0,chicken_nuggets_variance:0,chicken_nuggets_spicy_variance:0,chicken_patty_3_1_variance:0,chicken_breaded_spicy_variance:0,chicken_strips_variance:0,sausage_patty_variance:0,notes:""}}),q=me({mutationFn:async o=>{if(!s)throw new Error("Store ID not available");const R={store_id:s,business_date:o.business_date,bacon_variance:o.bacon_variance,beef_4oz_variance:o.beef_4oz_variance,beef_small_variance:o.beef_small_variance,chicken_breaded_variance:o.chicken_breaded_variance,chicken_diced_variance:o.chicken_diced_variance,chicken_nuggets_variance:o.chicken_nuggets_variance,chicken_nuggets_spicy_variance:o.chicken_nuggets_spicy_variance,chicken_patty_3_1_variance:o.chicken_patty_3_1_variance,chicken_breaded_spicy_variance:o.chicken_breaded_spicy_variance,chicken_strips_variance:o.chicken_strips_variance,sausage_patty_variance:o.sausage_patty_variance,notes:o.notes||null};if(t){const{error:O}=await V.from("soft_inventory_variance").update(R).eq("id",t);if(O)throw O}else{const{error:O}=await V.from("soft_inventory_variance").insert(R);if(O)throw O}},onSuccess:()=>{N.invalidateQueries({queryKey:["soft-inventory-variance"]}),N.invalidateQueries({queryKey:["soft-inventory-charts"]}),N.invalidateQueries({queryKey:["overview"]}),c(null),h(!1),E.reset(),d({title:"Success",description:t?"Variance entry updated successfully":"Variance entry added successfully"})},onError:o=>{d({title:"Error",description:o.message||"Failed to save variance entry",variant:"destructive"})}}),D=me({mutationFn:async o=>{const{error:R}=await V.from("soft_inventory_variance").delete().eq("id",o);if(R)throw R},onSuccess:()=>{N.invalidateQueries({queryKey:["soft-inventory-variance"]}),N.invalidateQueries({queryKey:["soft-inventory-charts"]}),N.invalidateQueries({queryKey:["overview"]}),d({title:"Success",description:"Variance entry deleted successfully"})},onError:o=>{d({title:"Error",description:o.message||"Failed to delete variance entry",variant:"destructive"})}}),u=p.useMemo(()=>x.length===0?Se.reduce((o,R)=>({...o,[R.key]:{totalEntries:0,averageVariance:0,averageAbsVariance:0,positiveVariance:0,negativeVariance:0,bestVariance:0,worstVariance:0,worstAbsVariance:0}}),{}):Se.reduce((o,R)=>{const O=x.map(G=>G[R.key]),v=O.filter(G=>G>0),C=O.filter(G=>G<0),K=O.map(G=>Math.abs(G));return o[R.key]={totalEntries:x.length,averageVariance:O.reduce((G,te)=>G+te,0)/O.length,averageAbsVariance:K.reduce((G,te)=>G+te,0)/K.length,positiveVariance:v.length,negativeVariance:C.length,bestVariance:Math.min(...K),worstVariance:Math.max(...K),worstAbsVariance:Math.max(...K)},o},{}),[x]),y=p.useMemo(()=>{if(x.length===0)return{totalEntries:0,averageVariance:0,averageAbsVariance:0,positiveVariance:0,negativeVariance:0};const o=x.flatMap(C=>Se.map(K=>C[K.key])),R=o.filter(C=>C>0),O=o.filter(C=>C<0),v=o.map(C=>Math.abs(C));return{totalEntries:x.length,averageVariance:o.reduce((C,K)=>C+K,0)/o.length,averageAbsVariance:v.reduce((C,K)=>C+K,0)/v.length,positiveVariance:R.length,negativeVariance:O.length}},[x]),w=p.useMemo(()=>M.map(o=>({date:o.business_date,formattedDate:H(new Date(o.business_date),"MMM dd"),...Se.reduce((R,O)=>{const v=o[O.key];return R[O.label]=Math.abs(v),R[`${O.label}_original`]=v,R},{})})),[M]),_=o=>{c(o.id),h(!1),E.reset({business_date:o.business_date,bacon_variance:o.bacon_variance||0,beef_4oz_variance:o.beef_4oz_variance||0,beef_small_variance:o.beef_small_variance||0,chicken_breaded_variance:o.chicken_breaded_variance||0,chicken_diced_variance:o.chicken_diced_variance||0,chicken_nuggets_variance:o.chicken_nuggets_variance||0,chicken_nuggets_spicy_variance:o.chicken_nuggets_spicy_variance||0,chicken_patty_3_1_variance:o.chicken_patty_3_1_variance||0,chicken_breaded_spicy_variance:o.chicken_breaded_spicy_variance||0,chicken_strips_variance:o.chicken_strips_variance||0,sausage_patty_variance:o.sausage_patty_variance||0,notes:o.notes||""})},F=o=>{confirm("Are you sure you want to delete this variance entry?")&&D.mutate(o)},A=()=>{c(null),h(!1),E.reset({business_date:H(new Date,"yyyy-MM-dd"),bacon_variance:0,beef_4oz_variance:0,beef_small_variance:0,chicken_breaded_variance:0,chicken_diced_variance:0,chicken_nuggets_variance:0,chicken_nuggets_spicy_variance:0,chicken_patty_3_1_variance:0,chicken_breaded_spicy_variance:0,chicken_strips_variance:0,sausage_patty_variance:0,notes:""})},m=o=>{q.mutate(o)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Soft Inventory Analysis"}),e.jsxs("p",{className:"text-gray-600",children:["Track daily variance percentages for specific food items",n&&e.jsx("span",{className:"ml-2 text-sm",children:"(Loading...)"})]}),f&&e.jsxs("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:["Error loading data: ",f.message]})]}),e.jsx(Es,{selectedRange:g.selectedRange,selectedDate:g.selectedDate,onRangeChange:g.handleRangeChange,onDateChange:g.handleDateChange,onClearFilters:g.clearFilters,compact:!0})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:r?"Add New Variance Entry":t?"Edit Variance Entry":"Variance Entry Form"}),!r&&!t&&e.jsxs(I,{onClick:()=>h(!0),className:"bg-wendys-red hover:bg-wendys-dark-red text-white",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Entry"]})]}),(r||t)&&e.jsxs("form",{onSubmit:E.handleSubmit(m),className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(U,{htmlFor:"business_date",children:"Business Date"}),e.jsx($,{id:"business_date",type:"date",...E.register("business_date"),className:E.formState.errors.business_date?"border-red-500":""}),E.formState.errors.business_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:E.formState.errors.business_date.message})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Se.map(o=>{var R;return e.jsxs("div",{children:[e.jsxs(U,{htmlFor:o.key,className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}}),o.label]}),e.jsx($,{id:o.key,type:"number",step:"0.01",placeholder:"0.00",...E.register(o.key,{setValueAs:O=>O===""?0:parseFloat(O)}),className:E.formState.errors[o.key]?"border-red-500":""}),E.formState.errors[o.key]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:(R=E.formState.errors[o.key])==null?void 0:R.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter positive for overage, negative for shortage (e.g., -66.38)"})]},o.key)})}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(as,{id:"notes",placeholder:"Add any additional notes about this variance...",...E.register("notes"),rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{type:"submit",disabled:q.isPending,className:"bg-wendys-red hover:bg-wendys-dark-red text-white",children:[e.jsx(wt,{className:"h-4 w-4 mr-2"}),q.isPending?"Saving...":t?"Update":"Save"]}),e.jsxs(I,{type:"button",variant:"outline",onClick:A,disabled:q.isPending,children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Total Entries",value:y.totalEntries,format:"number",icon:fs,trend:"neutral"}),e.jsx(se,{title:"Average Variance",value:y.averageAbsVariance,format:"percentage",icon:As,trend:"neutral",subtitle:"Lower is better"}),e.jsx(se,{title:"Positive Variances",value:y.positiveVariance,format:"number",icon:ce,trend:"neutral",suffix:"count"}),e.jsx(se,{title:"Negative Variances",value:y.negativeVariance,format:"number",icon:_e,trend:"neutral",suffix:"count"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(ve,{title:"Variance Trend by Item",subtitle:"Last 30 days - Higher values indicate worse performance",loading:!w.length&&!f,error:f==null?void 0:f.message,children:w.length>0?e.jsx("div",{className:"h-[400px]",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(ze,{data:w,children:[e.jsx(Le,{strokeDasharray:"3 3"}),e.jsx(Ie,{dataKey:"formattedDate",tick:{fontSize:12},interval:"preserveStartEnd"}),e.jsx(Me,{tick:{fontSize:12},tickFormatter:o=>`${o}%`,label:{value:"Variance % (Higher = Worse)",angle:-90,position:"insideLeft"}}),e.jsx(Ve,{formatter:(o,R,O)=>{var C;const v=(C=O.payload)==null?void 0:C[`${R}_original`];return[`${v!==void 0?v:o}%`,R]},labelFormatter:o=>`Date: ${o}`,contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(jt,{}),e.jsx(Is,{y:0,stroke:"#666",strokeDasharray:"2 2"}),Se.map(o=>e.jsx(Re,{type:"monotone",dataKey:o.label,stroke:o.color,strokeWidth:2.5,dot:{fill:o.color,strokeWidth:2,r:4},activeDot:{r:6,stroke:o.color,strokeWidth:2,fill:"#fff"},connectNulls:!1},o.key))]})})}):e.jsx("div",{className:"flex items-center justify-center h-[400px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No variance data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries below to see trends"})]})})}),e.jsx(ve,{title:"Item Performance Summary",subtitle:"Average variance by item",loading:!w.length&&!f,error:f==null?void 0:f.message,children:w.length>0?e.jsx("div",{className:"h-[400px] overflow-y-auto",children:e.jsx("div",{className:"space-y-3",children:Se.map(o=>{const R=u[o.key];return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-sm",style:{color:o.color},children:o.label}),e.jsxs("span",{className:`text-sm font-bold ${R.averageAbsVariance<=5?"text-green-600":R.averageAbsVariance<=15?"text-yellow-600":"text-red-600"}`,children:[R.averageAbsVariance.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Best: ",R.bestVariance.toFixed(1),"%"]}),e.jsxs("span",{children:["Worst: ",R.worstVariance.toFixed(1),"%"]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${R.averageAbsVariance<=5?"bg-green-500":R.averageAbsVariance<=15?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(R.averageAbsVariance/30*100,100)}%`}})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Avg. Abs. Variance (Lower = Better)"})]})]},o.key)})})}):e.jsx("div",{className:"flex items-center justify-center h-[400px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No variance data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries below to see performance"})]})})})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4",children:"Variance Entries"}),x.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(fs,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No variance entries found"}),e.jsx("p",{className:"text-sm mt-1",children:"Add your first entry using the form above"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Date"}),Se.map(o=>e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:o.label},o.key)),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Notes"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(o=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:H(new Date(o.business_date),"MMM dd, yyyy")}),Se.map(R=>{const O=o[R.key];return e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`font-medium ${O>0?"text-green-600":O<0?"text-red-600":"text-gray-600"}`,children:[O>0?"+":"",O.toFixed(1),"%"]})},R.key)}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:o.notes||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>_(o),disabled:D.isPending,children:e.jsx(Fe,{className:"h-3 w-3"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>F(o.id),disabled:D.isPending,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Ee,{className:"h-3 w-3"})})]})})]},o.id))})]})})]})]})}function jr({columns:s,data:a,className:t,emptyMessage:c="No data available",loading:r=!1}){const[h,d]=p.useState(null),[N,g]=p.useState(null),L=p.useMemo(()=>!h||!N?a:[...a].sort((f,M)=>{const E=f[h],q=M[h];if(E==null&&q==null)return 0;if(E==null)return N==="asc"?-1:1;if(q==null)return N==="asc"?1:-1;if(typeof E=="number"&&typeof q=="number")return N==="asc"?E-q:q-E;if(typeof E=="string"&&typeof q=="string")return N==="asc"?E.localeCompare(q):q.localeCompare(E);if(E instanceof Date&&q instanceof Date)return N==="asc"?E.getTime()-q.getTime():q.getTime()-E.getTime();const D=String(E),u=String(q);return N==="asc"?D.localeCompare(u):u.localeCompare(D)}),[a,h,N]),x=f=>{h===f?N==="asc"?g("desc"):N==="desc"&&(g(null),d(null)):(d(f),g("asc"))},n=f=>h!==f?e.jsx(Ps,{className:"h-3 w-3 text-gray-400"}):N==="asc"?e.jsx(Et,{className:"h-3 w-3 text-gray-600"}):N==="desc"?e.jsx(Ns,{className:"h-3 w-3 text-gray-600"}):e.jsx(Ps,{className:"h-3 w-3 text-gray-400"});return r?e.jsx(Er,{columns:s}):e.jsx("div",{className:P("overflow-x-auto",t),children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:s.map(f=>e.jsx("th",{className:P("py-3 px-4 font-medium text-gray-700 text-sm",f.align==="center"&&"text-center",f.align==="right"&&"text-right",f.sortable&&"cursor-pointer hover:bg-gray-100 select-none",f.className),onClick:()=>f.sortable&&x(f.key),children:e.jsxs("div",{className:P("flex items-center gap-1",f.align==="center"&&"justify-center",f.align==="right"&&"justify-end"),children:[f.label,f.sortable&&n(f.key)]})},f.key))})}),e.jsx("tbody",{children:L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,className:"py-8 px-4 text-center text-gray-500",children:c})}):L.map((f,M)=>e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:s.map(E=>e.jsx("td",{className:P("py-3 px-4 text-sm",E.align==="center"&&"text-center",E.align==="right"&&"text-right",E.className),children:E.render?E.render(f[E.key],f):f[E.key]},E.key))},f.id||M))})]})})}function Er({columns:s}){return e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:s.map(a=>e.jsx("th",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})},a.key))})}),e.jsx("tbody",{children:[...Array(5)].map((a,t)=>e.jsx("tr",{className:"border-b border-gray-100",children:s.map(c=>e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-100 rounded w-full"})},c.key))},t))})]})})})}const Sr=we("/smg")({component:kr});function kr(){const[s,a]=p.useState(null),[t,c]=p.useState(),{toast:r}=ge(),h=qe(),d=Be({resolver:Ye(ur),defaultValues:{date:"",accuracy_decimal:0,zod_per_10k:0,cc_complaints:0,osat_decimal:0,notes:""}});p.useEffect(()=>{let u=!0;return(async()=>{var A;const{data:y}=await V.auth.getUser(),w=(A=y.user)==null?void 0:A.id;if(!w)return;const{data:_,error:F}=await V.from("users").select("store_id").eq("id",w).maybeSingle();u&&(F||a((_==null?void 0:_.store_id)??null))})(),()=>{u=!1}},[]);const{data:N=[],isLoading:g,error:L}=ne({queryKey:["smg_daily",s],queryFn:async()=>{if(!s)return[];const{data:u,error:y}=await V.from("smg_daily").select("*").eq("store_id",s).order("date",{ascending:!1});if(y)throw y;return u||[]},enabled:!!s}),{data:x=[]}=ne({queryKey:["smg_entries_import",s],queryFn:async()=>{if(!s)return[];const{data:u,error:y}=await V.from("smg_entries").select("*").eq("store_id",s).order("entry_date",{ascending:!1});if(y)throw y;return u||[]},enabled:!!s}),n=p.useMemo(()=>N.length>0?N:x.length?x.map(u=>({id:u.id,date:u.entry_date,accuracy_decimal:Number(u.accuracy_of_order)||0,zod_per_10k:Number(u.zone_of_defection)||0,cc_complaints:Number(u.customer_computers)||0,osat_decimal:Number(u.osat)||0,notes:"",created_at:u.created_at})):[],[N,x]),f=me({mutationFn:async u=>{if(!s)throw new Error("Store not connected");const{error:y}=await V.from("smg_daily").insert({store_id:s,date:u.date,accuracy_decimal:u.accuracy_decimal,zod_per_10k:u.zod_per_10k,cc_complaints:u.cc_complaints,osat_decimal:u.osat_decimal,notes:u.notes||null});if(y)throw y},onSuccess:()=>{h.invalidateQueries({queryKey:["smg_daily",s]}),d.reset(),c(void 0),r({title:"Success",description:"SMG entry saved successfully."})},onError:u=>{r({title:"Error",description:u.message||"Failed to save SMG entry.",variant:"destructive"})}}),M=u=>{f.mutate(u)},E=u=>{const y=Number(u.slice(0,4)),w=Number(u.slice(5,7)),_=Number(u.slice(8,10));return new Date(y,(w||1)-1,_||1)},q=[{key:"date",label:"Date",sortable:!0,render:u=>H(E(u),"MMM dd, yyyy")},{key:"accuracy_decimal",label:"Accuracy of Order",sortable:!0,align:"right",render:u=>(u??0).toFixed(2)},{key:"zod_per_10k",label:"ZOD per 10k",sortable:!0,align:"right",render:u=>(u??0).toFixed(2)},{key:"cc_complaints",label:"CC Complaints",sortable:!0,align:"right",render:u=>(u??0).toFixed(2)},{key:"osat_decimal",label:"OSAT Score",sortable:!0,align:"right",render:u=>(u??0).toFixed(2)},{key:"notes",label:"Notes",sortable:!1,render:u=>e.jsx("div",{className:"max-w-32 truncate",title:u,children:u||"-"})}],D=p.useMemo(()=>n.length?n.slice().reverse().map(u=>({date:re.dateShort(u.date),osat:u.osat_decimal})):[],[n]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"SMG Manual Entry"}),e.jsx("p",{className:"text-gray-600",children:"Record your daily service metrics and customer satisfaction scores"})]})}),L&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:["Error loading data: ",L.message]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Te,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Add New Entry"})]}),e.jsxs("form",{onSubmit:d.handleSubmit(M),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"date",children:"Date *"}),e.jsxs(ws,{children:[e.jsx(js,{asChild:!0,children:e.jsxs(I,{variant:"outline",id:"date",className:"w-full justify-start text-left font-normal",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),t?H(t,"MMM dd, yyyy"):"Select date"]})}),e.jsx(is,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:t,onSelect:u=>{c(u),u&&d.setValue("date",H(u,"yyyy-MM-dd"))},initialFocus:!0})})]}),d.formState.errors.date&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"accuracy_decimal",children:"Accuracy of Order *"}),e.jsx($,{id:"accuracy_decimal",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...d.register("accuracy_decimal",{valueAsNumber:!0})}),d.formState.errors.accuracy_decimal&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.accuracy_decimal.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"zod_per_10k",children:"ZOD per 10k *"}),e.jsx($,{id:"zod_per_10k",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...d.register("zod_per_10k",{valueAsNumber:!0})}),d.formState.errors.zod_per_10k&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.zod_per_10k.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"cc_complaints",children:"CC Complaints *"}),e.jsx($,{id:"cc_complaints",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...d.register("cc_complaints",{valueAsNumber:!0})}),d.formState.errors.cc_complaints&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.cc_complaints.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"osat_decimal",children:"OSAT Score *"}),e.jsx($,{id:"osat_decimal",type:"number",step:"0.01",min:"0",placeholder:"Enter decimal value",...d.register("osat_decimal",{valueAsNumber:!0})}),d.formState.errors.osat_decimal&&e.jsx("p",{className:"text-sm text-red-600",children:d.formState.errors.osat_decimal.message})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2 lg:col-span-1",children:[e.jsx(U,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-wendys-red focus:border-wendys-red",placeholder:"Optional notes...",...d.register("notes")})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(I,{type:"submit",disabled:f.isPending||!s,className:"bg-wendys-red hover:bg-wendys-red/90",children:f.isPending?"Saving...":"Save Entry"})})]})]}),e.jsx(ve,{title:"OSAT Score Trend",subtitle:`${n.length} entries`,loading:g,error:L==null?void 0:L.message,children:D.length>0?e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(ze,{data:D,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:u=>(u??0).toFixed(1)}),e.jsx(Ve,{...ee.tooltip,formatter:u=>[(u??0).toFixed(2),"OSAT Score"]}),e.jsx(Re,{type:"monotone",dataKey:"osat",stroke:X.sales,strokeWidth:3,dot:{fill:X.sales,strokeWidth:2,r:4},activeDot:{r:6,stroke:X.salesSecondary,strokeWidth:2},name:"OSAT Score"})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see OSAT trends"})]})})}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Previous Entries"}),e.jsx("div",{className:"text-sm text-gray-600",children:g?"Loading...":`${n.length} entries`})]}),s?e.jsx(jr,{columns:q,data:n,loading:g,emptyMessage:"No SMG entries found. Add your first entry above."}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"Store not connected"}),e.jsx("p",{className:"text-sm mt-2",children:"Please go to Setup to link your account to a store first."})]})})]})]})}const Ks=`-- Goals table for Goal Setting tab
create table if not exists public.goals (
  id uuid primary key default gen_random_uuid(),
  store_id uuid not null references stores(id) on delete cascade,
  scope text not null check (scope in ('week','month','custom')),
  period_start date not null,
  period_end date not null,
  sales_target numeric not null default 0,
  labor_target_pct numeric not null default 0,
  waste_target_pct numeric not null default 0,
  food_variance_target_pct numeric not null default 0,
  service_seconds_target numeric not null default 0,
  team_notes text,
  created_at timestamp with time zone default now(),
  unique (store_id, period_start, period_end)
);
-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Create stores table
CREATE TABLE stores (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text NOT NULL,
  created_at timestamptz DEFAULT now()
);

-- Create users table linked to auth.users
CREATE TABLE users (
  id uuid PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  store_id uuid NOT NULL REFERENCES stores(id),
  role text NOT NULL DEFAULT 'gm',
  created_at timestamptz DEFAULT now()
);

-- Create Omega Daily table for daily business metrics
CREATE TABLE omega_daily (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  business_date date NOT NULL,
  net_sales numeric NOT NULL,
  last_year_sales numeric NOT NULL,
  comp_net_sales numeric GENERATED ALWAYS AS (net_sales - last_year_sales) STORED,
  labor_hours numeric NOT NULL,
  ideal_labor_hours numeric NOT NULL,
  labor_hours_diff numeric GENERATED ALWAYS AS (labor_hours - ideal_labor_hours) STORED,
  labor_percentage numeric NOT NULL,
  theoretical_food_cost numeric NOT NULL,
  food_variance_cost numeric NOT NULL,
  food_variance_percentage numeric GENERATED ALWAYS AS (
    CASE WHEN theoretical_food_cost = 0 THEN 0 ELSE (food_variance_cost / theoretical_food_cost) * 100 END
  ) STORED,
  waste_amount numeric NOT NULL,
  waste_percentage numeric GENERATED ALWAYS AS (
    CASE WHEN net_sales = 0 THEN 0 ELSE (waste_amount / net_sales) * 100 END
  ) STORED,
  breakfast_sales numeric NOT NULL,
  night_sales numeric NOT NULL,
  created_at timestamptz DEFAULT now()
);

-- Create unique index on store_id and business_date
CREATE UNIQUE INDEX ON omega_daily (store_id, business_date);

-- Create interview status enum
CREATE TYPE interview_status AS ENUM ('SCHEDULED','COMPLETED','NO_SHOW','HIRED','REJECTED');

-- Create interviews table
CREATE TABLE interviews (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  candidate_name text NOT NULL,
  phone text,
  email text,
  position text,
  interview_date date NOT NULL,
  interview_time time NOT NULL,
  status interview_status NOT NULL DEFAULT 'SCHEDULED',
  notes text,
  created_at timestamptz DEFAULT now()
);

-- Create hiring process table
CREATE TABLE hires (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  interview_id uuid UNIQUE NOT NULL REFERENCES interviews(id) ON DELETE CASCADE,
  documents_received boolean DEFAULT false,
  documents_folder text, -- Supabase Storage path
  onboarding_sent_date date,
  onboarding_completed_date date,
  manager_reviewed_date date,
  entered_in_system_date date,
  fingerprint_scheduled_date date,
  first_day date,
  notes text,
  created_at timestamptz DEFAULT now()
);

-- Create SMG daily entries table
CREATE TABLE smg_entries (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id),
  entry_date date NOT NULL,
  accuracy_of_order numeric,
  zone_of_defection numeric,
  customer_computers numeric,
  taste_of_food numeric,
  osat numeric,
  created_at timestamptz DEFAULT now()
);

-- Create unique index on store_id and entry_date
CREATE UNIQUE INDEX ON smg_entries (store_id, entry_date);

-- Create view for SMG monthly aggregations
CREATE VIEW smg_monthly AS
SELECT
  store_id,
  date_trunc('month', entry_date)::date AS month_start,
  AVG(accuracy_of_order) AS avg_accuracy_of_order,
  AVG(zone_of_defection) AS avg_zone_of_defection,
  AVG(customer_computers) AS avg_customer_computers,
  AVG(taste_of_food) AS avg_taste_of_food,
  AVG(osat) AS avg_osat,
  COUNT(*) AS total_entries
FROM smg_entries
GROUP BY store_id, date_trunc('month', entry_date);

-- Enable Row Level Security on all tables
ALTER TABLE stores ENABLE ROW LEVEL SECURITY;
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE omega_daily ENABLE ROW LEVEL SECURITY;
ALTER TABLE interviews ENABLE ROW LEVEL SECURITY;
ALTER TABLE hires ENABLE ROW LEVEL SECURITY;
ALTER TABLE smg_entries ENABLE ROW LEVEL SECURITY;
-- RLS Policies for goals
ALTER TABLE goals ENABLE ROW LEVEL SECURITY;
CREATE POLICY goals_isolate ON goals
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for stores (only allow reading own store)
CREATE POLICY stores_isolate ON stores
  FOR ALL USING (id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for users (only allow reading own user record)
CREATE POLICY users_isolate ON users
  FOR ALL USING (id = auth.uid());

-- RLS Policies for omega_daily
CREATE POLICY omega_daily_isolate ON omega_daily
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for interviews
CREATE POLICY interviews_isolate ON interviews
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for hires
CREATE POLICY hires_isolate ON hires
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for smg_entries
CREATE POLICY smg_entries_isolate ON smg_entries
  FOR ALL USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()))
  WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- RLS Policies for smg_monthly view
CREATE POLICY smg_monthly_isolate ON smg_monthly
  FOR SELECT USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- Create SMG Daily table for manual entry
CREATE TABLE smg_daily (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  store_id UUID NOT NULL REFERENCES stores(id) ON DELETE CASCADE,
  date DATE NOT NULL,
  accuracy_decimal NUMERIC NOT NULL CHECK (accuracy_decimal >= 0),
  zod_per_10k NUMERIC NOT NULL CHECK (zod_per_10k >= 0),
  cc_complaints NUMERIC NOT NULL CHECK (cc_complaints >= 0),
  osat_decimal NUMERIC NOT NULL CHECK (osat_decimal >= 0),
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(store_id, date)
);

-- Enable RLS for smg_daily
ALTER TABLE smg_daily ENABLE ROW LEVEL SECURITY;

-- Create RLS policies for smg_daily
CREATE POLICY "Users can view their store's SMG data" ON smg_daily
  FOR SELECT USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can insert SMG data for their store" ON smg_daily
  FOR INSERT WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can update their store's SMG data" ON smg_daily
  FOR UPDATE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can delete their store's SMG data" ON smg_daily
  FOR DELETE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- Create Soft Inventory Analysis table
CREATE TABLE soft_inventory_variance (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  store_id uuid NOT NULL REFERENCES stores(id) ON DELETE CASCADE,
  business_date date NOT NULL,
  bacon_variance numeric(10,2) NOT NULL DEFAULT 0,
  beef_4oz_variance numeric(10,2) NOT NULL DEFAULT 0,
  beef_small_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_breaded_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_diced_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_nuggets_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_nuggets_spicy_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_patty_3_1_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_breaded_spicy_variance numeric(10,2) NOT NULL DEFAULT 0,
  chicken_strips_variance numeric(10,2) NOT NULL DEFAULT 0,
  sausage_patty_variance numeric(10,2) NOT NULL DEFAULT 0,
  notes text,
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now()
);

-- Create unique index on store_id and business_date
CREATE UNIQUE INDEX ON soft_inventory_variance (store_id, business_date);

-- Enable RLS for soft_inventory_variance
ALTER TABLE soft_inventory_variance ENABLE ROW LEVEL SECURITY;

-- Create RLS policies for soft_inventory_variance
CREATE POLICY "Users can view their store's soft inventory variance data" ON soft_inventory_variance
  FOR SELECT USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can insert soft inventory variance data for their store" ON soft_inventory_variance
  FOR INSERT WITH CHECK (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can update their store's soft inventory variance data" ON soft_inventory_variance
  FOR UPDATE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

CREATE POLICY "Users can delete their store's soft inventory variance data" ON soft_inventory_variance
  FOR DELETE USING (store_id = (SELECT store_id FROM users WHERE id = auth.uid()));

-- Create indexes for better performance
CREATE INDEX idx_omega_daily_store_date ON omega_daily(store_id, business_date);
CREATE INDEX idx_interviews_store_date ON interviews(store_id, interview_date);
CREATE INDEX idx_smg_entries_store_date ON smg_entries(store_id, entry_date);
CREATE INDEX idx_smg_daily_store_date ON smg_daily(store_id, date);
CREATE INDEX idx_hires_interview_id ON hires(interview_id);
CREATE INDEX idx_soft_inventory_variance_store_date ON soft_inventory_variance(store_id, business_date);
`,Bs=`-- Seed data for Wendy's GM Dashboard
-- This creates a test store, user, and sample data

-- Insert SE 14th store
INSERT INTO stores (id, name) VALUES 
('550e8400-e29b-41d4-a716-446655440000', 'SE 14th');

-- Insert test GM user (password: test123)
-- Note: You'll need to create this user in Supabase Auth first, then update the ID here
INSERT INTO users (id, store_id, role) VALUES 
('550e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440000', 'gm');

-- Insert sample Omega Daily data (last 35 days for better testing)
INSERT INTO omega_daily (store_id, business_date, net_sales, last_year_sales, labor_hours, ideal_labor_hours, labor_percentage, theoretical_food_cost, food_variance_cost, waste_amount, breakfast_sales, night_sales) VALUES
-- Today and recent days
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE, 12500.00, 11800.00, 85.5, 82.0, 6.8, 3750.00, 125.00, 87.50, 3200.00, 9300.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 11800.00, 11200.00, 82.0, 78.5, 6.9, 3540.00, 118.00, 82.60, 2950.00, 8850.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 13200.00, 12500.00, 88.0, 85.0, 6.7, 3960.00, 132.00, 92.40, 3300.00, 9900.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 11500.00, 10800.00, 79.5, 76.0, 6.9, 3450.00, 115.00, 80.50, 2875.00, 8625.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 12800.00, 12100.00, 86.0, 83.0, 6.7, 3840.00, 128.00, 89.60, 3200.00, 9600.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 12100.00, 11400.00, 81.5, 78.0, 6.7, 3630.00, 121.00, 84.70, 3025.00, 9075.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 13500.00, 12800.00, 90.0, 87.0, 6.7, 4050.00, 135.00, 94.50, 3375.00, 10125.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 11200.00, 10500.00, 75.5, 72.0, 6.7, 3360.00, 112.00, 78.40, 2800.00, 8400.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 12900.00, 12200.00, 86.5, 83.5, 6.7, 3870.00, 129.00, 90.30, 3225.00, 9675.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 11600.00, 10900.00, 78.0, 74.5, 6.7, 3480.00, 116.00, 81.20, 2900.00, 8700.00),
-- Additional days (10-34) for 30+ day testing
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 12300.00, 11600.00, 83.0, 80.0, 6.7, 3690.00, 123.00, 86.10, 3075.00, 9225.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '11 days', 11900.00, 11300.00, 81.0, 77.5, 6.8, 3570.00, 119.00, 83.30, 2975.00, 8925.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '12 days', 13100.00, 12400.00, 87.5, 84.5, 6.7, 3930.00, 131.00, 91.70, 3275.00, 9825.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '13 days', 11700.00, 11000.00, 79.0, 75.5, 6.8, 3510.00, 117.00, 81.90, 2925.00, 8775.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '14 days', 12600.00, 11900.00, 84.5, 81.5, 6.7, 3780.00, 126.00, 88.20, 3150.00, 9450.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '15 days', 12000.00, 11300.00, 80.5, 77.0, 6.7, 3600.00, 120.00, 84.00, 3000.00, 9000.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '16 days', 13400.00, 12700.00, 89.5, 86.5, 6.7, 4020.00, 134.00, 93.80, 3350.00, 10050.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '17 days', 11400.00, 10700.00, 76.5, 73.0, 6.7, 3420.00, 114.00, 79.80, 2850.00, 8550.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '18 days', 12700.00, 12000.00, 85.0, 82.0, 6.7, 3810.00, 127.00, 88.90, 3175.00, 9525.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '19 days', 11800.00, 11100.00, 79.5, 76.0, 6.7, 3540.00, 118.00, 82.60, 2950.00, 8850.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '20 days', 13000.00, 12300.00, 87.0, 84.0, 6.7, 3900.00, 130.00, 91.00, 3250.00, 9750.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '21 days', 11600.00, 10900.00, 78.0, 74.5, 6.7, 3480.00, 116.00, 81.20, 2900.00, 8700.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '22 days', 12400.00, 11700.00, 83.5, 80.5, 6.7, 3720.00, 124.00, 86.80, 3100.00, 9300.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '23 days', 12200.00, 11500.00, 82.0, 78.5, 6.7, 3660.00, 122.00, 85.40, 3050.00, 9150.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '24 days', 13300.00, 12600.00, 88.5, 85.5, 6.7, 3990.00, 133.00, 93.10, 3325.00, 9975.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '25 days', 11300.00, 10600.00, 76.0, 72.5, 6.7, 3390.00, 113.00, 79.10, 2825.00, 8475.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '26 days', 12800.00, 12100.00, 86.0, 83.0, 6.7, 3840.00, 128.00, 89.60, 3200.00, 9600.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '27 days', 11900.00, 11200.00, 80.0, 76.5, 6.7, 3570.00, 119.00, 83.30, 2975.00, 8925.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '28 days', 13200.00, 12500.00, 88.0, 85.0, 6.7, 3960.00, 132.00, 92.40, 3300.00, 9900.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '29 days', 11500.00, 10800.00, 77.5, 74.0, 6.7, 3450.00, 115.00, 80.50, 2875.00, 8625.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '30 days', 12700.00, 12000.00, 85.5, 82.5, 6.7, 3810.00, 127.00, 88.90, 3175.00, 9525.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '31 days', 11700.00, 11000.00, 78.5, 75.0, 6.7, 3510.00, 117.00, 81.90, 2925.00, 8775.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '32 days', 12500.00, 11800.00, 84.0, 81.0, 6.7, 3750.00, 125.00, 87.50, 3125.00, 9375.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '33 days', 12100.00, 11400.00, 81.0, 77.5, 6.7, 3630.00, 121.00, 84.70, 3025.00, 9075.00),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '34 days', 13000.00, 12300.00, 87.0, 84.0, 6.7, 3900.00, 130.00, 91.00, 3250.00, 9750.00);

-- Insert sample interviews
INSERT INTO interviews (store_id, candidate_name, phone, email, position, interview_date, interview_time, status, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', 'John Smith', '555-0101', 'john.smith@email.com', 'Crew Member', CURRENT_DATE + INTERVAL '1 day', '14:00:00', 'SCHEDULED', 'Experienced in food service'),
('550e8400-e29b-41d4-a716-446655440000', 'Sarah Johnson', '555-0102', 'sarah.j@email.com', 'Shift Leader', CURRENT_DATE, '10:00:00', 'COMPLETED', 'Great communication skills, recommended for hire'),
('550e8400-e29b-41d4-a716-446655440000', 'Mike Davis', '555-0103', 'mike.d@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '1 day', '15:30:00', 'NO_SHOW', 'No call, no show'),
('550e8400-e29b-41d4-a716-446655440000', 'Lisa Wilson', '555-0104', 'lisa.w@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '2 days', '11:00:00', 'HIRED', 'Excellent candidate, starting next week'),
('550e8400-e29b-41d4-a716-446655440000', 'Tom Brown', '555-0105', 'tom.b@email.com', 'Crew Member', CURRENT_DATE - INTERVAL '3 days', '16:00:00', 'REJECTED', 'Not a good fit for the team');

-- Insert sample hire for Lisa Wilson
INSERT INTO hires (store_id, interview_id, documents_received, onboarding_sent_date, onboarding_completed_date, manager_reviewed_date, entered_in_system_date, fingerprint_scheduled_date, first_day, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', 
 (SELECT id FROM interviews WHERE candidate_name = 'Lisa Wilson'), 
 true, 
 CURRENT_DATE - INTERVAL '1 day', 
 CURRENT_DATE, 
 CURRENT_DATE, 
 CURRENT_DATE, 
 CURRENT_DATE + INTERVAL '3 days', 
 CURRENT_DATE + INTERVAL '7 days', 
 'Lisa is very organized and completed all requirements quickly');

-- Insert sample SMG entries (last 30 days)
INSERT INTO smg_entries (store_id, entry_date, accuracy_of_order, zone_of_defection, customer_computers, taste_of_food, osat) VALUES
-- Recent days
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE, 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '11 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '12 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '13 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '14 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '15 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '16 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '17 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '18 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '19 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '20 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '21 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '22 days', 4.9, 1.0, 4.8, 4.9, 4.8),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '23 days', 4.5, 1.5, 4.3, 4.4, 4.3),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '24 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '25 days', 4.7, 1.3, 4.5, 4.6, 4.5),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '26 days', 4.9, 1.1, 4.7, 4.8, 4.7),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '27 days', 4.6, 1.4, 4.4, 4.5, 4.4),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '28 days', 4.8, 1.2, 4.6, 4.7, 4.6),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '29 days', 4.7, 1.3, 4.5, 4.6, 4.5);

-- Add sample SMG daily data
INSERT INTO smg_daily (store_id, date, accuracy_decimal, zod_per_10k, cc_complaints, osat_decimal, notes) VALUES
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '1 day', 0.87, 2.50, 1.25, 0.92, 'Good day overall, slight accuracy issues during lunch rush'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '2 days', 0.91, 1.80, 0.95, 0.94, 'Improvement in accuracy, training paying off'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '3 days', 0.89, 3.20, 2.10, 0.88, 'Busy Friday, some service delays during dinner'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '4 days', 0.93, 1.50, 0.80, 0.96, 'Excellent performance, team working well together'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '5 days', 0.85, 4.10, 1.75, 0.90, 'Weekend rush, need to focus on order accuracy'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '6 days', 0.88, 2.80, 1.45, 0.91, 'Steady performance throughout the day'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '7 days', 0.92, 1.90, 1.05, 0.95, 'Great week start, team motivated'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '8 days', 0.86, 3.50, 1.85, 0.89, 'Some challenges during shift change'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '9 days', 0.90, 2.20, 1.15, 0.93, 'Solid performance across all metrics'),
('550e8400-e29b-41d4-a716-446655440000', CURRENT_DATE - INTERVAL '10 days', 0.94, 1.40, 0.75, 0.97, 'Outstanding day, new training methods working');`,Cr=we("/setup")({component:Tr});function Ys(s){navigator.clipboard.writeText(s)}function Tr(){return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Project Setup"}),e.jsxs("ol",{className:"list-decimal ml-5 space-y-4 text-gray-700",children:[e.jsx("li",{children:"Supabase â†’ Auth â†’ Providers â†’ Email: enable. Then Auth â†’ Users â†’ Add user (auto-confirm)."}),e.jsx("li",{children:"Supabase â†’ SQL Editor: paste the schema SQL, run it. Then paste the seed SQL, run it."}),e.jsxs("li",{children:["In ",e.jsx("code",{children:".env.local"})," set URL, ANON KEY, set ",e.jsx("code",{children:"VITE_USE_MOCK_DATA=false"}),", restart dev server."]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-wendys-charcoal",children:"Schema SQL"}),e.jsx(I,{onClick:()=>Ys(Ks),className:"wendys-button",children:"Copy"})]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto max-h-80 text-xs",children:Ks})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-wendys-charcoal",children:"Seed SQL"}),e.jsx(I,{onClick:()=>Ys(Bs),className:"wendys-button",children:"Copy"})]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-auto max-h-80 text-xs",children:Bs})]})]})}const bs=Sa,_s=ka,rs=p.forwardRef(({className:s,children:a,...t},c)=>e.jsxs(St,{ref:c,className:P("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(_a,{asChild:!0,children:e.jsx(Ns,{className:"h-4 w-4 opacity-50"})})]}));rs.displayName=St.displayName;const Ht=p.forwardRef(({className:s,...a},t)=>e.jsx(kt,{ref:t,className:P("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Et,{className:"h-4 w-4"})}));Ht.displayName=kt.displayName;const Kt=p.forwardRef(({className:s,...a},t)=>e.jsx(Ct,{ref:t,className:P("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ns,{className:"h-4 w-4"})}));Kt.displayName=Ct.displayName;const ns=p.forwardRef(({className:s,children:a,position:t="popper",...c},r)=>e.jsx(Na,{children:e.jsxs(Tt,{ref:r,className:P("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...c,children:[e.jsx(Ht,{}),e.jsx(wa,{className:P("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(Kt,{})]})}));ns.displayName=Tt.displayName;const Rr=p.forwardRef(({className:s,...a},t)=>e.jsx(Rt,{ref:t,className:P("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a}));Rr.displayName=Rt.displayName;const xe=p.forwardRef(({className:s,children:a,...t},c)=>e.jsxs(Dt,{ref:c,className:P("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ja,{children:e.jsx(mt,{className:"h-4 w-4"})})}),e.jsx(Ea,{children:a})]}));xe.displayName=Dt.displayName;const Dr=p.forwardRef(({className:s,...a},t)=>e.jsx(At,{ref:t,className:P("-mx-1 my-1 h-px bg-muted",s),...a}));Dr.displayName=At.displayName;const Bt=[{value:"banner-video.mp4",label:"Banner Video (Original)"},{value:"banner-video (2).mp4",label:"Banner Video 2"},{value:"video-banner.mp4",label:"Video Banner"},{value:"dashboard-8_30_2025, 8_58 PM.mp4",label:"Dashboard Demo"}];function ks(){try{const s=localStorage.getItem("available-videos");if(s)return JSON.parse(s).map(r=>({...r,lastModified:r.lastModified?new Date(r.lastModified):void 0})).filter((r,h,d)=>h===d.findIndex(N=>N.value===r.value))}catch(s){console.error("Error loading videos from localStorage:",s)}return Bt}function Us(s){try{localStorage.setItem("available-videos",JSON.stringify(s))}catch(a){console.error("Error saving videos to localStorage:",a)}}function Ar(s){const a=ks(),t=a.findIndex(r=>r.value===s.value);let c;return t>=0?(c=[...a],c[t]=s):c=[...a,s],Us(c),c}function Lr(s){const t=ks().filter(c=>c.value!==s);return Us(t),t}function Ir(s){if(!s.type.startsWith("video/"))return{valid:!1,error:"Please select a video file"};if(s.size>50*1024*1024)return{valid:!1,error:"Video file must be less than 50MB"};const a=[".mp4",".webm",".avi",".mov",".mkv"],t=s.name.toLowerCase().substring(s.name.lastIndexOf("."));return a.includes(t)?{valid:!0}:{valid:!1,error:"Unsupported video format. Please use MP4, WebM, AVI, MOV, or MKV"}}function Mr(s){const a=["Bytes","KB","MB","GB"],t=Math.floor(Math.log(s)/Math.log(1024));return Math.round(s/Math.pow(1024,t)*100)/100+" "+a[t]}function Vr(s){return{value:s.name,label:s.name.replace(/\.[^/.]+$/,""),size:s.size,lastModified:new Date(s.lastModified),type:s.type}}function Gs(s){return new Promise(a=>{const t=document.createElement("video");t.onloadedmetadata=()=>{a({duration:t.duration,width:t.videoWidth,height:t.videoHeight})},t.onerror=()=>a(null),t.src=`/${s}`})}function Fr(){return localStorage.removeItem("available-videos"),Bt}function Or(){const s=ks();return Us(s),s}function Ur({selectedVideo:s,onVideoChange:a,onVideosUpdate:t}){const[c,r]=p.useState([]),[h,d]=p.useState(!1),[N,g]=p.useState(!1),[L,x]=p.useState(null),[n,f]=p.useState({}),M=p.useRef(null),{toast:E}=ge(),q=async()=>{try{const y=Or();r(y),t(y);const w={};for(const _ of y){const F=await Gs(_.value);F&&(w[_.value]=F)}f(w)}catch(y){console.error("Error loading videos:",y),E({title:"Error",description:"Failed to load video list",variant:"destructive"})}};p.useEffect(()=>{q()},[]);const D=async y=>{var F;const w=(F=y.target.files)==null?void 0:F[0];if(!w)return;const _=Ir(w);if(!_.valid){E({title:"Invalid File",description:_.error,variant:"destructive"});return}d(!0);try{const A=Vr(w),m=Ar(A);r(m),t(m);const o=await Gs(A.value);o&&f(R=>({...R,[A.value]:o})),E({title:"Success",description:`Video "${A.label}" added successfully. Note: In a production app, this would upload to a server.`}),M.current&&(M.current.value="")}catch(A){console.error("Error uploading video:",A),E({title:"Upload Failed",description:"Failed to add video file",variant:"destructive"})}finally{d(!1)}},u=y=>{if(y===s){E({title:"Cannot Delete",description:"Cannot delete the currently selected video",variant:"destructive"});return}const w=c.find(_=>_.value===y);if(w&&window.confirm(`Are you sure you want to delete "${w.label}"?`)){const _=Lr(y);r(_),t(_),f(F=>{const A={...F};return delete A[y],A}),E({title:"Deleted",description:`Video "${w.label}" has been removed`})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Banner Video"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>g(!N),className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Manage Videos"]}),e.jsxs(bs,{value:s,onValueChange:a,children:[e.jsx(rs,{className:"w-[200px]",children:e.jsx(_s,{placeholder:"Select video"})}),e.jsx(ns,{children:c.map(y=>e.jsx(xe,{value:y.value,children:y.label},y.value))})]})]})]}),N&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-wendys-charcoal",children:"Video Management"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{if(window.confirm("Reset all videos to defaults? This will remove any custom videos you've added.")){const y=Fr();r(y),t(y),E({title:"Reset Complete",description:"Videos have been reset to defaults"})}},className:"text-xs",children:"Reset to Defaults"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>g(!1),children:e.jsx(He,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Lt,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload a new video file"}),e.jsx("input",{ref:M,type:"file",accept:"video/*",onChange:D,className:"hidden",disabled:h}),e.jsxs(I,{variant:"outline",onClick:()=>{var y;return(y=M.current)==null?void 0:y.click()},disabled:h,className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4"}),h?"Uploading...":"Choose Video File"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported formats: MP4, WebM, AVI. Max size: 50MB"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium text-wendys-charcoal",children:"Available Videos"}),e.jsx("div",{className:"space-y-2",children:c.map(y=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ys,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:y.label}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("p",{children:[y.size?Mr(y.size):"Unknown size",y.lastModified&&` â€¢ ${y.lastModified.toLocaleDateString()}`]}),n[y.value]&&e.jsxs("p",{children:[n[y.value].width,"x",n[y.value].height," â€¢",Math.round(n[y.value].duration),"s"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>x(y.value),children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>u(y.value),disabled:y.value===s,className:"text-red-600 hover:text-red-700",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]},y.value))})]})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 max-w-4xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-wendys-charcoal",children:"Video Preview"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>x(null),children:e.jsx(He,{className:"h-4 w-4"})})]}),e.jsx("video",{src:`/${L}`,controls:!0,className:"w-full rounded-lg",style:{maxHeight:"60vh"},children:"Your browser does not support the video tag."})]})})]})}function Pr({onAuthenticated:s,onPasswordChange:a,currentPassword:t}){const[c,r]=p.useState(""),[h,d]=p.useState(!1),[N,g]=p.useState(!1),[L,x]=p.useState(""),[n,f]=p.useState(""),[M,E]=p.useState(!1),[q,D]=p.useState(!1),[u,y]=p.useState(""),{toast:w}=ge(),_=()=>{c===t?(y(""),s(),w({title:"Access Granted",description:"Successfully authenticated to settings."})):y("Incorrect password. Please try again.")},F=()=>{if(L!==n){y("New passwords do not match.");return}if(L.length<4){y("Password must be at least 4 characters long.");return}a(L),x(""),f(""),g(!1),y(""),w({title:"Password Updated",description:"Settings password has been changed successfully."})},A=m=>{m.key==="Enter"&&(N?F():_())};return e.jsx("div",{className:"min-h-screen bg-wendys-gray flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-wendys-red/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ae,{className:"h-6 w-6 text-wendys-red"})}),e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:N?"Change Settings Password":"Settings Access"}),e.jsx("p",{className:"text-gray-600 mt-2",children:N?"Enter a new password to protect the settings page":"Enter the settings password to continue"})]}),N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"newPassword",className:"text-wendys-charcoal font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"newPassword",type:M?"text":"password",placeholder:"Enter new password",className:"pl-10 pr-10",value:L,onChange:m=>x(m.target.value),onKeyPress:A}),e.jsx("button",{type:"button",onClick:()=>E(!M),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:M?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"confirmPassword",className:"text-wendys-charcoal font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"confirmPassword",type:q?"text":"password",placeholder:"Confirm new password",className:"pl-10 pr-10",value:n,onChange:m=>f(m.target.value),onKeyPress:A}),e.jsx("button",{type:"button",onClick:()=>D(!q),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:q?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:u})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:F,className:"flex-1 wendys-button",disabled:!L.trim()||!n.trim(),children:"Update Password"}),e.jsx(I,{onClick:()=>{g(!1),y(""),x(""),f("")},variant:"outline",className:"flex-1",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"password",className:"text-wendys-charcoal font-medium",children:"Settings Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"password",type:h?"text":"password",placeholder:"Enter settings password",className:"pl-10 pr-10",value:c,onChange:m=>r(m.target.value),onKeyPress:A}),e.jsx("button",{type:"button",onClick:()=>d(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:u})]}),e.jsx(I,{onClick:_,className:"w-full wendys-button",disabled:!c.trim(),children:"Access Settings"}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>g(!0),className:"text-sm text-wendys-red hover:text-wendys-red/80 underline",children:"Change Password"})})]})]})})})}const zr=we("/settings")({component:qr});function qr(){var O;const[s,a]=p.useState("banner-video.mp4"),[t,c]=p.useState([]),[r,h]=p.useState(!1),[d,N]=p.useState(""),[g,L]=p.useState(!1),[x,n]=p.useState(""),[f,M]=p.useState(""),[E,q]=p.useState(!1),[D,u]=p.useState(!1),[y,w]=p.useState(""),{toast:_}=ge();p.useEffect(()=>{const v=localStorage.getItem("banner-video-selection");v&&a(v);const C=localStorage.getItem("settings-password");if(C)N(C);else{const K="admin123";N(K),localStorage.setItem("settings-password",K)}},[]);const F=v=>{a(v),localStorage.setItem("banner-video-selection",v)},A=v=>{if(c(v),!v.some(C=>C.value===s)&&v.length>0){const C=v[0].value;a(C),localStorage.setItem("banner-video-selection",C)}},m=()=>{h(!0)},o=v=>{N(v),localStorage.setItem("settings-password",v)},R=()=>{if(x!==f){w("Passwords do not match.");return}if(x.length<4){w("Password must be at least 4 characters long.");return}N(x),localStorage.setItem("settings-password",x),n(""),M(""),L(!1),w(""),_({title:"Password Updated",description:"Settings password has been changed successfully."})};return r?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"h-8 w-8 text-wendys-red"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure your dashboard preferences and appearance"})]})]}),e.jsx(I,{onClick:()=>h(!1),variant:"outline",className:"text-wendys-red border-wendys-red hover:bg-wendys-red hover:text-white",children:"Lock Settings"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ys,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h2",{className:"text-lg font-semibold text-wendys-charcoal",children:"Banner Video Settings"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Manage your banner videos for the overview page. Upload new videos, delete unwanted ones, and preview them before selecting."}),e.jsx(Ur,{selectedVideo:s,onVideoChange:F,onVideosUpdate:A})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ca,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Current Video"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Selected Video:"}),e.jsx("p",{className:"text-gray-600",children:((O=t.find(v=>v.value===s))==null?void 0:O.label)||s})]}),e.jsx("div",{className:"rounded-lg overflow-hidden",children:e.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-32 object-cover",children:[e.jsx("source",{src:`/${s}`,type:"video/mp4"}),e.jsx("p",{children:"Your browser does not support the video tag."})]},s)})]})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(zs,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Quick Actions"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium mb-2",children:"Video Management:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"â€¢ Upload new videos (MP4, WebM, AVI, MOV, MKV)"}),e.jsx("li",{children:"â€¢ Preview videos before selecting"}),e.jsx("li",{children:"â€¢ Delete unwanted videos"}),e.jsx("li",{children:"â€¢ Reset to default videos"})]})]})})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(qs,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"System Info"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Videos:"}),e.jsx("span",{className:"font-medium",children:t.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Selected Video:"}),e.jsx("span",{className:"font-medium text-xs truncate max-w-32",children:s})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Storage:"}),e.jsx("span",{className:"font-medium",children:"Local"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ae,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Password Management"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Change the password required to access the settings page."}),g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"newPassword",className:"text-wendys-charcoal font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"newPassword",type:E?"text":"password",placeholder:"Enter new password",className:"pl-10 pr-10",value:x,onChange:v=>n(v.target.value)}),e.jsx("button",{type:"button",onClick:()=>q(!E),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:E?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"confirmPassword",className:"text-wendys-charcoal font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx($,{id:"confirmPassword",type:D?"text":"password",placeholder:"Confirm new password",className:"pl-10 pr-10",value:f,onChange:v=>M(v.target.value)}),e.jsx("button",{type:"button",onClick:()=>u(!D),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:D?e.jsx($e,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"})})]})]}),y&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:y})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:R,className:"flex-1 wendys-button",disabled:!x.trim()||!f.trim(),children:"Update Password"}),e.jsx(I,{onClick:()=>{L(!1),w(""),n(""),M("")},variant:"outline",className:"flex-1",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"â€¢ Current password is set and active"}),e.jsx("p",{children:"â€¢ Password protects access to all settings"}),e.jsx("p",{children:"â€¢ Click below to change the password"})]}),e.jsx(I,{onClick:()=>L(!0),className:"wendys-button",children:"Change Password"})]})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(zs,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Appearance"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Customize the look and feel of your dashboard."}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"â€¢ Theme customization (coming soon)"}),e.jsx("p",{children:"â€¢ Color scheme options (coming soon)"}),e.jsx("p",{children:"â€¢ Layout preferences (coming soon)"})]})})]})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(qs,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Data Management"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Manage your data and storage preferences."}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"â€¢ Data export options (coming soon)"}),e.jsx("p",{children:"â€¢ Backup and restore (coming soon)"}),e.jsx("p",{children:"â€¢ Cache management (coming soon)"})]})})]})]}):e.jsx(Pr,{onAuthenticated:m,onPasswordChange:o,currentPassword:d})}function Wr({data:s=[]}){const a=p.useMemo(()=>{if(!s.length){const t=[];for(let c=13;c>=0;c--){const r=new Date;r.setDate(r.getDate()-c),t.push({date:re.dateShort(r.toISOString().slice(0,10)),sales:0})}return t}return s.sort((t,c)=>new Date(t.business_date).getTime()-new Date(c.business_date).getTime()).slice(-30).map(t=>({date:re.dateShort(t.business_date),sales:t.net_sales||0}))},[s]);return e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(ze,{data:a,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:t=>re.currencyCompact(t)}),e.jsx(Ve,{...ee.tooltip,formatter:t=>[re.currencyDetailed(t),"Net Sales"]}),e.jsx(Re,{type:"monotone",dataKey:"sales",stroke:X.sales,strokeWidth:3,dot:{fill:X.sales,strokeWidth:2,r:4},activeDot:{r:6,stroke:X.salesSecondary,strokeWidth:2}})]})})}function $r({data:s=[]}){console.log("ðŸ” LaborVsIdealChart received data:",s.slice(0,3));const a=p.useMemo(()=>{if(!s.length){const c=[];for(let r=6;r>=0;r--){const h=new Date;h.setDate(h.getDate()-r),c.push({date:re.dateShort(h.toISOString().slice(0,10)),ideal:0,actual:0})}return c}const t=s.sort((c,r)=>new Date(c.business_date).getTime()-new Date(r.business_date).getTime()).slice(-30).map(c=>{const r=Number(c.ideal_labor_hours)||0,h=Number(c.labor_hours)||0;return console.log("ðŸ” Processing entry:",c.business_date,"ideal:",c.ideal_labor_hours,"=>",r,"actual:",c.labor_hours,"=>",h),{date:re.dateShort(c.business_date),ideal:r,actual:h}});return console.log("ðŸ” Processed chart data:",t.slice(0,3)),t},[s]);return console.log("ðŸ” Final chartData being rendered:",a.slice(0,3)),e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(It,{data:a,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:t=>re.hours(t)}),e.jsx(Ve,{...ee.tooltip,formatter:(t,c)=>[re.hours(t),c==="ideal"?"Ideal Hours":"Actual Hours"]}),e.jsx(jt,{...ee.legend}),e.jsx(Mt,{dataKey:"ideal",fill:X.laborIdeal,opacity:.6,name:"Ideal Hours"}),e.jsx(Re,{type:"monotone",dataKey:"actual",stroke:X.labor,strokeWidth:3,dot:{fill:X.labor,strokeWidth:2,r:4},activeDot:{r:6,stroke:X.textPrimary,strokeWidth:2},name:"Actual Hours"})]})})}function Hr(){const[s,a]=p.useState(null);p.useEffect(()=>{let x=!0;return(async()=>{var f;const{data:n}=await V.from("users").select("store_id").eq("id",(f=(await V.auth.getUser()).data.user)==null?void 0:f.id).single();x&&a((n==null?void 0:n.store_id)??null)})(),()=>{x=!1}},[]);const{data:t=[],isLoading:c}=ne({queryKey:["smg_snapshot",s],queryFn:async()=>{if(!s)return[];const x=new Date;x.setDate(x.getDate()-30);const{data:n,error:f}=await V.from("smg_daily").select("*").eq("store_id",s).gte("date",x.toISOString().split("T")[0]).order("date",{ascending:!1});if(f)throw f;return n||[]},enabled:!!s}),r=t.length>0?{accuracy:t.reduce((x,n)=>x+n.accuracy_decimal,0)/t.length,zod:t.reduce((x,n)=>x+n.zod_per_10k,0)/t.length,complaints:t.reduce((x,n)=>x+n.cc_complaints,0)/t.length,osat:t.reduce((x,n)=>x+n.osat_decimal,0)/t.length}:{accuracy:0,zod:0,complaints:0,osat:0},h=x=>{if(x.length<4)return"neutral";const n=Math.floor(x.length/2),f=x.slice(0,n).reduce((q,D)=>q+D,0)/n,E=x.slice(n).reduce((q,D)=>q+D,0)/(x.length-n)-f;return Math.abs(E)<.1?"neutral":E>0?"up":"down"},d={accuracy:h(t.map(x=>x.accuracy_decimal).reverse()),zod:h(t.map(x=>x.zod_per_10k).reverse()),complaints:h(t.map(x=>x.cc_complaints).reverse()),osat:h(t.map(x=>x.osat_decimal).reverse())},N=(x,n=!1)=>n?x<=1?"text-green-600":x<=3?"text-yellow-600":"text-red-600":x>=90?"text-green-600":x>=80?"text-yellow-600":"text-red-600",g=(x,n=!1)=>n?x<=1?e.jsx(es,{className:"h-4 w-4 text-green-600"}):x<=3?e.jsx(je,{className:"h-4 w-4 text-yellow-600"}):e.jsx(je,{className:"h-4 w-4 text-red-600"}):x>=90?e.jsx(es,{className:"h-4 w-4 text-green-600"}):x>=80?e.jsx(je,{className:"h-4 w-4 text-yellow-600"}):e.jsx(je,{className:"h-4 w-4 text-red-600"}),L=x=>{switch(x){case"up":return e.jsx(ce,{className:"h-3 w-3 text-green-600"});case"down":return e.jsx(_e,{className:"h-3 w-3 text-red-600"});default:return null}};return c?e.jsx("div",{className:"wendys-card",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4"}),e.jsx("div",{className:"space-y-4",children:[...Array(4)].map((x,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32 mt-1"})]})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-12"})]},n))})]})}):e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"OSAT Snapshot (Last 30 Days)"}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(Pe,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{children:[t.length," entries"]})]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Pe,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"font-medium",children:"No OSAT data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in the OSAT tab to see metrics"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Pe,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"OSAT Score"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overall satisfaction"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[L(d.osat),g(r.osat),e.jsx("span",{className:P("text-xl font-bold",N(r.osat)),children:(r.osat??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(es,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"Accuracy of Order"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Order accuracy metric"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[L(d.accuracy),g(r.accuracy),e.jsx("span",{className:P("text-xl font-bold",N(r.accuracy)),children:(r.accuracy??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(je,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"ZOD per 10k"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zone of defection"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[L(d.zod==="up"?"down":d.zod==="down"?"up":"neutral"),g(r.zod,!0),e.jsx("span",{className:P("text-xl font-bold",N(r.zod,!0)),children:(r.zod??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(je,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-wendys-charcoal",children:"CC Complaints"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Customer complaints"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[L(d.complaints==="up"?"down":d.complaints==="down"?"up":"neutral"),g(r.complaints,!0),e.jsx("span",{className:P("text-xl font-bold",N(r.complaints,!0)),children:(r.complaints??0).toFixed(1)})]})]})]})]})}function Kr(){const[s,a]=p.useState(null),t=H(new Date,"EEEE, MMMM d"),c=H(new Date,"yyyy-MM-dd");p.useEffect(()=>{let N=!0;return(async()=>{var M;console.log("ðŸ” [InterviewsToday] Checking user authentication...");const{data:g,error:L}=await V.auth.getUser();console.log("ðŸ‘¤ [InterviewsToday] Auth data:",g,"Auth error:",L);const x=(M=g.user)==null?void 0:M.id;if(!x){console.log("âŒ [InterviewsToday] No user ID found - user not authenticated");return}console.log("ðŸ” [InterviewsToday] Looking up store for user:",x);const{data:n,error:f}=await V.from("users").select("store_id").eq("id",x).maybeSingle();if(console.log("ðŸª [InterviewsToday] Store lookup result - data:",n,"error:",f),!!N){if(f){console.error("âŒ [InterviewsToday] Store lookup error:",f);return}a((n==null?void 0:n.store_id)??null),console.log("âœ… [InterviewsToday] Store ID set to:",(n==null?void 0:n.store_id)??null)}})(),()=>{N=!1}},[]);const{data:r=[],isLoading:h}=ne({queryKey:["interviews-today",s,c],queryFn:async()=>{if(!s)return[];const{data:N,error:g}=await V.from("interviews").select("*").eq("store_id",s).eq("interview_date",c).order("interview_time",{ascending:!0});if(g)throw g;return N||[]},enabled:!!s}),d=N=>H(new Date(`2000-01-01T${N}`),"h:mm a");return e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Interviews Today"}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:t})]})]}),h?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):r.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ft,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No interviews scheduled for today"})]}):e.jsx("div",{className:"space-y-3",children:r.map(N=>e.jsx(Ls,{to:"/interviews",className:"block p-4 border border-gray-200 rounded-lg hover:border-wendys-red hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-wendys-charcoal",children:N.candidate_name}),e.jsx("span",{className:Br("px-2 py-1 text-xs font-medium rounded-full",Vt(N.status)),children:N.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Os,{className:"h-3 w-3"}),e.jsx("span",{children:N.position})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),e.jsx("span",{children:d(N.interview_time)})]})]}),N.notes&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 italic",children:['"',N.notes,'"']})]})})},N.id))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs(Ls,{to:"/interviews",className:"inline-flex items-center space-x-2 text-wendys-red hover:text-wendys-dark-red font-medium text-sm",children:[e.jsx("span",{children:"View all interviews"}),e.jsx("span",{children:"â†’"})]})})]})}function Br(...s){return s.filter(Boolean).join(" ")}const Yr=we("/overview")({component:Gr});function Gr(){const[s,a]=p.useState(null),[t,c]=p.useState("banner-video.mp4"),[r,h]=p.useState([]),d=Ss("overview","today");p.useEffect(()=>{const _=ks();h(_);const F=localStorage.getItem("banner-video-selection");F&&_.some(A=>A.value===F)?c(F):_.length>0&&c(_[0].value)},[]);const N=_=>{c(_),localStorage.setItem("banner-video-selection",_)};p.useEffect(()=>{let _=!0;return(async()=>{var R;const{data:F}=await V.auth.getUser(),A=(R=F.user)==null?void 0:R.id;if(!A)return;const{data:m,error:o}=await V.from("users").select("store_id").eq("id",A).maybeSingle();if(_){if(o){console.error("Error fetching store ID:",o);return}a((m==null?void 0:m.store_id)??null)}})(),()=>{_=!1}},[]);const g=d.getDateRangeFilter(),{data:L=[]}=ne({queryKey:["overview-charts",s],queryFn:async()=>{if(!s)return[];const _=new Date;_.setDate(_.getDate()-30);const F=_.toISOString().slice(0,10),{data:A,error:m}=await V.from("omega_daily").select("*").eq("store_id",s).gte("business_date",F).order("business_date",{ascending:!0});if(m)throw m;return A||[]},enabled:!!s}),{data:x=[],isLoading:n,error:f}=ne({queryKey:["overview-omega",s,g==null?void 0:g.start,g==null?void 0:g.end],queryFn:async()=>{if(!s)return[];let _=V.from("omega_daily").select("*").eq("store_id",s);g&&(_=_.gte("business_date",g.start).lte("business_date",g.end));const{data:F,error:A}=await _.order("business_date",{ascending:!0});if(A)throw A;return F||[]},enabled:!!s}),{data:M=[]}=ne({queryKey:["overview-weekending",s,g==null?void 0:g.start,g==null?void 0:g.end],queryFn:async()=>{if(!s)return[];console.log("ðŸ“Š Fetching overview weekending data with filters:",{storeId:s,dateRangeFilter:g,queryKey:["overview-weekending",s,g==null?void 0:g.start,g==null?void 0:g.end]}),console.log("ðŸ“Š Date range details:",{start:g==null?void 0:g.start,end:g==null?void 0:g.end,hasFilter:!!g});let _=V.from("weekending_sheet").select("*").eq("store_id",s);g&&(_=_.gte("week_ending_date",g.start).lte("week_ending_date",g.end));const{data:F,error:A}=await _.order("week_ending_date",{ascending:!0});if(A)throw A;return console.log("ðŸ“Š Overview weekending data fetched:",(F==null?void 0:F.length)||0,"entries"),F||[]},enabled:!!s}),{data:E=[]}=ne({queryKey:["overview-weekending-charts",s],queryFn:async()=>{if(!s)return[];const _=new Date;_.setDate(_.getDate()-84);const F=_.toISOString().slice(0,10);console.log("ðŸ“ˆ Fetching overview weekending chart data:",{storeId:s,startDate:F,queryKey:["overview-weekending-charts",s]});const{data:A,error:m}=await V.from("weekending_sheet").select("*").eq("store_id",s).gte("week_ending_date",F).order("week_ending_date",{ascending:!0});if(m)throw m;return console.log("ðŸ“ˆ Overview weekending chart data fetched:",(A==null?void 0:A.length)||0,"entries"),A||[]},enabled:!!s}),{data:q=[]}=ne({queryKey:["overview-soft-inventory",s,g==null?void 0:g.start,g==null?void 0:g.end],queryFn:async()=>{if(!s)return[];let _=V.from("soft_inventory_variance").select("*").eq("store_id",s);g&&(_=_.gte("business_date",g.start).lte("business_date",g.end));const{data:F,error:A}=await _.order("business_date",{ascending:!0});if(A)throw A;return F||[]},enabled:!!s}),{data:D=[]}=ne({queryKey:["overview-soft-inventory-charts",s],queryFn:async()=>{if(!s)return[];const _=new Date;_.setDate(_.getDate()-30);const F=_.toISOString().slice(0,10),{data:A,error:m}=await V.from("soft_inventory_variance").select("*").eq("store_id",s).gte("business_date",F).order("business_date",{ascending:!0});if(m)throw m;return A||[]},enabled:!!s}),u=p.useMemo(()=>{if(x.length===0)return{netSales:0,compNetSales:0,laborHours:0,idealLaborHours:0,laborPercentage:0,foodVarianceCost:0,foodVariancePercentage:0,wasteAmount:0,wastePercentage:0,breakfastSales:0,nightSales:0};const _=x.reduce((o,R)=>({netSales:o.netSales+(R.net_sales||0),compNetSales:o.compNetSales+((R.net_sales||0)-(R.last_year_sales||0)),laborHours:o.laborHours+(R.labor_hours||0),idealLaborHours:o.idealLaborHours+(R.ideal_labor_hours||0),foodVarianceCost:o.foodVarianceCost+(R.food_variance_cost||0),wasteAmount:o.wasteAmount+(R.waste_amount||0),breakfastSales:o.breakfastSales+(R.breakfast_sales||0),nightSales:o.nightSales+(R.night_sales||0)}),{netSales:0,compNetSales:0,laborHours:0,idealLaborHours:0,foodVarianceCost:0,wasteAmount:0,breakfastSales:0,nightSales:0}),F=_.netSales>0?_.laborHours/_.netSales*100:0,A=_.netSales>0?_.foodVarianceCost/_.netSales*100:0,m=_.netSales>0?_.wasteAmount/_.netSales*100:0;return{..._,laborPercentage:F,foodVariancePercentage:A,wastePercentage:m}},[x]),y=p.useMemo(()=>{if(M.length===0)return{weeklyNetSales:0,weeklyLabor:0,weeklyFoodVariance:0,weeklyBreakfastSales:0,weeklyLateNightSales:0,weeklyOnboarding:0,weeklyCrewQuiz:0,weeklyMgrQuiz:0,weeklyNewHires:0,weeklyTerminations:0};const _=M.reduce((o,R)=>({weeklyNetSales:o.weeklyNetSales+(R.net_sales||0),weeklyLabor:o.weeklyLabor+(R.labor||0),weeklyFoodVariance:o.weeklyFoodVariance+(R.food_variance_percentage||0),weeklyBreakfastSales:o.weeklyBreakfastSales+(R.breakfast_sales||0),weeklyLateNightSales:o.weeklyLateNightSales+(R.late_night_sales||0),weeklyOnboarding:o.weeklyOnboarding+(R.onboarding?1:0),weeklyCrewQuiz:o.weeklyCrewQuiz+(R.crew_food_safety_quiz||0),weeklyMgrQuiz:o.weeklyMgrQuiz+(R.mgr_food_safety_quiz||0),weeklyNewHires:o.weeklyNewHires+(R.new_hire_name?1:0),weeklyTerminations:o.weeklyTerminations+(R.terminations?1:0)}),{weeklyNetSales:0,weeklyLabor:0,weeklyFoodVariance:0,weeklyBreakfastSales:0,weeklyLateNightSales:0,weeklyOnboarding:0,weeklyCrewQuiz:0,weeklyMgrQuiz:0,weeklyNewHires:0,weeklyTerminations:0}),F=M.length>0?_.weeklyCrewQuiz/M.length:0,A=M.length>0?_.weeklyMgrQuiz/M.length:0,m=M.length>0?_.weeklyFoodVariance/M.length:0;return{..._,avgCrewQuiz:F,avgMgrQuiz:A,avgFoodVariance:m}},[M]),w=p.useMemo(()=>{if(q.length===0)return{totalEntries:0,averageVariance:0,positiveVariance:0,negativeVariance:0,bestVariance:0,worstVariance:0};const _=["bacon_variance","beef_4oz_variance","beef_small_variance","chicken_breaded_variance","chicken_diced_variance","chicken_nuggets_variance","chicken_nuggets_spicy_variance","chicken_patty_3_1_variance","chicken_breaded_spicy_variance","chicken_strips_variance","sausage_patty_variance"],F=q.flatMap(o=>_.map(R=>o[R])),A=F.filter(o=>o>0),m=F.filter(o=>o<0);return{totalEntries:q.length,averageVariance:F.reduce((o,R)=>o+R,0)/F.length,positiveVariance:A.length,negativeVariance:m.length,bestVariance:Math.max(...F),worstVariance:Math.min(...F)}},[q]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Overview"}),e.jsxs("p",{className:"text-gray-600",children:["Key metrics and performance indicators for ",d.getSelectedLabel(),n&&e.jsx("span",{className:"ml-2 text-sm",children:"(Loading...)"})]}),f&&e.jsxs("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:["Error loading data: ",f.message]})]}),e.jsx(Es,{selectedRange:d.selectedRange,selectedDate:d.selectedDate,onRangeChange:d.handleRangeChange,onDateChange:d.handleDateChange,onClearFilters:d.clearFilters,compact:!0})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-5 w-5 text-wendys-red"}),e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:"Banner Video"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(bs,{value:t,onValueChange:N,children:[e.jsx(rs,{className:"w-[200px]",children:e.jsx(_s,{placeholder:"Select video"})}),e.jsx(ns,{children:r.map(_=>e.jsx(xe,{value:_.value,children:_.label},_.value))})]}),e.jsxs("a",{href:"/settings",className:"flex items-center gap-1 text-sm text-gray-600 hover:text-wendys-red transition-colors",title:"Manage videos in Settings",children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Manage"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full rounded-lg shadow-lg opacity-60",style:{height:"200px",objectFit:"cover",width:"100%",pointerEvents:"none"},children:[e.jsx("source",{src:`/${t}`,type:"video/mp4"}),e.jsx("p",{children:"Your browser does not support the video tag."})]},t)})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Net Sales",value:u.netSales,format:"currency",delta:u.compNetSales,deltaLabel:"vs Last Year",icon:os,trend:u.compNetSales>=0?"up":"down"}),e.jsx(se,{title:"Labor Hours",value:u.laborHours,format:"number",delta:u.laborHours-u.idealLaborHours,deltaLabel:"vs Ideal",icon:Ke,trend:u.laborHours>u.idealLaborHours?"down":"up",suffix:"hrs"}),e.jsx(se,{title:"Labor %",value:u.laborPercentage,format:"percentage",icon:ce,trend:"neutral"}),e.jsx(se,{title:"Food Variance",value:u.foodVarianceCost,format:"currency",delta:u.foodVariancePercentage,deltaLabel:"% of Sales",icon:_e,trend:u.foodVarianceCost>=0?"down":"up"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Waste Amount",value:u.wasteAmount,format:"currency",delta:u.wastePercentage,deltaLabel:"% of Sales",icon:_e,trend:u.wasteAmount>=0?"down":"up"}),e.jsx(se,{title:"Breakfast Sales",value:u.breakfastSales,format:"currency",icon:os,trend:"neutral"}),e.jsx(se,{title:"Night Sales",value:u.nightSales,format:"currency",icon:os,trend:"neutral"}),e.jsx(se,{title:"Comp Net Sales",value:u.compNetSales,format:"currency",icon:ce,trend:u.compNetSales>=0?"up":"down"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Weekly Net Sales",value:y.weeklyNetSales,format:"currency",icon:os,trend:"neutral"}),e.jsx(se,{title:"Weekly Labor",value:y.weeklyLabor,format:"currency",icon:Ke,trend:"neutral"}),e.jsx(se,{title:"Avg Food Variance %",value:y.avgFoodVariance,format:"percentage",icon:_e,trend:y.avgFoodVariance>=0?"down":"up"}),e.jsx(se,{title:"Weekly Onboarding",value:y.weeklyOnboarding,format:"number",icon:ce,trend:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Avg Crew Quiz Score",value:y.avgCrewQuiz,format:"number",icon:ce,trend:"neutral",suffix:"/100"}),e.jsx(se,{title:"Avg MGR Quiz Score",value:y.avgMgrQuiz,format:"number",icon:ce,trend:"neutral",suffix:"/100"}),e.jsx(se,{title:"Weekly New Hires",value:y.weeklyNewHires,format:"number",icon:ce,trend:"neutral"}),e.jsx(se,{title:"Weekly Terminations",value:y.weeklyTerminations,format:"number",icon:_e,trend:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsx(se,{title:"Soft Inventory Entries",value:w.totalEntries,format:"number",icon:fs,trend:"neutral"}),e.jsx(se,{title:"Avg Variance %",value:w.averageVariance,format:"percentage",icon:ce,trend:w.averageVariance>=0?"up":"down"}),e.jsx(se,{title:"Positive Variance Days",value:w.positiveVariance,format:"number",icon:ce,trend:"neutral",suffix:"days"}),e.jsx(se,{title:"Negative Variance Days",value:w.negativeVariance,format:"number",icon:_e,trend:"neutral",suffix:"days"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(ve,{title:"Net Sales Trend",subtitle:"Last 30 days",loading:!L.length&&!f,error:f==null?void 0:f.message,children:L.length>0?e.jsx(Wr,{data:L}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in OMEGA Daily to see trends"})]})})}),e.jsx(ve,{title:"Labor Hours vs Ideal",subtitle:"Last 30 days",loading:!L.length&&!f,error:f==null?void 0:f.message,children:L.length>0?e.jsx($r,{data:L}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in OMEGA Daily to see trends"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(ve,{title:"Weekly Net Sales Trend",subtitle:"Last 12 weeks",loading:!E.length&&!f,error:f==null?void 0:f.message,children:E.length>0?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-medium text-wendys-charcoal",children:pe(y.weeklyNetSales)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Weekly Sales"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[E.length," weeks of data"]})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No weekly data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in Weekending Sheet to see trends"})]})})}),e.jsx(ve,{title:"Weekly Training Metrics",subtitle:"Last 12 weeks",loading:!E.length&&!f,error:f==null?void 0:f.message,children:E.length>0?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-medium text-wendys-charcoal",children:[(y.avgCrewQuiz??0).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Crew Quiz"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-medium text-wendys-charcoal",children:[(y.avgMgrQuiz??0).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg MGR Quiz"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-wendys-charcoal",children:y.weeklyOnboarding}),e.jsx("p",{className:"text-sm text-gray-600",children:"Onboarding"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-wendys-charcoal",children:y.weeklyNewHires}),e.jsx("p",{className:"text-sm text-gray-600",children:"New Hires"})]})]})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No training data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in Weekending Sheet to see metrics"})]})})})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4",children:"Data Integration Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Daily Entries"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:x.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"OMEGA Daily records"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Weekly Entries"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:M.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Weekending records"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Soft Inventory"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:q.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Variance entries"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sales"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:pe(u.netSales+y.weeklyNetSales)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Combined daily + weekly"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Data Coverage"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:x.length>0||M.length>0||q.length>0?"Active":"No Data"}),e.jsx("p",{className:"text-xs text-gray-500",children:"System status"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(ve,{title:"Soft Inventory Variance Trend",subtitle:"Last 30 days",loading:!D.length&&!f,error:f==null?void 0:f.message,children:D.length>0?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.positiveVariance}),e.jsx("p",{className:"text-sm text-green-600",children:"Positive Variances"})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:w.negativeVariance}),e.jsx("p",{className:"text-sm text-red-600",children:"Negative Variances"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:D.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Entries"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[w.averageVariance.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"Average"})]})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No soft inventory data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in Soft Inventory Analysis to see trends"})]})})}),e.jsx(ve,{title:"Soft Inventory Performance",subtitle:"Variance distribution",loading:!D.length&&!f,error:f==null?void 0:f.message,children:D.length>0?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-green-100 rounded-lg",children:[e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[w.bestVariance.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-green-600",children:"Best Variance"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-red-50 to-red-100 rounded-lg",children:[e.jsxs("p",{className:"text-3xl font-bold text-red-600",children:[w.worstVariance.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Worst Variance"})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[D.length," entries tracked"]})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No soft inventory data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add entries in Soft Inventory Analysis to see performance"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Hr,{}),e.jsx(Kr,{})]})]})}function Qr({columns:s,data:a,mobileCardRender:t,className:c,emptyMessage:r="No data available",loading:h=!1}){if(h)return e.jsx(Jr,{columns:s});const d=N=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-2",children:s.map(g=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[g.label,":"]}),e.jsx("span",{className:"text-sm",children:g.render?g.render(N[g.key],N):N[g.key]})]},g.key))});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:P("hidden md:block",c),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200",children:s.map(N=>e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 text-sm",children:N.label},N.key))})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,className:"py-8 px-4 text-center text-gray-500",children:r})}):a.map((N,g)=>e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:s.map(L=>e.jsx("td",{className:P("py-3 px-4 text-sm",L.className),children:L.render?L.render(N[L.key],N):N[L.key]},L.key))},N.id||g))})]})})}),e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:r}):a.map((N,g)=>e.jsx("div",{children:t?t(N):d(N)},N.id||g))})})]})}function Jr({columns:s}){return e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200",children:s.map(a=>e.jsx("th",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})},a.key))})}),e.jsx("tbody",{children:[...Array(3)].map((a,t)=>e.jsx("tr",{className:"border-b border-gray-100",children:s.map(c=>e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"h-4 bg-gray-100 rounded w-full"})},c.key))},t))})]})})})}const Xr=we("/omega-daily")({component:Zr});function Zr(){const[s,a]=p.useState(!1),[t,c]=p.useState(null),{toast:r}=ge(),h=qe(),[d,N]=p.useState(null),g=Ss("omega-daily","last30"),L=async()=>{if(!d){r({title:"Store not linked",description:"Please link your account to a store first.",variant:"destructive"});return}try{const i=[],S=new Date;for(let j=9;j>=0;j--){const z=new Date(S);z.setDate(z.getDate()-j),i.push({store_id:d,business_date:H(z,"yyyy-MM-dd"),net_sales:Math.floor(Math.random()*5e3)+8e3,last_year_sales:Math.floor(Math.random()*4e3)+7e3,labor_hours:Math.floor(Math.random()*40)+60,ideal_labor_hours:Math.floor(Math.random()*30)+50,labor_percentage:Math.floor(Math.random()*10)+15,theoretical_food_cost:Math.floor(Math.random()*2e3)+3e3,food_variance_cost:Math.floor(Math.random()*200)-100,waste_amount:Math.floor(Math.random()*100)+50,breakfast_sales:Math.floor(Math.random()*1e3)+500,night_sales:Math.floor(Math.random()*1500)+1e3})}const{error:l}=await V.from("omega_daily").insert(i);if(l)throw l;r({title:"Sample data added!",description:"10 days of sample OMEGA entries have been created."}),h.invalidateQueries({queryKey:["omega_daily"]})}catch(i){r({title:"Error adding sample data",description:i.message,variant:"destructive"})}},x=()=>{h.invalidateQueries({queryKey:["omega_daily",d]}),h.invalidateQueries({queryKey:["omega_daily_charts",d]}),r({title:"Refreshing data...",description:"Reloading your OMEGA entries and charts."})},n=Be({resolver:Ye(mr),defaultValues:{business_date:H(new Date,"yyyy-MM-dd"),net_sales:0,last_year_sales:0,labor_hours:0,ideal_labor_hours:0,labor_percentage:0,theoretical_food_cost:0,food_variance_cost:0,waste_amount:0,breakfast_sales:0,night_sales:0}}),f=me({onMutate:async i=>{if(!d)throw new Error("No store is linked to your account. See Setup to link one.");await h.cancelQueries({queryKey:["omega_daily"]});const S=`temp-${Date.now()}`,l={id:S,store_id:d,business_date:i.business_date,net_sales:i.net_sales,last_year_sales:i.last_year_sales,labor_hours:i.labor_hours,ideal_labor_hours:i.ideal_labor_hours,labor_percentage:i.labor_percentage,theoretical_food_cost:i.theoretical_food_cost,food_variance_cost:i.food_variance_cost,waste_amount:i.waste_amount,breakfast_sales:i.breakfast_sales,night_sales:i.night_sales},j=[],z=h.getQueriesData({queryKey:["omega_daily"]});for(const[Q,ae]of z){const B=Q;if(!B.includes(d))continue;let b=!0;const T=typeof B[2]=="string"?String(B[2]):void 0,k=typeof B[3]=="string"?String(B[3]):void 0;if(T&&k&&(b=i.business_date>=T&&i.business_date<=k),!b)continue;const W=[l,...ae||[]];W.sort((Y,le)=>Y.business_date>le.business_date?-1:Y.business_date<le.business_date?1:0),j.push({queryKey:Q,previousData:ae}),h.setQueryData(Q,W)}return{optimisticId:S,touchedCaches:j}},mutationFn:async i=>{if(console.log("ðŸ”„ Starting insertMutation with payload:",i),console.log("ðŸª Store ID:",d),!d)throw console.error("âŒ No store ID found"),new Error("No store is linked to your account. See Setup to link one.");const S={store_id:d,business_date:i.business_date,net_sales:i.net_sales,last_year_sales:i.last_year_sales,labor_hours:i.labor_hours,ideal_labor_hours:i.ideal_labor_hours,labor_percentage:i.labor_percentage,theoretical_food_cost:i.theoretical_food_cost,food_variance_cost:i.food_variance_cost,waste_amount:i.waste_amount,breakfast_sales:i.breakfast_sales,night_sales:i.night_sales};console.log("ðŸ“¤ Inserting data:",S);const{data:l,error:j}=await V.from("omega_daily").insert(S).select();if(console.log("ðŸ“¥ Supabase response - data:",l,"error:",j),j)throw console.error("âŒ Supabase error:",j),j;return console.log("âœ… Insert successful:",l),l},onError:(i,S,l)=>{if(l!=null&&l.touchedCaches)for(const{queryKey:j,previousData:z}of l.touchedCaches)h.setQueryData(j,z||[]);console.error("ðŸ’¥ Insert mutation failed (rolled back):",i),r({title:"Save failed",description:(i==null?void 0:i.message)||"Unable to save entry.",variant:"destructive"})},onSuccess:(i,S,l)=>{console.log("ðŸŽ‰ Insert mutation succeeded with data:",i),r({title:"Success!",description:"Daily metrics saved successfully."});const j=Array.isArray(i)&&i[0]?i[0]:void 0;if(j&&(l!=null&&l.touchedCaches)&&l.optimisticId)for(const{queryKey:z}of l.touchedCaches){const ae=(h.getQueryData(z)??[]).map(B=>B.id===l.optimisticId?j:B);h.setQueryData(z,ae)}a(!1),c(null),n.reset(),h.invalidateQueries({queryKey:["omega_daily"]}),h.invalidateQueries({queryKey:["omega_daily_charts",d]})}}),M=me({mutationFn:async({id:i,payload:S})=>{if(!d)throw new Error("No store is linked to your account. See Setup to link one.");const{error:l}=await V.from("omega_daily").update({business_date:S.business_date,net_sales:S.net_sales,last_year_sales:S.last_year_sales,labor_hours:S.labor_hours,ideal_labor_hours:S.ideal_labor_hours,labor_percentage:S.labor_percentage,theoretical_food_cost:S.theoretical_food_cost,food_variance_cost:S.food_variance_cost,waste_amount:S.waste_amount,breakfast_sales:S.breakfast_sales,night_sales:S.night_sales}).eq("id",i);if(l)throw l},onSuccess:()=>{r({title:"Updated!",description:"Daily metrics updated successfully."}),a(!1),c(null),n.reset(),h.invalidateQueries({queryKey:["omega_daily"]}),h.invalidateQueries({queryKey:["omega_daily_charts",d]})},onError:i=>{r({title:"Update failed",description:i.message,variant:"destructive"})}}),E=i=>{console.log("ðŸš€ onSubmit called with data:",i),console.log("ðŸ“‹ Form errors:",n.formState.errors),console.log("ðŸª Store ID:",d),console.log("âœï¸ Editing entry:",t),console.log("ðŸ”„ Insert mutation pending:",f.isPending),console.log("ðŸ”„ Update mutation pending:",M.isPending),t?(console.log("ðŸ“ Calling updateMutation..."),M.mutate({id:t.id,payload:i})):(console.log("âž• Calling insertMutation..."),f.mutate(i))},q=i=>{console.error("âŒ Form validation failed with errors:",i),r({title:"Validation Error",description:"Please check the form for errors and try again.",variant:"destructive"})},D=me({mutationFn:async i=>{const{error:S}=await V.from("omega_daily").delete().eq("id",i);if(S)throw S},onSuccess:()=>{r({title:"Deleted",description:"Daily metrics entry removed."}),h.invalidateQueries({queryKey:["omega_daily"]}),h.invalidateQueries({queryKey:["omega_daily_charts",d]})},onError:i=>{r({title:"Delete failed",description:i.message,variant:"destructive"})}});p.useEffect(()=>{let i=!0;return(async()=>{var ae;console.log("ðŸ” Checking user authentication...");const{data:S,error:l}=await V.auth.getUser();console.log("ðŸ‘¤ Auth data:",S,"Auth error:",l);const j=(ae=S.user)==null?void 0:ae.id;if(!j){console.log("âŒ No user ID found - user not authenticated");return}console.log("ðŸ” Looking up store for user:",j);const{data:z,error:Q}=await V.from("users").select("store_id").eq("id",j).maybeSingle();if(console.log("ðŸª Store lookup result - data:",z,"error:",Q),!!i){if(Q){console.error("âŒ Store lookup error:",Q),r({title:"Connection Error",description:"Unable to connect to your store. Please check your setup.",variant:"destructive"});return}N((z==null?void 0:z.store_id)??null),console.log("âœ… Store ID set to:",(z==null?void 0:z.store_id)??null),z!=null&&z.store_id||(console.log("âš ï¸ No store linked to user account"),r({title:"Store Not Linked",description:"Your account isn't linked to a store yet. Please go to Setup to link your account.",variant:"destructive"}))}})(),()=>{i=!1}},[]);const u=g.getDateRangeFilter(),{data:y=[],isLoading:w,error:_}=ne({queryKey:["omega_daily",d,u==null?void 0:u.start,u==null?void 0:u.end],queryFn:async()=>{if(!d)return[];let i=V.from("omega_daily").select("*").eq("store_id",d);u&&(i=i.gte("business_date",u.start).lte("business_date",u.end));const{data:S,error:l}=await i.order("business_date",{ascending:!1}).limit(100);if(l)throw l;return S},enabled:!!d}),{data:F=[]}=ne({queryKey:["omega_daily_charts",d],queryFn:async()=>{if(!d)return[];const i=new Date;i.setDate(i.getDate()-30);const S=H(i,"yyyy-MM-dd"),{data:l,error:j}=await V.from("omega_daily").select("*").eq("store_id",d).gte("business_date",S).order("business_date",{ascending:!0});if(j)throw j;return l},enabled:!!d}),{data:A=[]}=ne({queryKey:["omega_daily_mtd",d],queryFn:async()=>{if(!d)return[];const{start:i,end:S}=Vs("mtd"),{data:l,error:j}=await V.from("omega_daily").select("*").eq("store_id",d).gte("business_date",i).lte("business_date",S).order("business_date",{ascending:!0});if(j)throw j;return l},enabled:!!d}),m=i=>{if(!i)return;g.handleRangeChange("custom");const S=Number(i.slice(0,4)),l=Number(i.slice(5,7)),j=Number(i.slice(8,10));g.handleDateChange(new Date(S,(l||1)-1,j||1))},o=p.useMemo(()=>F.length?F.map(i=>({date:re.dateShort(i.business_date),dateFull:re.dateFull(i.business_date),isoDate:(typeof i.business_date=="string",i.business_date),comp_net_sales_percentage:i.last_year_sales?(i.net_sales-i.last_year_sales)/i.last_year_sales*100:0})):[],[F]),R=p.useMemo(()=>F.length?F.map(i=>({date:re.dateShort(i.business_date),dateFull:re.dateFull(i.business_date),isoDate:(typeof i.business_date=="string",i.business_date),waste_percentage:i.net_sales?i.waste_amount/i.net_sales*100:0,food_variance_percentage:i.net_sales?-(i.food_variance_cost/i.net_sales)*100:0})):[],[F]),O=i=>{c(i);const S={business_date:i.business_date||H(new Date,"yyyy-MM-dd"),net_sales:i.net_sales!=null?Number(i.net_sales):0,last_year_sales:i.last_year_sales!=null?Number(i.last_year_sales):0,labor_hours:i.labor_hours!=null?Number(i.labor_hours):0,ideal_labor_hours:i.ideal_labor_hours!=null?Number(i.ideal_labor_hours):0,labor_percentage:i.labor_percentage!=null?Number(i.labor_percentage):0,theoretical_food_cost:i.theoretical_food_cost!=null?Number(i.theoretical_food_cost):0,food_variance_cost:i.food_variance_cost!=null?Number(i.food_variance_cost):0,waste_amount:i.waste_amount!=null?Number(i.waste_amount):0,breakfast_sales:i.breakfast_sales!=null?Number(i.breakfast_sales):0,night_sales:i.night_sales!=null?Number(i.night_sales):0};n.reset(S),a(!0)},v=i=>{D.mutate(i)},C=n.watch(),K=C.last_year_sales>0?(C.net_sales-C.last_year_sales)/C.last_year_sales*100:0,G=C.labor_hours-C.ideal_labor_hours,te=C.net_sales>0?C.food_variance_cost/C.net_sales*100:0,ie=C.net_sales>0?C.waste_amount/C.net_sales*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-wendys-charcoal",children:"Omega Daily"}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Daily business metrics and performance tracking"})]}),e.jsxs("div",{className:"flex flex-col space-y-2 md:flex-row md:space-y-0 md:space-x-2 md:items-center",children:[e.jsxs(I,{onClick:()=>{c(null),n.reset({business_date:H(new Date,"yyyy-MM-dd"),net_sales:0,last_year_sales:0,labor_hours:0,ideal_labor_hours:0,labor_percentage:0,theoretical_food_cost:0,food_variance_cost:0,waste_amount:0,breakfast_sales:0,night_sales:0}),a(!0)},className:"wendys-button w-full md:w-auto",size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Daily Entry"]}),d&&e.jsxs("div",{className:"flex space-x-2 md:space-x-0 md:flex-col md:space-y-2",children:[e.jsx(I,{onClick:L,variant:"outline",size:"sm",className:"flex-1 md:flex-none border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:"Sample Data"}),e.jsx(I,{onClick:x,variant:"outline",size:"sm",className:"flex-1 md:flex-none border-gray-400 text-gray-600 hover:bg-gray-100",children:"Refresh"})]})]})]}),e.jsx("div",{className:"wendys-card",children:(()=>{const i=A.reduce((z,Q)=>z+(Number(Q.net_sales)||0),0),S=A.length>0?A.reduce((z,Q)=>z+(Number(Q.labor_percentage)||0),0)/A.length:0,l=A.reduce((z,Q)=>z+(Number(Q.waste_amount)||0),0),j=i>0?l/i*100:0;return e.jsxs("div",{className:"grid-auto",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Net Sales"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:pe(i)})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Labor %"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:de(S)})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"MTD Waste %"}),e.jsx("p",{className:"mt-1 text-2xl sm:text-3xl font-bold text-wendys-charcoal",children:de(j)})]})]})})()}),e.jsx(Es,{selectedRange:g.selectedRange,selectedDate:g.selectedDate,onRangeChange:g.handleRangeChange,onDateChange:g.handleDateChange,onClearFilters:g.clearFilters}),_&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:["Error loading data: ",_.message]}),e.jsxs("div",{className:"grid-auto",children:[e.jsx(ve,{title:"Comp Net Sales Trend",subtitle:"Last 30 days",loading:!F.length&&!_,error:_==null?void 0:_.message,children:o.length>0?e.jsx("div",{className:"chart-container",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(ze,{data:o,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:i=>re.percent(i)}),e.jsx(Ve,{...ee.tooltip,formatter:i=>[re.percent(i,1),"Comp Sales %"],labelFormatter:(i,S)=>{var l;return S&&S[0]&&((l=S[0].payload)==null?void 0:l.dateFull)||i}}),e.jsx(Re,{type:"monotone",dataKey:"comp_net_sales_percentage",stroke:X.sales,strokeWidth:2,dot:{fill:X.sales,strokeWidth:2,r:3},activeDot:{r:5,stroke:X.salesSecondary,strokeWidth:2},onClick:i=>{var S;return m((S=i==null?void 0:i.payload)==null?void 0:S.isoDate)}})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})}),e.jsx(ve,{title:"Waste Percentage",subtitle:"Last 30 days",loading:!F.length&&!_,error:_==null?void 0:_.message,children:R.length>0?e.jsx("div",{className:"chart-container",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(It,{data:R,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:i=>re.percent(i)}),e.jsx(Ve,{...ee.tooltip,formatter:i=>[re.percent(i,2),"Waste %"],labelFormatter:(i,S)=>{var l;return S&&S[0]&&((l=S[0].payload)==null?void 0:l.dateFull)||i}}),e.jsx(Is,{y:.5,stroke:X.textSecondary,strokeDasharray:"4 4",label:{value:"Goal 0.5%",position:"right",fill:X.textSecondary,fontSize:12}}),e.jsx(Mt,{dataKey:"waste_percentage",fill:X.waste,opacity:.7,onClick:i=>{var S;return m((S=i==null?void 0:i.payload)==null?void 0:S.isoDate)}})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})}),e.jsx(ve,{title:"Food Variance",subtitle:"Last 30 days",loading:!F.length&&!_,error:_==null?void 0:_.message,children:R.length>0?e.jsx("div",{className:"chart-container",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(ze,{data:R,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",...ee.xAxis}),e.jsx(Me,{...ee.yAxis,tickFormatter:i=>re.percent(i)}),e.jsx(Ve,{...ee.tooltip,formatter:(i,S,l)=>{var z;const j=((z=l==null?void 0:l.payload)==null?void 0:z.food_variance_percentage)!==void 0?-l.payload.food_variance_percentage:0;return[re.percent(j,2),"Food Variance %"]},labelFormatter:(i,S)=>{var l;return S&&S[0]&&((l=S[0].payload)==null?void 0:l.dateFull)||i}}),e.jsx(Is,{y:0,stroke:X.textSecondary,strokeDasharray:"4 4",label:{value:"Target 0%",position:"right",fill:X.textSecondary,fontSize:12}}),e.jsx(Re,{type:"monotone",dataKey:"food_variance_percentage",stroke:X.foodVariance,strokeWidth:2,dot:{fill:X.foodVariance,strokeWidth:2,r:3},activeDot:{r:5,stroke:X.warning,strokeWidth:2},onClick:i=>{var S;return m((S=i==null?void 0:i.payload)==null?void 0:S.isoDate)}})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"No chart data available"}),e.jsx("p",{className:"text-sm mt-1",children:"Add some entries to see trends"})]})})})]}),e.jsxs("div",{className:"wendys-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:g.selectedRange==="last30"?"All Entries":"Filtered Entries"}),e.jsxs("div",{className:"text-xs md:text-sm text-gray-600 flex items-center",children:[w?"Loading...":`${y.length} entries`,g.selectedRange!=="last30"&&` for ${g.getSelectedLabel()}`,(g.selectedRange!=="last30"||g.selectedDate)&&e.jsx(I,{variant:"ghost",size:"sm",onClick:g.clearFilters,className:"ml-3 text-xs text-gray-600 hover:text-gray-900",children:"Show All"})]})]}),(y==null?void 0:y.length)===0&&!w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:d?e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"No data found"}),e.jsx("p",{className:"text-sm mt-2",children:g.selectedRange==="last30"?"You haven't added any daily entries yet.":"No entries found for the selected filter. Try changing the filter or adding a new entry."})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"Store not connected"}),e.jsx("p",{className:"text-sm mt-2",children:"Please go to Setup to link your account to a store first."})]})}),d&&e.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3 justify-center",children:[e.jsxs(I,{onClick:()=>a(!0),className:"wendys-button",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Your First Entry"]}),e.jsx(I,{onClick:L,variant:"outline",className:"border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:"Generate Sample Data"})]})]}):e.jsx(Qr,{columns:[{key:"business_date",label:"Date",render:i=>he(i)},{key:"net_sales",label:"Net Sales",render:i=>pe(i)},{key:"comp_sales",label:"Comp Sales",render:(i,S)=>{const l=(S.net_sales??0)-(S.last_year_sales??0);return e.jsxs("span",{className:`flex items-center ${l>=0?"text-green-600":"text-red-600"}`,children:[l>=0?e.jsx(ce,{className:"h-3 w-3 mr-1"}):e.jsx(_e,{className:"h-3 w-3 mr-1"}),pe(Math.abs(l))]})}},{key:"labor_hours",label:"Labor Hours",render:i=>`${i}h`},{key:"labor_percentage",label:"Labor %",render:i=>de(i)},{key:"food_variance",label:"Food Variance",render:(i,S)=>{const l=S.net_sales?S.food_variance_cost/S.net_sales*100:0;return de(l)}},{key:"waste",label:"Waste",render:(i,S)=>{const l=S.net_sales?S.waste_amount/S.net_sales*100:0;return de(l)}},{key:"actions",label:"Actions",render:(i,S)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>O(S),className:"h-8 w-8 p-0",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>{m(S.business_date),r({title:"Details",description:"Detailed view coming soon."})},className:"h-8 w-8 p-0",title:"View details",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>v(S.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(Ee,{className:"h-4 w-4"})})]})}],data:y,mobileCardRender:i=>{const S=(i.net_sales??0)-(i.last_year_sales??0),l=i.net_sales?i.food_variance_cost/i.net_sales*100:0,j=i.net_sales?i.waste_amount/i.net_sales*100:0;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-900",children:he(i.business_date)}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>O(i),className:"h-8 w-8 p-0",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>v(i.id),className:"h-8 w-8 p-0 text-red-600",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Net Sales:"}),e.jsx("div",{className:"font-medium",children:pe(i.net_sales)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Comp Sales:"}),e.jsxs("div",{className:`font-medium flex items-center ${S>=0?"text-green-600":"text-red-600"}`,children:[S>=0?e.jsx(ce,{className:"h-3 w-3 mr-1"}):e.jsx(_e,{className:"h-3 w-3 mr-1"}),pe(Math.abs(S))]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Labor:"}),e.jsxs("div",{className:"font-medium",children:[i.labor_hours,"h (",de(i.labor_percentage),")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Food Variance:"}),e.jsx("div",{className:"font-medium",children:de(l)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Waste:"}),e.jsx("div",{className:"font-medium",children:de(j)})]})]})]})},emptyMessage:"No entries found",loading:w})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-wendys-charcoal",children:t?"Edit Daily Entry":"Add Daily Entry"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const i=n.watch("business_date");if(i){const S=y.find(Q=>Q.business_date===i),l=Object.values(n.getValues()).some(Q=>typeof Q=="number"?Q!==0:Q!==""&&Q!==null);let j=`Current date: ${he(i)}

`;S&&(j+=`âš ï¸ There's already saved data for this date.

`),l&&(j+=`ðŸ“ You have unsaved changes in the form.

`),j+="Enter new date (YYYY-MM-DD):";const z=prompt(j,i);if(z&&z!==i)if(/^\d{4}-\d{2}-\d{2}$/.test(z)){const ae=new Date(z);if(isNaN(ae.getTime()))r({title:"Invalid date",description:"Please enter a valid date in YYYY-MM-DD format.",variant:"destructive"});else{const B=y.find(oe=>oe.business_date===z);B?confirm(`There's already data for ${he(z)}.

Do you want to load that data instead? (This will replace your current form data)`)?(c(B),n.reset({business_date:B.business_date,net_sales:B.net_sales!=null?Number(B.net_sales):0,last_year_sales:B.last_year_sales!=null?Number(B.last_year_sales):0,labor_hours:B.labor_hours!=null?Number(B.labor_hours):0,ideal_labor_hours:B.ideal_labor_hours!=null?Number(B.ideal_labor_hours):0,labor_percentage:B.labor_percentage!=null?Number(B.labor_percentage):0,theoretical_food_cost:B.theoretical_food_cost!=null?Number(B.theoretical_food_cost):0,food_variance_cost:B.food_variance_cost!=null?Number(B.food_variance_cost):0,waste_amount:B.waste_amount!=null?Number(B.waste_amount):0,breakfast_sales:B.breakfast_sales!=null?Number(B.breakfast_sales):0,night_sales:B.night_sales!=null?Number(B.night_sales):0}),r({title:"Loaded existing data",description:`Loaded data for ${he(z)}.`}),h.invalidateQueries({queryKey:["omega_daily_charts",d]})):(n.setValue("business_date",z),c(null),r({title:"Date changed",description:`Changed date to ${he(z)}. Your current data is preserved.`}),h.invalidateQueries({queryKey:["omega_daily_charts",d]})):(n.setValue("business_date",z),c(null),r({title:"Date changed",description:`Changed date to ${he(z)}. Your data is preserved.`}),h.invalidateQueries({queryKey:["omega_daily_charts",d]}))}}else r({title:"Invalid format",description:"Please enter date in YYYY-MM-DD format.",variant:"destructive"})}},className:"text-xs border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white",children:"ðŸ“… Change Date"})]}),e.jsx(I,{variant:"ghost",onClick:()=>{a(!1),c(null),n.reset()},className:"h-8 w-8 p-0",children:"Ã—"})]}),e.jsxs("form",{onSubmit:n.handleSubmit(E,q),className:"space-y-4",children:[Object.keys(n.formState.errors).length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Please fix the following errors:"}),e.jsx("ul",{className:"text-sm text-red-700 mt-1 space-y-1",children:Object.entries(n.formState.errors).map(([i,S])=>e.jsxs("li",{children:["â€¢ ",S==null?void 0:S.message]},i))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(U,{children:"Business Date"}),e.jsxs(ws,{children:[e.jsx(js,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),n.watch("business_date")?he(n.watch("business_date")):"Pick a date"]})}),e.jsx(is,{className:"w-auto p-0",children:e.jsx(Ge,{mode:"single",selected:(()=>{const i=n.watch("business_date");if(!i)return;const S=Number(i.slice(0,4)),l=Number(i.slice(5,7)),j=Number(i.slice(8,10));return new Date(S,(l||1)-1,j||1)})(),onSelect:i=>{const S=i?H(i,"yyyy-MM-dd"):"";n.setValue("business_date",S),S&&y.find(j=>j.business_date===S)&&r({title:"Existing entry found",description:`There's already data for ${he(S)}. Use "Change Date" button to switch dates while keeping your current data.`,variant:"default"})},initialFocus:!0})})]}),n.formState.errors.business_date&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.business_date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"net_sales",children:"Net Sales ($)"}),e.jsx($,{id:"net_sales",type:"number",step:"0.01",...n.register("net_sales")}),n.formState.errors.net_sales&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.net_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"last_year_sales",children:"Last Year Sales ($)"}),e.jsx($,{id:"last_year_sales",type:"number",step:"0.01",...n.register("last_year_sales")}),n.formState.errors.last_year_sales&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.last_year_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"comp_net_sales",children:"Comp Net Sales (%)"}),e.jsx($,{id:"comp_net_sales",value:de(K),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"labor_hours",children:"Labor Hours"}),e.jsx($,{id:"labor_hours",type:"number",step:"0.1",...n.register("labor_hours")}),n.formState.errors.labor_hours&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.labor_hours.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"ideal_labor_hours",children:"Ideal Labor Hours"}),e.jsx($,{id:"ideal_labor_hours",type:"number",step:"0.1",...n.register("ideal_labor_hours")}),n.formState.errors.ideal_labor_hours&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.ideal_labor_hours.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"labor_hours_diff",children:"Labor Hours +/-"}),e.jsx($,{id:"labor_hours_diff",value:`${(G??0)>=0?"+":""}${(G??0).toFixed(1)}h`,disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"labor_percentage",children:"Labor Percentage (%)"}),e.jsx($,{id:"labor_percentage",type:"number",step:"0.1",...n.register("labor_percentage")}),n.formState.errors.labor_percentage&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.labor_percentage.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"theoretical_food_cost",children:"Theoretical Food Cost ($)"}),e.jsx($,{id:"theoretical_food_cost",type:"number",step:"0.01",...n.register("theoretical_food_cost")}),n.formState.errors.theoretical_food_cost&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.theoretical_food_cost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"food_variance_cost",children:"Food Variance Cost ($)"}),e.jsx($,{id:"food_variance_cost",type:"number",step:"0.01",...n.register("food_variance_cost")}),n.formState.errors.food_variance_cost&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.food_variance_cost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"food_variance_percentage",children:"Food Variance %"}),e.jsx($,{id:"food_variance_percentage",value:de(te),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"waste_amount",children:"Waste Amount ($)"}),e.jsx($,{id:"waste_amount",type:"number",step:"0.01",...n.register("waste_amount")}),n.formState.errors.waste_amount&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.waste_amount.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"waste_percentage",children:"Waste %"}),e.jsx($,{id:"waste_percentage",value:de(ie),disabled:!0,className:"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"breakfast_sales",children:"Breakfast Sales ($)"}),e.jsx($,{id:"breakfast_sales",type:"number",step:"0.01",...n.register("breakfast_sales")}),n.formState.errors.breakfast_sales&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.breakfast_sales.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"night_sales",children:"Night Sales ($)"}),e.jsx($,{id:"night_sales",type:"number",step:"0.01",...n.register("night_sales")}),n.formState.errors.night_sales&&e.jsx("p",{className:"text-sm text-red-600",children:n.formState.errors.night_sales.message})]})]}),!d&&e.jsx("div",{className:"text-sm text-red-600",children:"Your account isnâ€™t linked to a store yet. Open Setup and link your user to a store, then try again."}),e.jsxs("div",{className:"flex flex-col-reverse space-y-2 space-y-reverse md:flex-row md:space-y-0 md:space-x-3 pt-4 md:col-span-2",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{a(!1),c(null),n.reset()},className:"w-full md:w-auto",children:"Cancel"}),e.jsx(I,{type:"submit",className:"wendys-button w-full md:w-auto",disabled:f.isPending||M.isPending||!d,children:t?"Update Entry":"Save Entry"})]})]})]})})]})}const en=we("/interviews")({component:sn});function sn(){const[s,a]=p.useState(null),[t,c]=p.useState(null),[r,h]=p.useState([]),[d,N]=p.useState(!1),[g,L]=p.useState(null),[x,n]=p.useState(""),[f,M]=p.useState("ALL"),[E,q]=p.useState(!1),[D,u]=p.useState([]),[y,w]=p.useState(!1),{toast:_}=ge(),F=qe(),[A,m]=p.useState({candidate_name:"",phone:"",email:"",position:"",interview_date:"",interview_time:"",status:"SCHEDULED",notes:""});p.useEffect(()=>{(async()=>{try{const{data:{user:T}}=await V.auth.getUser();if(!T)return;c(T.id);const{data:k}=await V.from("users").select("store_id").eq("id",T.id).single();k!=null&&k.store_id&&(a(k.store_id),R(k.store_id),o(k.store_id))}catch(T){console.error("Error getting store ID:",T)}})()},[]);const o=async b=>{try{console.log("ðŸ” Checking database enum values...");const{data:T,error:k}=await V.rpc("get_enum_values",{enum_name:"interview_status"});if(k){console.log("Could not get enum values via RPC, trying direct query...");const W=["SCHEDULED","COMPLETED","NO_SHOW","HIRED","REJECTED"];for(const Y of W)try{console.log(`Testing status: "${Y}"`);const{error:le}=await V.from("interviews").insert([{store_id:b,candidate_name:`TEST_${Y}`,interview_date:new Date().toISOString().split("T")[0],interview_time:"12:00:00",status:Y,position:"Test Position"}]).select();le?console.log(`âŒ Status "${Y}" rejected:`,le.message):(console.log(`âœ… Status "${Y}" accepted`),await V.from("interviews").delete().eq("candidate_name",`TEST_${Y}`))}catch(le){console.log(`âŒ Status "${Y}" failed:`,le)}}else console.log("âœ… Database enum values:",T)}catch(T){console.error("Error checking database enum values:",T)}},R=async b=>{try{q(!0),console.log("ðŸ” Fetching interviews for store:",b);const{data:T,error:k}=await V.from("interviews").select(`
          *,
          attachments:interview_attachments(*)
        `).eq("store_id",b).order("interview_date",{ascending:!0}).order("interview_time",{ascending:!0});if(k)throw console.error("âŒ Error fetching interviews:",k),k;console.log("ðŸ“Š Fetched interviews:",T),console.log("ðŸ“Ž Attachments found:",T==null?void 0:T.map(W=>{var Y;return{interview:W.candidate_name,attachments:((Y=W.attachments)==null?void 0:Y.length)||0}})),h(T||[])}catch(T){console.error("Error fetching interviews:",T),_({title:"Error",description:"Failed to fetch interviews",variant:"destructive"})}finally{q(!1)}},O=(b,T)=>{m(k=>({...k,[b]:T}))},v=()=>{m({candidate_name:"",phone:"",email:"",position:"",interview_date:"",interview_time:"",status:"SCHEDULED",notes:""}),L(null),u([])},C=b=>{const T=b.target.files;if(console.log("ðŸ“ File selection event:",T),!T){console.log("âŒ No files selected");return}console.log("ðŸ“ Files selected:",Array.from(T).map(W=>W.name));const k=Array.from(T).map(W=>({file:W,id:Math.random().toString(36).substr(2,9),progress:0}));console.log("ðŸ“ New uploads created:",k.map(W=>W.file.name)),u(W=>{const Y=[...W,...k];return console.log("ðŸ“ Total uploads now:",Y.length),Y})},K=b=>{u(T=>T.filter(k=>k.id!==b))},G=async b=>{if(!t||!s)throw new Error("User or store not authenticated");console.log("ðŸš€ Starting file upload process for interview:",b),console.log("ðŸ“ Files to upload:",D.map(k=>k.file.name)),console.log("ðŸ‘¤ User ID:",t),console.log("ðŸª Store ID:",s);const T=[];for(const k of D)try{console.log(`ðŸ“¤ Uploading file: ${k.file.name} (${k.file.size} bytes)`);const W=k.file.name.replace(/[^a-zA-Z0-9.-]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),Y=`${b}/${W}`;console.log("ðŸ§¹ Original filename:",k.file.name),console.log("ðŸ§¹ Sanitized filename:",W),console.log("ðŸ“‚ File path:",Y);const{error:le}=await V.storage.from("interview-attachments").upload(Y,k.file);if(le)throw console.error("âŒ Storage upload error:",le),le;console.log("âœ… File uploaded to storage successfully");const fe={interview_id:b,store_id:s,file_name:W,file_path:Y,file_size:k.file.size,file_type:k.file.type,uploaded_by:t};console.log("ðŸ’¾ Creating database record:",fe),console.log("ðŸ’¾ Database record details:"),console.log("  - interview_id:",b),console.log("  - store_id:",s),console.log("  - file_name:",k.file.name),console.log("  - file_path:",Y),console.log("  - file_size:",k.file.size),console.log("  - file_type:",k.file.type),console.log("  - uploaded_by:",t);const{data:ue,error:ye}=await V.from("interview_attachments").insert([fe]).select().single();if(ye)throw console.error("âŒ Database insert error:",ye),console.error("âŒ Full error details:",JSON.stringify(ye,null,2)),console.error("âŒ Error code:",ye.code),console.error("âŒ Error message:",ye.message),console.error("âŒ Error details:",ye.details),console.error("âŒ Error hint:",ye.hint),ye;console.log("âœ… Database record created:",ue),console.log("âœ… Database record ID:",ue.id),console.log("âœ… Database record file_path:",ue.file_path),T.push(ue)}catch(W){throw console.error("âŒ Error uploading file:",k.file.name,W),W}return console.log("ðŸŽ‰ All files uploaded successfully!"),console.log("ðŸ“Š Upload summary:"),console.log("  - Files processed:",D.length),console.log("  - Files uploaded to storage:",T.length),console.log("  - Database records created:",T.length),console.log("ðŸ“Ž Uploaded attachments:",T.map(k=>({id:k.id,file_name:k.file_name,file_path:k.file_path}))),T},te=async b=>{try{const{data:T,error:k}=await V.storage.from("interview-attachments").download(b.file_path);if(k)throw k;const W=URL.createObjectURL(T),Y=document.createElement("a");Y.href=W,Y.download=b.file_name,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(W)}catch(T){console.error("Error downloading file:",T),_({title:"Error",description:"Failed to download file",variant:"destructive"})}},ie=async(b,T)=>{try{const{error:k}=await V.storage.from("interview-attachments").remove([T]);if(k)throw k;const{error:W}=await V.from("interview_attachments").delete().eq("id",b);if(W)throw W;_({title:"Success",description:"Attachment deleted successfully"}),s&&R(s)}catch(k){console.error("Error deleting attachment:",k),_({title:"Error",description:"Failed to delete attachment",variant:"destructive"})}},i=async b=>{try{const{data:T,error:k}=await V.storage.from("interview-attachments").download(b.file_path);if(k)throw k;const W=URL.createObjectURL(T);window.open(W,"_blank")}catch(T){console.error("Error previewing file:",T),_({title:"Error",description:"Failed to preview file",variant:"destructive"})}},S=async b=>{if(!t)return null;try{const{data:T,error:k}=await V.from("calendar_events").select("id").eq("created_by",t).ilike("title","Interview: %").ilike("description",`%interviewId: ${b}%`).limit(1);return k?(console.warn("Calendar table may not exist or has permission issues:",k.message),null):T&&T.length>0?T[0]:null}catch(T){return console.warn("Calendar functionality disabled due to error:",T),null}},l=async b=>{if(!t){console.warn("No user ID available for calendar event deletion");return}try{const{error:T}=await V.from("calendar_events").select("id").limit(1);if(T){console.warn("Calendar table not available, skipping calendar event deletion:",T.message);return}const k=await S(b);if(k){const{error:W}=await V.from("calendar_events").delete().eq("id",k.id);if(W){console.warn("Error deleting calendar event:",W);return}else console.log("Calendar event deleted successfully for interview:",b),F.invalidateQueries({queryKey:["calendar-events",t]}),F.refetchQueries({queryKey:["calendar-events",t]})}else console.log("No calendar event found to delete for interview:",b)}catch(T){console.warn("Calendar deletion disabled due to error:",T)}},j=async(b,T=!1)=>{if(!t){console.warn("No user ID available for calendar event creation");return}try{const{error:k}=await V.from("calendar_events").select("id").limit(1);if(k){console.warn("Calendar table not available, skipping calendar event creation:",k.message);return}if(b.status!=="SCHEDULED"){console.log("Interview status is not SCHEDULED, removing calendar event if it exists"),await l(b.id);return}if(!b.interview_date||!b.interview_time){console.warn("Invalid date or time for calendar event:",{date:b.interview_date,time:b.interview_time});return}const W=b.interview_time.includes(":")&&b.interview_time.split(":").length===2?`${b.interview_time}:00`:b.interview_time,Y=`${b.interview_date}T${W}`,le=new Date(Y);if(isNaN(le.getTime()))throw console.error("Invalid start date created:",Y,"from:",{date:b.interview_date,time:b.interview_time,formattedTime:W}),new Error("Invalid interview date/time format");const fe=new Date(le.getTime()+60*60*1e3);if(isNaN(fe.getTime()))throw console.error("Invalid end date calculated from start date:",le),new Error("Invalid end date calculation");const ue=fe.toISOString(),ye={title:`Interview: ${b.candidate_name}`,description:`Interview for ${b.position||"position"}
${b.notes||""}
Phone: ${b.phone||"N/A"}
Email: ${b.email||"N/A"}
interviewId: ${b.id}`,start_date:Y,end_date:ue,all_day:!1,location:"Store Interview Room",reminder_type:"15min",updated_at:new Date().toISOString()};if(T){const Qe=await S(b.id);if(Qe){const{error:Je}=await V.from("calendar_events").update(ye).eq("id",Qe.id);Je?console.error("Error updating calendar event:",Je):(console.log("Calendar event updated successfully for interview:",b.id),F.invalidateQueries({queryKey:["calendar-events",t]}),F.refetchQueries({queryKey:["calendar-events",t]}))}else{const{error:Je}=await V.from("calendar_events").insert([{...ye,created_by:t}]);Je?console.error("Error creating calendar event:",Je):(console.log("Calendar event created successfully for interview:",b.id),F.invalidateQueries({queryKey:["calendar-events",t]}),F.refetchQueries({queryKey:["calendar-events",t]}))}}else{const{error:Qe}=await V.from("calendar_events").insert([{...ye,created_by:t}]);Qe?(console.error("Error creating calendar event:",Qe),_({title:"Warning",description:"Interview scheduled but calendar event creation failed.",variant:"destructive"})):(console.log("Calendar event created successfully for interview:",b.id),F.invalidateQueries({queryKey:["calendar-events",t]}),F.refetchQueries({queryKey:["calendar-events",t]}))}}catch(k){throw console.error("Error in createOrUpdateCalendarEvent:",k),k}},z=async()=>{if(!t){_({title:"Error",description:"User not authenticated",variant:"destructive"});return}if(!s){_({title:"Error",description:"No store selected",variant:"destructive"});return}if(!A.candidate_name.trim()){_({title:"Error",description:"Candidate name is required",variant:"destructive"});return}if(!A.position.trim()){_({title:"Error",description:"Position is required",variant:"destructive"});return}if(!A.interview_date){_({title:"Error",description:"Interview date is required",variant:"destructive"});return}if(!A.interview_time){_({title:"Error",description:"Interview time is required",variant:"destructive"});return}console.log("Saving interview with data:",A),console.log("Interview date format:",typeof A.interview_date,A.interview_date),console.log("Interview time format:",typeof A.interview_time,A.interview_time);const b=A.interview_time.includes(":")&&A.interview_time.split(":").length===2?`${A.interview_time}:00`:A.interview_time;console.log("Formatted time for database:",b);try{if(g){const{data:T,error:k}=await V.from("interviews").update({candidate_name:A.candidate_name,phone:A.phone||null,email:A.email||null,position:A.position,interview_date:A.interview_date,interview_time:b,status:A.status,notes:A.notes||null}).eq("id",g.id).select().single();if(k)throw k;if(T){try{await j(T,!0)}catch(W){console.warn("Calendar event update failed, but interview was saved:",W)}if(console.log("ðŸ“¤ Checking for files to upload:",D.length,"files"),D.length>0){console.log("ðŸ“¤ Starting file upload process..."),console.log("ðŸ“¤ Files to upload:",D.map(W=>W.file.name));try{w(!0),await G(T.id),u([]),console.log("âœ… File upload completed successfully"),console.log("ðŸ”„ Refreshing interviews to show attachments..."),await R(s)}catch(W){console.error("âŒ File upload failed:",W),_({title:"Warning",description:"Interview updated but some files failed to upload. You can try uploading them again by editing the interview.",variant:"destructive"})}finally{w(!1)}}else console.log("â„¹ï¸ No files to upload - fileUploads array is empty")}_({title:"Success!",description:A.status==="SCHEDULED"?"Interview updated and calendar synced!":"Interview updated and removed from calendar!"})}else{const{data:T,error:k}=await V.from("interviews").insert([{store_id:s,candidate_name:A.candidate_name,phone:A.phone||null,email:A.email||null,position:A.position,interview_date:A.interview_date,interview_time:b,status:A.status,notes:A.notes||null}]).select().single();if(k)throw k;if(T){try{await j(T,!1)}catch(W){console.warn("Calendar event creation failed, but interview was saved:",W)}if(console.log("ðŸ“¤ Checking for files to upload:",D.length,"files"),D.length>0){console.log("ðŸ“¤ Starting file upload process..."),console.log("ðŸ“¤ Files to upload:",D.map(W=>W.file.name));try{w(!0),await G(T.id),u([]),console.log("âœ… File upload completed successfully"),console.log("ðŸ”„ Refreshing interviews to show attachments..."),await R(s)}catch(W){console.error("âŒ File upload failed:",W),_({title:"Warning",description:"Interview saved but some files failed to upload. You can try uploading them again by editing the interview.",variant:"destructive"})}finally{w(!1)}}else console.log("â„¹ï¸ No files to upload - fileUploads array is empty")}_({title:"Success!",description:A.status==="SCHEDULED"?"Interview scheduled and added to calendar!":"Interview saved successfully!"})}R(s),N(!1),v()}catch(T){console.error("Error saving interview:",T),console.error("Full error object:",JSON.stringify(T,null,2)),console.error("Error message:",T.message),console.error("Error details:",T.details),console.error("Error hint:",T.hint),console.error("Error code:",T.code);let k="Failed to save interview";T.message?k=T.message:T.details?k=`Database error: ${T.details}`:T.hint?k=`Hint: ${T.hint}`:T.code&&(k=`Error code: ${T.code}`),_({title:"Error",description:k,variant:"destructive"})}},Q=b=>{L(b),m({candidate_name:b.candidate_name,phone:b.phone||"",email:b.email||"",position:b.position||"",interview_date:b.interview_date,interview_time:b.interview_time,status:b.status,notes:b.notes||""}),N(!0)},ae=async b=>{if(confirm("Are you sure you want to delete this interview?"))try{try{await l(b)}catch(k){console.warn("Calendar event deletion failed, but continuing with interview deletion:",k)}const{error:T}=await V.from("interviews").delete().eq("id",b);if(T)throw T;_({title:"Deleted!",description:"Interview and calendar event removed successfully."}),R(s)}catch(T){console.error("Error deleting interview:",T),_({title:"Error",description:T.message||"Failed to delete interview",variant:"destructive"})}},oe=r.filter(b=>{const T=b.candidate_name.toLowerCase().includes(x.toLowerCase())||(b.position||"").toLowerCase().includes(x.toLowerCase()),k=f==="ALL"||b.status===f;return T&&k}).reduce((b,T)=>{const k=T.interview_date;return b[k]||(b[k]=[]),b[k].push(T),b},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-wendys-charcoal",children:"Interviews & New Hires"}),e.jsx("p",{className:"text-gray-600",children:"Manage candidate interviews and track the hiring process"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{onClick:()=>s&&R(s),variant:"outline",className:"text-sm",children:"Refresh"}),e.jsxs(I,{onClick:()=>N(!0),className:"wendys-button",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Schedule Interview"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx($,{placeholder:"Search by name or position...",value:x,onChange:b=>n(b.target.value),className:"pl-10"})]})}),e.jsxs(bs,{value:f,onValueChange:M,children:[e.jsx(rs,{className:"w-full sm:w-48",children:e.jsx(_s,{placeholder:"Filter by status"})}),e.jsxs(ns,{children:[e.jsx(xe,{value:"ALL",children:"All Statuses"}),e.jsx(xe,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(xe,{value:"COMPLETED",children:"Completed"}),e.jsx(xe,{value:"NO_SHOW",children:"No Show"}),e.jsx(xe,{value:"HIRED",children:"Hired"}),e.jsx(xe,{value:"REJECTED",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[E&&e.jsx("div",{className:"text-center text-gray-500",children:"Loading interviews..."}),!E&&Object.keys(oe).length===0&&e.jsx("div",{className:"text-center text-gray-500",children:"No interviews found."}),Object.entries(oe).map(([b,T])=>e.jsxs("div",{className:"wendys-card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4 flex items-center",children:[e.jsx(Ne,{className:"h-5 w-5 mr-2"}),he(b)]}),e.jsx("div",{className:"space-y-3",children:T.map(k=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-wendys-charcoal",children:k.candidate_name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Vt(k.status)}`,children:k.status.replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Os,{className:"h-4 w-4"}),e.jsx("span",{children:k.position||"No position specified"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:$a(k.interview_time)})]}),k.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ta,{className:"h-4 w-4"}),e.jsx("span",{children:k.phone})]}),k.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vt,{className:"h-4 w-4"}),e.jsx("span",{children:k.email})]})]}),k.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx(Ue,{className:"h-4 w-4 inline mr-1"}),k.notes]}),k.attachments&&k.attachments.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Attachments:"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:k.attachments.map(W=>e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg px-3 py-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700 truncate max-w-32",children:W.file_name}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>i(W),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",title:"Preview",children:e.jsx(ke,{className:"h-3 w-3"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>te(W),className:"h-6 w-6 p-0 text-green-600 hover:text-green-700",title:"Download",children:e.jsx(_t,{className:"h-3 w-3"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>ie(W.id,W.file_path),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",title:"Delete",children:e.jsx(Ee,{className:"h-3 w-3"})})]})]},W.id))})]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Q(k),children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>ae(k.id),className:"text-red-600 hover:text-red-700",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]})},k.id))})]},b))]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-wendys-charcoal",children:g?"Edit Interview":"Schedule New Interview"}),e.jsx(I,{variant:"ghost",onClick:()=>{N(!1),v()},className:"h-8 w-8 p-0",children:"Ã—"})]}),e.jsxs("form",{onSubmit:b=>{b.preventDefault(),z()},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"candidate_name",children:"Candidate Name *"}),e.jsx($,{id:"candidate_name",value:A.candidate_name,onChange:b=>O("candidate_name",b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"position",children:"Position"}),e.jsx($,{id:"position",value:A.position,onChange:b=>O("position",b.target.value),placeholder:"e.g., Crew Member, Manager"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"phone",children:"Phone"}),e.jsx($,{id:"phone",type:"tel",value:A.phone,onChange:b=>O("phone",b.target.value),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"email",children:"Email"}),e.jsx($,{id:"email",type:"email",value:A.email,onChange:b=>O("email",b.target.value),placeholder:"candidate@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"interview_date",children:"Interview Date *"}),e.jsx($,{id:"interview_date",type:"date",value:A.interview_date,onChange:b=>O("interview_date",b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"interview_time",children:"Interview Time *"}),e.jsx($,{id:"interview_time",type:"time",value:A.interview_time,onChange:b=>O("interview_time",b.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"status",children:"Status *"}),e.jsxs(bs,{value:A.status,onValueChange:b=>O("status",b),children:[e.jsx(rs,{id:"status",children:e.jsx(_s,{})}),e.jsxs(ns,{children:[e.jsx(xe,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(xe,{value:"COMPLETED",children:"Completed"}),e.jsx(xe,{value:"NO_SHOW",children:"No Show"}),e.jsx(xe,{value:"HIRED",children:"Hired"}),e.jsx(xe,{value:"REJECTED",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"notes",children:"Notes"}),e.jsx(as,{id:"notes",value:A.notes,onChange:b=>O("notes",b.target.value),placeholder:"Additional notes about the candidate...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"attachments",children:"Attachments"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[e.jsx("input",{id:"attachments",type:"file",multiple:!0,onChange:C,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif"}),e.jsxs("label",{htmlFor:"attachments",className:"cursor-pointer flex flex-col items-center justify-center space-y-2",children:[e.jsx(Lt,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Click to upload files or drag and drop"}),e.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, TXT, JPG, PNG, GIF (Max 10MB each)"})]})]}),D.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Files to upload:"}),D.map(b=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b.file.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",(b.file.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>K(b.id),className:"h-6 w-6 p-0 text-red-500 hover:text-red-700",children:e.jsx(He,{className:"h-4 w-4"})})]},b.id))]}),y&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{children:"Uploading files..."})]})]}),e.jsx("div",{className:"flex justify-end items-center pt-4",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{N(!1),v()},children:"Cancel"}),e.jsx(I,{type:"submit",className:"wendys-button",children:g?"Update Interview":"Schedule Interview"})]})})]})]})})]})}const tn={"on-track":{color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",icon:es,label:"On Track"},caution:{color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",icon:je,label:"Caution"},behind:{color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",icon:je,label:"Behind"},exceeded:{color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",icon:ps,label:"Exceeded"}},an={up:ce,down:_e,stable:Ke};function cs({title:s,target:a,actual:t,unit:c,status:r,progress:h,trend:d,trendValue:N,insight:g,historicalBenchmark:L,successRate:x,isEditing:n=!1,onEdit:f,className:M}){const E=tn[r],q=E.icon,D=d?an[d]:null,u=w=>{switch(c){case"currency":return re.currency(w);case"percentage":return re.percent(w,1);case"hours":return re.hours(w,1);case"count":return w.toLocaleString();default:return w.toString()}},y=()=>{switch(r){case"on-track":return"bg-green-500";case"caution":return"bg-amber-500";case"behind":return"bg-red-500";case"exceeded":return"bg-blue-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:P("wendys-card p-6 transition-all duration-200 hover:shadow-lg",E.borderColor,"border-l-4",M),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal",children:s}),e.jsxs("div",{className:P("flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium",E.bgColor,E.color),children:[e.jsx(q,{className:"w-4 h-4"}),E.label]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Target"}),e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:n?e.jsx("input",{type:"number",value:a,onChange:w=>f==null?void 0:f(Number(w.target.value)),className:"w-full text-2xl font-bold bg-transparent border-b border-gray-300 focus:border-wendys-red focus:outline-none"}):u(a)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Actual"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-2xl font-bold text-wendys-charcoal",children:u(t)}),D&&N&&e.jsxs("div",{className:P("flex items-center gap-1 text-sm",d==="up"?"text-green-600":d==="down"?"text-red-600":"text-gray-600"),children:[e.jsx(D,{className:"w-4 h-4"}),e.jsxs("span",{children:[Math.abs(N).toFixed(1),"%"]})]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[h.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:P("h-2 rounded-full transition-all duration-300",y()),style:{width:`${Math.min(h,100)}%`}})})]}),L&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Last Week"}),e.jsx("p",{className:"text-sm font-medium",children:u(L.lastWeek)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Last Year"}),e.jsx("p",{className:"text-sm font-medium",children:u(L.lastYear)})]})]}),x&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Success Rate"}),e.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["Hit ",x.hit," of last ",x.total," periods"]})]}),g&&e.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx("p",{className:"text-xs text-amber-600 mb-1",children:"Insight"}),e.jsx("p",{className:"text-sm text-amber-800",children:g})]})]})}function Qs({data:s,unit:a,className:t}){const c=h=>{switch(a){case"currency":return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(h);case"percentage":return`${h.toFixed(1)}%`;case"hours":return`${h.toFixed(1)}h`;case"count":return h.toLocaleString();default:return h.toString()}},r=h=>new Date(h).toLocaleDateString("en-US",{month:"short",day:"numeric"});return e.jsx("div",{className:t,children:e.jsx("div",{className:"h-32",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(ze,{data:s,children:[e.jsx(Le,{...ee.cartesianGrid}),e.jsx(Ie,{dataKey:"date",tickFormatter:r,...ee.xAxis}),e.jsx(Me,{tickFormatter:c,...ee.yAxis}),e.jsx(Ve,{content:({active:h,payload:d,label:N})=>{var g,L;return h&&d&&d.length?e.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:r(N)}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"Target:"})," ",c(Number((g=d[0])==null?void 0:g.value)||0)]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-green-600",children:"Actual:"})," ",c(Number((L=d[1])==null?void 0:L.value)||0)]})]})]}):null}}),e.jsx(Re,{type:"monotone",dataKey:"target",stroke:X.textSecondary,strokeWidth:2,strokeDasharray:"5 5",dot:!1}),e.jsx(Re,{type:"monotone",dataKey:"actual",stroke:X.sales,strokeWidth:3,dot:{fill:X.sales,strokeWidth:2,r:4}})]})})})})}const rn={warning:{icon:je,bgColor:"bg-amber-50",borderColor:"border-amber-200",textColor:"text-amber-800",iconColor:"text-amber-600"},success:{icon:ps,bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-800",iconColor:"text-green-600"},info:{icon:Ke,bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-800",iconColor:"text-blue-600"},alert:{icon:je,bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-800",iconColor:"text-red-600"}};function nn({insights:s,className:a}){return s.length===0?null:e.jsxs("div",{className:P("space-y-3",a),children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Key Insights"}),s.map((t,c)=>{const r=rn[t.type],h=r.icon;return e.jsx("div",{className:P("p-3 rounded-lg border",r.bgColor,r.borderColor),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:P("w-5 h-5 mt-0.5 flex-shrink-0",r.iconColor)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h5",{className:P("text-sm font-medium",r.textColor),children:t.title}),e.jsx("p",{className:P("text-sm mt-1",r.textColor),children:t.message}),t.action&&e.jsx("button",{onClick:t.onAction,className:P("mt-2 text-xs font-medium underline hover:no-underline",r.textColor),children:t.action})]})]})},c)})]})}const ln=De({sales_target:J.number().min(0),labor_target_pct:J.number().min(0),waste_target_pct:J.number().min(0),food_variance_target_pct:J.number(),team_notes:Z().optional()}),ms=(s,a,t=!1)=>{if(a===0)return"behind";const c=s/a*100,r=5;return t?c<=100-r?"on-track":c<=100+r?"caution":"behind":c>=100+r?"exceeded":c>=100-r?"on-track":c>=100-r*2?"caution":"behind"},us=(s,a)=>{if(a===0)return{trend:"stable",value:0};const t=(s-a)/a*100;return Math.abs(t)<1?{trend:"stable",value:0}:{trend:t>0?"up":"down",value:Math.abs(t)}},xs=(s,a)=>{const{actual:t,target:c,progress:r,status:h,trend:d}=s;if(h==="behind"){const N=c-t;return`${a} is ${N.toLocaleString()} below target. Consider reviewing operational efficiency.`}return h==="caution"?`${a} is close to target but needs attention. Monitor closely for improvement opportunities.`:h==="exceeded"?`Excellent! ${a} exceeded target by ${(t-c).toLocaleString()}.`:d==="up"&&r>80?`${a} trending positively and on track to meet goal.`:`${a} performing well within target range.`};function on(){const{toast:s}=ge(),a=qe(),[t,c]=p.useState(null),[r,h]=p.useState(!1),[d,N]=p.useState(null),g=Ss("goals","wtd"),L=g.getDateRangeFilter(),x=(L==null?void 0:L.start)||H(new Date,"yyyy-MM-dd"),n=(L==null?void 0:L.end)||H(new Date,"yyyy-MM-dd"),f=g.selectedRange==="mtd"?"month":g.selectedRange==="wtd"?"week":"custom",M=Be({resolver:Ye(ln),defaultValues:{sales_target:0,labor_target_pct:25,waste_target_pct:.5,food_variance_target_pct:-.5,team_notes:""}});p.useEffect(()=>{let v=!0;return(async()=>{var ie;const{data:C}=await V.auth.getUser(),K=(ie=C.user)==null?void 0:ie.id;if(!K)return;const{data:G,error:te}=await V.from("users").select("store_id").eq("id",K).maybeSingle();v&&(te||c((G==null?void 0:G.store_id)??null))})(),()=>{v=!1}},[]);const{data:E}=ne({queryKey:["goals_settings",t,x,n],queryFn:async()=>{if(!t)return null;try{const{data:v,error:C}=await V.from("goals").select("*").eq("store_id",t).eq("period_start",x).eq("period_end",n).maybeSingle();if(C&&C.code!=="PGRST116"){const K=String(C.code||""),G=String(C.message||"");if(K.startsWith("42")||G.toLowerCase().includes("relation")||G.toLowerCase().includes("does not exist"))return console.warn("[Goals] Goals table not available; returning null"),null;throw C}return v||null}catch(v){const C=String((v==null?void 0:v.code)||""),K=String((v==null?void 0:v.message)||"");if(C.startsWith("42")||K.toLowerCase().includes("relation")||K.toLowerCase().includes("does not exist"))return console.warn("[Goals] Goals table not available; returning null"),null;throw v}},enabled:!!t});p.useEffect(()=>{E&&M.reset({sales_target:E.sales_target,labor_target_pct:E.labor_target_pct,waste_target_pct:E.waste_target_pct,food_variance_target_pct:E.food_variance_target_pct,team_notes:E.team_notes||""})},[E]);const{data:q=[]}=ne({queryKey:["omega_daily_for_goals",t,x,n],queryFn:async()=>{if(!t)return[];const{data:v,error:C}=await V.from("omega_daily").select("*").eq("store_id",t).gte("business_date",x).lte("business_date",n).order("business_date",{ascending:!0});if(C)throw C;return v},enabled:!!t}),{data:D}=ne({queryKey:["historical_data_for_goals",t,x,n],queryFn:async()=>{if(!t)return{lastWeek:[],lastMonth:[],lastYear:[]};const v=new Date(x),C=new Date(n),K=H(Cs(v,1),"yyyy-MM-dd"),G=H(Cs(C,1),"yyyy-MM-dd"),te=H(ds(v,1),"yyyy-MM-dd"),ie=H(ds(C,1),"yyyy-MM-dd"),i=H(ds(v,12),"yyyy-MM-dd"),S=H(ds(C,12),"yyyy-MM-dd"),[l,j,z]=await Promise.all([V.from("omega_daily").select("*").eq("store_id",t).gte("business_date",K).lte("business_date",G).order("business_date",{ascending:!0}),V.from("omega_daily").select("*").eq("store_id",t).gte("business_date",te).lte("business_date",ie).order("business_date",{ascending:!0}),V.from("omega_daily").select("*").eq("store_id",t).gte("business_date",i).lte("business_date",S).order("business_date",{ascending:!0})]);return{lastWeek:l.data||[],lastMonth:j.data||[],lastYear:z.data||[]}},enabled:!!t}),{data:u}=ne({queryKey:["success_rate_data",t],queryFn:async()=>{if(!t)return{sales:{hit:0,total:0},labor:{hit:0,total:0},waste:{hit:0,total:0},foodVariance:{hit:0,total:0}};const v=H(Cs(new Date,12),"yyyy-MM-dd"),C=H(new Date,"yyyy-MM-dd"),{data:K,error:G}=await V.from("omega_daily").select("*").eq("store_id",t).gte("business_date",v).lte("business_date",C).order("business_date",{ascending:!0});if(G)throw G;const ie=(K||[]).reduce((l,j)=>{const z=Nt(new Date(j.business_date),{weekStartsOn:0}),Q=H(z,"yyyy-MM-dd");return l[Q]||(l[Q]=[]),l[Q].push(j),l},{}),i=Object.values(ie).slice(-12),S=(l,j,z=!1)=>{let Q=0;return l.forEach(ae=>{const B=ae.reduce((fe,ue)=>fe+(ue.net_sales||0),0),oe=ae.reduce((fe,ue)=>fe+(ue.labor_percentage||0),0)/ae.length,b=ae.reduce((fe,ue)=>fe+(ue.waste_amount||0),0),T=B>0?b/B*100:0,k=ae.reduce((fe,ue)=>fe+(ue.food_variance_cost||0),0),W=B>0?k/B*100:0;let Y=0;j===25?Y=oe:j===.5?Y=T:j===.5?Y=W:Y=B,(z?Y<=j:Y>=j)&&Q++}),{hit:Q,total:l.length}};return{sales:S(i,0,!1),labor:S(i,25,!0),waste:S(i,.5,!0),foodVariance:S(i,.5,!0)}},enabled:!!t}),y=p.useMemo(()=>{const v=q.reduce((l,j)=>l+(Number(j.net_sales)||0),0),C=q.reduce((l,j)=>l+(Number(j.labor_hours)||0),0),K=q.reduce((l,j)=>l+(Number(j.ideal_labor_hours)||0),0),G=K>0?C/K*100:0,te=q.reduce((l,j)=>l+(Number(j.waste_amount)||0),0),ie=q.reduce((l,j)=>l+(Number(j.food_variance_cost)||0),0),i=v>0?te/v*100:0,S=v>0?ie/v*100:0;return{totalSales:v,avgLaborPct:G,wastePct:i,foodVarPct:S}},[q]),w=p.useMemo(()=>{const v=M.watch(),C=(b,T=!1)=>{if(!b||b.length===0)return 0;if(T){const k=b.reduce((Y,le)=>Y+(Number(le.labor_hours)||0),0),W=b.reduce((Y,le)=>Y+(Number(le.ideal_labor_hours)||0),0);return W>0?k/W*100:0}else return b.reduce((k,W)=>k+(Number(W.net_sales)||0),0)},K=D?{lastWeek:C(D.lastWeek),lastMonth:C(D.lastMonth),lastYear:C(D.lastYear)}:{lastWeek:0,lastMonth:0,lastYear:0},G=v.sales_target>0?y.totalSales/v.sales_target*100:0,te=ms(y.totalSales,v.sales_target,!1),ie=us(y.totalSales,K.lastWeek),i=v.labor_target_pct>0&&y.avgLaborPct>0?Math.max(0,Math.min(100,v.labor_target_pct/y.avgLaborPct*100)):v.labor_target_pct>0&&y.avgLaborPct===0?100:0,S=ms(y.avgLaborPct,v.labor_target_pct,!0),l=us(y.avgLaborPct,K.lastWeek),j=v.waste_target_pct>0&&y.wastePct>0?Math.max(0,Math.min(100,v.waste_target_pct/y.wastePct*100)):v.waste_target_pct>0&&y.wastePct===0?100:0,z=ms(y.wastePct,v.waste_target_pct,!0),Q=us(y.wastePct,K.lastWeek),ae=(()=>{if(v.food_variance_target_pct===0)return 0;if(y.foodVarPct===0)return 100;const b=Math.abs(v.food_variance_target_pct),T=Math.abs(y.foodVarPct);return T<b?Math.min(150,100+(b-T)/b*50):T===b?100:Math.max(0,b/T*100)})(),B=ms(y.foodVarPct,v.food_variance_target_pct,!0),oe=us(y.foodVarPct,K.lastWeek);return{sales:{actual:y.totalSales,target:v.sales_target,progress:G,status:te,trend:ie.trend,trendValue:ie.value,historical:K,successRate:(u==null?void 0:u.sales)||{hit:0,total:0},insight:xs({actual:y.totalSales,target:v.sales_target,progress:G,status:te,trend:ie.trend,trendValue:ie.value,successRate:(u==null?void 0:u.sales)||{}},"Sales")},labor:{actual:y.avgLaborPct,target:v.labor_target_pct,progress:i,status:S,trend:l.trend,trendValue:l.value,historical:K,successRate:(u==null?void 0:u.labor)||{hit:0,total:0},insight:xs({actual:y.avgLaborPct,target:v.labor_target_pct,progress:i,status:S,trend:l.trend,trendValue:l.value,successRate:(u==null?void 0:u.labor)||{}},"Labor")},waste:{actual:y.wastePct,target:v.waste_target_pct,progress:j,status:z,trend:Q.trend,trendValue:Q.value,historical:K,successRate:(u==null?void 0:u.waste)||{hit:0,total:0},insight:xs({actual:y.wastePct,target:v.waste_target_pct,progress:j,status:z,trend:Q.trend,trendValue:Q.value,successRate:(u==null?void 0:u.waste)||{}},"Waste")},foodVariance:{actual:y.foodVarPct,target:v.food_variance_target_pct,progress:ae,status:B,trend:oe.trend,trendValue:oe.value,historical:K,successRate:(u==null?void 0:u.foodVariance)||{hit:0,total:0},insight:xs({actual:y.foodVarPct,target:v.food_variance_target_pct,progress:ae,status:B,trend:oe.trend,trendValue:oe.value,successRate:(u==null?void 0:u.foodVariance)||{}},"Food Variance")}}},[y,M.watch(),D,u,x,n]),_=p.useMemo(()=>{const v=[],C=Math.max(.1,(Date.now()-new Date(x).getTime())/(new Date(n).getTime()-new Date(x).getTime()));return w.sales.progress/C<.8&&w.sales.status==="behind"&&v.push({type:"alert",title:"Sales Pacing Alert",message:`Sales are ${w.sales.progress.toFixed(1)}% of target but only ${(C*100).toFixed(1)}% of time has passed. Consider immediate action.`,action:"Review Operations"}),w.labor.status==="behind"&&v.push({type:"warning",title:"Labor Over Target",message:`Labor is ${w.labor.actual.toFixed(1)}% vs target of ${w.labor.target.toFixed(1)}%. Review scheduling and efficiency.`,action:"Adjust Schedule"}),w.waste.status==="behind"&&v.push({type:"warning",title:"Waste Over Target",message:`Waste is ${w.waste.actual.toFixed(2)}% vs target of ${w.waste.target.toFixed(2)}%. Review inventory management.`,action:"Check Inventory"}),w.sales.successRate.hit/w.sales.successRate.total<.5&&v.push({type:"info",title:"Sales Consistency",message:`Sales goal hit only ${w.sales.successRate.hit} of last ${w.sales.successRate.total} periods. Focus on consistency.`}),v},[w,x,n]),F=me({mutationFn:async v=>{if(console.log("Save mutation started with payload:",v),console.log("Store ID:",t),console.log("Scope:",f),console.log("Period:",x,"to",n),!t)throw new Error("No store is linked to your account. See Setup to link one.");const C={store_id:t,scope:f,period_start:x,period_end:n,sales_target:v.sales_target,labor_target_pct:v.labor_target_pct,waste_target_pct:v.waste_target_pct,food_variance_target_pct:v.food_variance_target_pct,team_notes:v.team_notes||null};console.log("Upsert data:",C);const{error:K}=await V.from("goals").upsert(C,{onConflict:"store_id,period_start,period_end"});if(K){console.error("Supabase error:",K);const G=String(K.code||""),te=String(K.message||"");throw G.startsWith("42")||te.toLowerCase().includes("relation")||te.toLowerCase().includes("does not exist")?new Error("Goals table is not installed in this Supabase project. Open Setup and run the SQL to create it, then try again."):K}console.log("Goals saved successfully")},onSuccess:()=>{s({title:"Goals Saved",description:"Goals have been successfully saved for the selected period."}),a.invalidateQueries({queryKey:["goals_settings",t,x,n]}),N(M.getValues()),h(!1)},onError:v=>{s({title:"Save Failed",description:v.message,variant:"destructive"})}}),A=p.useCallback(()=>{N(M.getValues()),h(!0)},[M]),m=p.useCallback(()=>{d&&M.reset(d),h(!1)},[M,d]),o=p.useCallback(()=>{console.log("Save button clicked");const v=M.getValues();console.log("Form values:",v),M.handleSubmit(C=>{console.log("Form submitted with values:",C),F.mutate(C)})()},[M,F]),R=p.useCallback(()=>{a.invalidateQueries({queryKey:["omega_daily_for_goals",t,x,n]}),a.invalidateQueries({queryKey:["historical_data_for_goals",t,x,n]}),a.invalidateQueries({queryKey:["success_rate_data",t]}),s({title:"Refreshed",description:"Goal data has been refreshed with latest information."})},[a,t,x,n,s]),O=p.useCallback(()=>{M.reset({sales_target:0,labor_target_pct:25,waste_target_pct:.5,food_variance_target_pct:-.5,team_notes:""}),h(!0)},[M]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-wendys-charcoal",children:"Goal Performance Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Set targets, track progress, and gain insights into your store's performance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",onClick:R,disabled:!t,className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"w-4 h-4"}),"Refresh"]}),r?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:m,children:"Cancel"}),e.jsxs(I,{onClick:o,disabled:F.isPending,className:"wendys-button flex items-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4"}),F.isPending?"Saving...":"Save Goals"]})]}):e.jsx(I,{onClick:A,className:"wendys-button",children:"Edit Goals"}),e.jsxs(I,{variant:"outline",onClick:O,className:"flex items-center gap-2",children:[e.jsx(Da,{className:"w-4 h-4"}),"Reset"]})]})]}),e.jsx(Es,{selectedRange:g.selectedRange,selectedDate:g.selectedDate,onRangeChange:g.handleRangeChange,onDateChange:g.handleDateChange,onClearFilters:g.clearFilters}),_.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(vs,{className:"w-5 h-5 text-amber-600"}),e.jsx("h3",{className:"text-lg font-semibold text-amber-800",children:"Performance Alerts"})]}),e.jsx(nn,{insights:_})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[e.jsx(cs,{title:"Sales Target",target:w.sales.target,actual:w.sales.actual,unit:"currency",status:w.sales.status,progress:w.sales.progress,trend:w.sales.trend,trendValue:w.sales.trendValue,insight:w.sales.insight,historicalBenchmark:{lastWeek:w.sales.historical.lastWeek,lastYear:w.sales.historical.lastYear},successRate:w.sales.successRate,isEditing:r,onEdit:v=>M.setValue("sales_target",v)}),e.jsx(cs,{title:"Labor Efficiency",target:w.labor.target,actual:w.labor.actual,unit:"percentage",status:w.labor.status,progress:w.labor.progress,trend:w.labor.trend,trendValue:w.labor.trendValue,insight:w.labor.insight,historicalBenchmark:{lastWeek:w.labor.historical.lastWeek,lastYear:w.labor.historical.lastYear},successRate:w.labor.successRate,isEditing:r,onEdit:v=>M.setValue("labor_target_pct",v)}),e.jsx(cs,{title:"Waste Control",target:w.waste.target,actual:w.waste.actual,unit:"percentage",status:w.waste.status,progress:w.waste.progress,trend:w.waste.trend,trendValue:w.waste.trendValue,insight:w.waste.insight,historicalBenchmark:{lastWeek:w.waste.historical.lastWeek,lastYear:w.waste.historical.lastYear},successRate:w.waste.successRate,isEditing:r,onEdit:v=>M.setValue("waste_target_pct",v)}),e.jsx(cs,{title:"Food Variance",target:w.foodVariance.target,actual:w.foodVariance.actual,unit:"percentage",status:w.foodVariance.status,progress:w.foodVariance.progress,trend:w.foodVariance.trend,trendValue:w.foodVariance.trendValue,insight:w.foodVariance.insight,historicalBenchmark:{lastWeek:w.foodVariance.historical.lastWeek,lastYear:w.foodVariance.historical.lastYear},successRate:w.foodVariance.successRate,isEditing:r,onEdit:v=>M.setValue("food_variance_target_pct",v)}),e.jsxs("div",{className:"wendys-card p-6 lg:col-span-2 xl:col-span-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4",children:"Team Notes & Goals"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"team_notes",className:"text-sm font-medium text-gray-700",children:"Notes & Observations"}),e.jsx($,{id:"team_notes",...M.register("team_notes"),placeholder:"Team notes, personal goals, shout-outs, operational insights...",className:"mt-1",disabled:!r})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Tip:"})," Use this space to track team performance, note operational improvements, or celebrate achievements that contribute to your goals."]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"wendys-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4",children:"Sales Progress Trend"}),e.jsx(Qs,{data:q.map(v=>({date:v.business_date,actual:v.net_sales,target:w.sales.target,period:H(new Date(v.business_date),"MMM d")})),unit:"currency"})]}),e.jsxs("div",{className:"wendys-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-wendys-charcoal mb-4",children:"Labor Efficiency Trend"}),e.jsx(Qs,{data:q.map(v=>({date:v.business_date,actual:v.labor_percentage,target:w.labor.target,period:H(new Date(v.business_date),"MMM d")})),unit:"percentage"})]})]})]})}const dn=we("/goals")({component:on}),cn=we("/calendar")({component:mn});function mn(){var ie,i,S;const[s,a]=p.useState(!1),[t,c]=p.useState(!1),[r,h]=p.useState(null),[d,N]=p.useState(null),[g,L]=p.useState(new Date),[x,n]=p.useState("month"),{toast:f}=ge(),M=qe(),[E,q]=p.useState(null);p.useEffect(()=>{(async()=>{const{data:{user:j}}=await V.auth.getUser();q((j==null?void 0:j.id)||null)})()},[]);const{data:D=[]}=ne({queryKey:["calendar-events",E],queryFn:async()=>{if(!E)return[];const{data:l,error:j}=await V.from("calendar_events").select("*").eq("created_by",E).order("start_date",{ascending:!0});if(j)throw j;return l||[]},enabled:!!E}),{data:u=[]}=ne({queryKey:["calendar-reminders",E],queryFn:async()=>{if(!E)return[];const{data:l,error:j}=await V.from("calendar_reminders").select("*").eq("created_by",E).order("due_date",{ascending:!0});if(j)throw j;return l||[]},enabled:!!E}),y=me({mutationFn:async l=>{if(!E)throw new Error("User not authenticated");if(r){const{error:j}=await V.from("calendar_events").update({...l,updated_at:new Date().toISOString()}).eq("id",r.id);if(j)throw j}else{const{error:j}=await V.from("calendar_events").insert({...l,created_by:E,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(j)throw j}},onSuccess:()=>{f({title:r?"Event updated!":"Event created!",description:r?"Your event has been updated successfully.":"Your event has been created successfully."}),a(!1),h(null),M.invalidateQueries({queryKey:["calendar-events",E]})},onError:l=>{f({title:"Error",description:l.message||"Failed to save event",variant:"destructive"})}}),w=me({mutationFn:async l=>{if(!E)throw new Error("User not authenticated");if(d){const{error:j}=await V.from("calendar_reminders").update({...l,updated_at:new Date().toISOString()}).eq("id",d.id);if(j)throw j}else{const{error:j}=await V.from("calendar_reminders").insert({...l,created_by:E,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(j)throw j}},onSuccess:()=>{f({title:d?"Reminder updated!":"Reminder created!",description:d?"Your reminder has been updated successfully.":"Your reminder has been created successfully."}),c(!1),N(null),M.invalidateQueries({queryKey:["calendar-reminders",E]})},onError:l=>{f({title:"Error",description:l.message||"Failed to save reminder",variant:"destructive"})}}),_=me({mutationFn:async l=>{const{error:j}=await V.from("calendar_events").delete().eq("id",l);if(j)throw j},onSuccess:()=>{f({title:"Event deleted",description:"Event has been removed successfully."}),M.invalidateQueries({queryKey:["calendar-events",E]})},onError:l=>{f({title:"Delete failed",description:l.message,variant:"destructive"})}}),F=me({mutationFn:async l=>{const{error:j}=await V.from("calendar_reminders").delete().eq("id",l);if(j)throw j},onSuccess:()=>{f({title:"Reminder deleted",description:"Reminder has been removed successfully."}),M.invalidateQueries({queryKey:["calendar-reminders",E]})},onError:l=>{f({title:"Delete failed",description:l.message,variant:"destructive"})}}),A=me({mutationFn:async({id:l,completed:j})=>{const{error:z}=await V.from("calendar_reminders").update({completed:j,updated_at:new Date().toISOString()}).eq("id",l);if(z)throw z},onSuccess:()=>{M.invalidateQueries({queryKey:["calendar-reminders",E]})},onError:l=>{f({title:"Error",description:l.message,variant:"destructive"})}}),m=D.filter(l=>Xe(We(l.start_date),g)),o=u.filter(l=>Xe(We(l.due_date),g)),R=Aa({start:La(g),end:Ia(g)}),O=l=>D.filter(j=>Xe(We(j.start_date),l)),v=l=>u.filter(j=>Xe(We(j.due_date),l)),C=l=>{l&&L(l)},K=l=>{h(l||null),a(!0)},G=l=>{N(l||null),c(!0)},te=l=>{switch(l){case"high":return e.jsx(Pe,{className:"h-3 w-3 fill-red-500 text-red-500"});case"medium":return e.jsx(Pe,{className:"h-3 w-3 fill-yellow-500 text-yellow-500"});case"low":return e.jsx(Pe,{className:"h-3 w-3 fill-green-500 text-green-500"});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-wendys-red via-red-600 to-wendys-dark-red opacity-10"}),e.jsx("div",{className:"relative px-6 py-8 sm:px-8 lg:px-12",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-4xl lg:text-5xl font-bold bg-gradient-to-r from-wendys-charcoal to-gray-700 bg-clip-text text-transparent",children:"Calendar"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl",children:"Organize your schedule with beautiful events and smart reminders"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(I,{onClick:()=>K(),className:"wendys-button shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[e.jsx(Te,{className:"h-5 w-5 mr-2"}),"Add Event"]}),e.jsxs(I,{onClick:()=>G(),variant:"outline",className:"border-2 border-wendys-red text-wendys-red hover:bg-wendys-red hover:text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[e.jsx(Ws,{className:"h-5 w-5 mr-2"}),"Add Reminder"]})]})]})})})]}),e.jsx("div",{className:"px-6 sm:px-8 lg:px-12 pb-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"inline-flex bg-white rounded-xl p-1 shadow-lg border border-gray-200",children:["month","week","day"].map(l=>e.jsx(I,{variant:x===l?"default":"ghost",onClick:()=>n(l),size:"sm",className:`rounded-lg px-6 py-2 font-medium transition-all duration-200 ${x===l?"wendys-button shadow-md":"text-gray-600 hover:text-wendys-charcoal hover:bg-gray-100"}`,children:l.charAt(0).toUpperCase()+l.slice(1)},l))})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:e.jsx(Ge,{mode:"single",selected:g,onSelect:C,className:"rounded-xl border-0",classNames:{day_selected:"bg-wendys-red text-white hover:bg-wendys-dark-red focus:bg-wendys-dark-red",day_today:"bg-wendys-red/10 text-wendys-red font-bold",day:"h-12 w-12 text-center text-sm p-0 font-normal aria-selected:opacity-100 hover:bg-gray-100 rounded-lg transition-colors duration-200",head_cell:"text-gray-500 font-semibold text-sm uppercase tracking-wide pb-4",nav_button:"text-gray-600 hover:text-wendys-charcoal hover:bg-gray-100 rounded-lg transition-colors duration-200",nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",caption:"relative px-8 py-4 text-center text-xl font-semibold text-wendys-charcoal",caption_label:"text-xl font-semibold text-wendys-charcoal",table:"w-full border-collapse space-y-1",head_row:"flex",row:"flex w-full mt-2",cell:"h-12 w-12 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20"}})})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-wendys-red to-wendys-dark-red rounded-full mb-4",children:e.jsx(Ne,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-wendys-charcoal",children:H(g,"EEEE")}),e.jsx("p",{className:"text-lg text-gray-600",children:H(g,"MMMM d, yyyy")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-700 flex items-center text-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"Events (",m.length,")"]}),m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ne,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No events scheduled"})]}):e.jsx("div",{className:"space-y-3",children:m.map(l=>e.jsx("div",{className:"group bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-blue-900 text-lg",children:l.title}),l.description&&e.jsx("p",{className:"text-sm text-blue-700 mt-2 leading-relaxed",children:l.description}),e.jsxs("div",{className:"flex items-center text-xs text-blue-600 mt-3 space-x-4",children:[e.jsxs("span",{className:"flex items-center bg-blue-200 px-2 py-1 rounded-full",children:[e.jsx(Ke,{className:"h-3 w-3 mr-1"}),H(We(l.start_date),"h:mm a")]}),l.location&&e.jsxs("span",{className:"flex items-center bg-blue-200 px-2 py-1 rounded-full",children:[e.jsx(Os,{className:"h-3 w-3 mr-1"}),l.location]})]})]}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>K(l),className:"h-8 w-8 p-0 hover:bg-blue-200",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>_.mutate(l.id),className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]})},l.id))})]}),e.jsxs("div",{className:"space-y-4 mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("h4",{className:"font-semibold text-gray-700 flex items-center text-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-3"}),"Reminders (",o.length,")"]}),o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ws,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No reminders due"})]}):e.jsx("div",{className:"space-y-3",children:o.map(l=>e.jsx("div",{className:`group border rounded-xl p-4 transition-all duration-200 hover:shadow-md ${l.completed?"bg-gray-50 border-gray-200":l.priority==="high"?"bg-gradient-to-r from-red-50 to-red-100 border-red-200":l.priority==="medium"?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-200":"bg-gradient-to-r from-green-50 to-green-100 border-green-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>A.mutate({id:l.id,completed:!l.completed}),className:"flex-shrink-0",children:l.completed?e.jsx(es,{className:"h-5 w-5 text-green-600"}):e.jsx(xt,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 transition-colors duration-200"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[te(l.priority),e.jsx("h5",{className:`font-semibold text-lg ${l.completed?"text-gray-500 line-through":"text-gray-900"}`,children:l.title})]})]}),l.description&&e.jsx("p",{className:`text-sm mt-2 leading-relaxed ${l.completed?"text-gray-500":"text-gray-700"}`,children:l.description}),e.jsx("div",{className:"flex items-center mt-3",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${l.priority==="high"?"bg-red-100 text-red-800":l.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[l.priority.charAt(0).toUpperCase()+l.priority.slice(1)," Priority"]})})]}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>G(l),className:"h-8 w-8 p-0 hover:bg-gray-200",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>F.mutate(l.id),className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]})},l.id))})]})]})})]}),x==="month"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-wendys-charcoal mb-6 text-center",children:H(g,"MMMM yyyy")}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(l=>e.jsx("div",{className:"text-center text-sm font-semibold text-gray-500 py-3 px-2",children:l},l)),R.map((l,j)=>{const z=O(l),Q=v(l),ae=Ma(l),B=Xe(l,g),oe=Va(l,g);return e.jsxs("div",{className:`min-h-[100px] p-2 border border-gray-200 cursor-pointer transition-all duration-200 rounded-lg ${oe?"bg-white hover:bg-gray-50":"bg-gray-50 text-gray-400"} ${ae?"bg-gradient-to-br from-wendys-red/20 to-wendys-dark-red/20 border-wendys-red/30 shadow-md":""} ${B?"bg-blue-50 border-blue-300 shadow-md":""}`,onClick:()=>L(l),children:[e.jsx("div",{className:`text-sm font-semibold mb-2 ${ae?"text-wendys-red":oe?"text-gray-900":"text-gray-400"}`,children:H(l,"d")}),z.slice(0,2).map(b=>e.jsx("div",{className:"text-xs bg-gradient-to-r from-blue-500 to-blue-600 text-white px-2 py-1 rounded-full mb-1 truncate shadow-sm",title:b.title,children:b.title},b.id)),Q.slice(0,2).map(b=>e.jsx("div",{className:`text-xs px-2 py-1 rounded-full mb-1 truncate shadow-sm ${b.completed?"bg-gray-400 text-white":b.priority==="high"?"bg-gradient-to-r from-red-500 to-red-600 text-white":b.priority==="medium"?"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}`,title:b.title,children:b.title},b.id)),z.length+Q.length>4&&e.jsxs("div",{className:"text-xs text-gray-500 text-center bg-gray-100 rounded-full py-1 mt-1",children:["+",z.length+Q.length-4," more"]})]},j)})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-wendys-charcoal",children:r?"Edit Event":"Add Event"}),e.jsx(I,{variant:"ghost",onClick:()=>{a(!1),h(null)},className:"h-10 w-10 p-0 rounded-full hover:bg-gray-100",children:"Ã—"})]}),e.jsxs("form",{onSubmit:l=>{l.preventDefault();const j=new FormData(l.currentTarget),z={title:j.get("title"),description:j.get("description"),start_date:j.get("start_date"),end_date:j.get("end_date")||void 0,all_day:j.get("all_day")==="on",location:j.get("location"),reminder_type:j.get("reminder_type")};y.mutate(z)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"title",className:"text-sm font-semibold text-gray-700",children:"Event Title *"}),e.jsx($,{id:"title",name:"title",defaultValue:r==null?void 0:r.title,required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter event title"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"description",className:"text-sm font-semibold text-gray-700",children:"Description"}),e.jsx(as,{id:"description",name:"description",defaultValue:r==null?void 0:r.description,rows:3,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter event description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"start_date",className:"text-sm font-semibold text-gray-700",children:"Start Date *"}),e.jsx($,{id:"start_date",name:"start_date",type:"datetime-local",defaultValue:(ie=r==null?void 0:r.start_date)==null?void 0:ie.slice(0,16),required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"end_date",className:"text-sm font-semibold text-gray-700",children:"End Date"}),e.jsx($,{id:"end_date",name:"end_date",type:"datetime-local",defaultValue:(i=r==null?void 0:r.end_date)==null?void 0:i.slice(0,16),className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"all_day",name:"all_day",type:"checkbox",defaultChecked:r==null?void 0:r.all_day,className:"rounded border-gray-300 text-wendys-red focus:ring-wendys-red/20 h-4 w-4"}),e.jsx(U,{htmlFor:"all_day",className:"text-sm font-medium text-gray-700",children:"All day event"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"location",className:"text-sm font-semibold text-gray-700",children:"Location"}),e.jsx($,{id:"location",name:"location",defaultValue:r==null?void 0:r.location,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter location"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"reminder_type",className:"text-sm font-semibold text-gray-700",children:"Reminder"}),e.jsxs("select",{id:"reminder_type",name:"reminder_type",defaultValue:(r==null?void 0:r.reminder_type)||"none",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-wendys-red focus:ring-wendys-red/20",children:[e.jsx("option",{value:"none",children:"No reminder"}),e.jsx("option",{value:"15min",children:"15 minutes before"}),e.jsx("option",{value:"1hour",children:"1 hour before"}),e.jsx("option",{value:"1day",children:"1 day before"}),e.jsx("option",{value:"1week",children:"1 week before"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{a(!1),h(null)},className:"border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg",children:"Cancel"}),e.jsx(I,{type:"submit",className:"wendys-button rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:r?"Update Event":"Create Event"})]})]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-wendys-charcoal",children:d?"Edit Reminder":"Add Reminder"}),e.jsx(I,{variant:"ghost",onClick:()=>{c(!1),N(null)},className:"h-10 w-10 p-0 rounded-full hover:bg-gray-100",children:"Ã—"})]}),e.jsxs("form",{onSubmit:l=>{l.preventDefault();const j=new FormData(l.currentTarget),z={title:j.get("title"),description:j.get("description"),due_date:j.get("due_date"),priority:j.get("priority"),completed:!1};w.mutate(z)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"reminder_title",className:"text-sm font-semibold text-gray-700",children:"Reminder Title *"}),e.jsx($,{id:"reminder_title",name:"title",defaultValue:d==null?void 0:d.title,required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter reminder title"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"reminder_description",className:"text-sm font-semibold text-gray-700",children:"Description"}),e.jsx(as,{id:"reminder_description",name:"description",defaultValue:d==null?void 0:d.description,rows:3,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg",placeholder:"Enter reminder description"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"reminder_due_date",className:"text-sm font-semibold text-gray-700",children:"Due Date *"}),e.jsx($,{id:"reminder_due_date",name:"due_date",type:"datetime-local",defaultValue:(S=d==null?void 0:d.due_date)==null?void 0:S.slice(0,16),required:!0,className:"mt-2 border-gray-300 focus:border-wendys-red focus:ring-wendys-red/20 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"reminder_priority",className:"text-sm font-semibold text-gray-700",children:"Priority"}),e.jsxs("select",{id:"reminder_priority",name:"priority",defaultValue:(d==null?void 0:d.priority)||"medium",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-wendys-red focus:ring-wendys-red/20",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{c(!1),N(null)},className:"border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg",children:"Cancel"}),e.jsx(I,{type:"submit",className:"wendys-button rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:d?"Update Reminder":"Create Reminder"})]})]})]})})]})}const un=we("/")({beforeLoad:()=>{throw Fa({to:"/overview"})}}),xn=vr.update({id:"/weekending-sheet",path:"/weekending-sheet",getParentRoute:()=>be}),hn=Nr.update({id:"/soft-inventory",path:"/soft-inventory",getParentRoute:()=>be}),gn=Sr.update({id:"/smg",path:"/smg",getParentRoute:()=>be}),fn=Cr.update({id:"/setup",path:"/setup",getParentRoute:()=>be}),pn=zr.update({id:"/settings",path:"/settings",getParentRoute:()=>be}),yn=Yr.update({id:"/overview",path:"/overview",getParentRoute:()=>be}),vn=Xr.update({id:"/omega-daily",path:"/omega-daily",getParentRoute:()=>be}),bn=en.update({id:"/interviews",path:"/interviews",getParentRoute:()=>be}),_n=dn.update({id:"/goals",path:"/goals",getParentRoute:()=>be}),Nn=cn.update({id:"/calendar",path:"/calendar",getParentRoute:()=>be}),wn=un.update({id:"/",path:"/",getParentRoute:()=>be}),jn={IndexRoute:wn,CalendarRoute:Nn,GoalsRoute:_n,InterviewsRoute:bn,OmegaDailyRoute:vn,OverviewRoute:yn,SettingsRoute:pn,SetupRoute:fn,SmgRoute:gn,SoftInventoryRoute:hn,WeekendingSheetRoute:xn},En=be._addFileChildren(jn)._addFileTypes(),Yt=new Oa({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}}),Sn=Ua({routeTree:En,context:{queryClient:Yt},defaultPreload:"intent"});Pa.createRoot(document.getElementById("root")).render(e.jsx(Oe.StrictMode,{children:e.jsxs(za,{client:Yt,children:[e.jsx(qa,{router:Sn}),e.jsx(Za,{}),e.jsx(Wa,{initialIsOpen:!1})]})}));
